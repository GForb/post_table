{smcl}
{txt}{sf}{ul off}{.-}
      name:  {res}<unnamed>
       {txt}log:  {res}N:\Automating reporting\Git repository\post_table\Examples\Data and results\ptb_eg5.4
  {txt}log type:  {res}smcl
 {txt}opened on:  {res}18 Mar 2019, 10:45:59
  {txt}- use eg_data2, clear
  - local results ptb_eg`eg_no'
  = local results ptb_eg5.4
  - tempname postname
  - forvalues i = 1 (1) `cols' {c -(}
  = forvalues i = 1 (1) 7 {c -(}
  - local post_cols `post_cols' col`i'
  = local post_cols  col1
  - {c )-}
  - local post_cols `post_cols' col`i'
  = local post_cols col1 col2
  - {c )-}
  - local post_cols `post_cols' col`i'
  = local post_cols col1 col2 col3
  - {c )-}
  - local post_cols `post_cols' col`i'
  = local post_cols col1 col2 col3 col4
  - {c )-}
  - local post_cols `post_cols' col`i'
  = local post_cols col1 col2 col3 col4 col5
  - {c )-}
  - local post_cols `post_cols' col`i'
  = local post_cols col1 col2 col3 col4 col5 col6
  - {c )-}
  - local post_cols `post_cols' col`i'
  = local post_cols col1 col2 col3 col4 col5 col6 col7
  - {c )-}
  - postfile `namelist' str100(`post_cols') using "`results'.dta", replace
  = postfile __000000 str100(col1 col2 col3 col4 col5 col6 col7) using "ptb_eg5.4.dta", replace
  {hline 82} end pt_base_intro {hline}

{com}. 
. 
. pt_base age , post(`postname') over(treat)  overall(last) over_grps(1, 0) type(cont) su_label(append)  gap(1) n_analysis(cols %) order(group_treat) per 
{txt}  {hline 86} begin pt_base {hline}
  - syntax varlist(numeric) [if], POSTname(string) [ Type(string) count_only over(varname) over_grps(numlist) overall(string) cat_levels(numlist) cat_col cat_tabs(integer 1) gap(integer 0) gap_end(integer 0) decimal(integer 1) miss_decimal(integer 1) su_decimal(integer 1) positive(integer 1) Missing(string) N_analysis(string) order(string) sum_cols_first su_label(string) su_label_text(string) append_label(string) var_lab(string) per comment(string) ]
  - if "`if'" != "" {c -(}
  = if "" != "" {c -(}
    preserve
    keep `if'
    {c )-}
  - if `su_decimal' ==1 local su_decimal = `decimal'
  = if 1 ==1 local su_decimal = 1
  - if `miss_decimal' ==1 local miss_decimal = `decimal'
  = if 1 ==1 local miss_decimal = 1
  - if "`over'" != "" {c -(}
  = if "treat" != "" {c -(}
  - if "`over_grps'" == "" levelsof `over', local(over_grps)
  = if "1 0" == "" levelsof treat, local(over_grps)
  - if "`overall'" == "first" local over_grps overall `over_grps'
  = if "last" == "first" local over_grps overall 1 0
  - if "`overall'" == "last" local over_grps `over_grps' overall
  = if "last" == "last" local over_grps 1 0 overall
  - {c )-}
  - if "`over'" == "" local over_grps overall
  = if "treat" == "" local over_grps overall
  - if "`order'" == "" local order group_sum
  = if "group_treat" == "" local order group_sum
  - if "`per'" != "" local per %
  = if "per" != "" local per %
  - if "`comment'" != "" & "`comment'" != "no comment" local comment ("`comment'")
  = if "" != "" & "" != "no comment" local comment ("")
  - if "`comment'" == "no comment" local comment ("")
  = if "" == "no comment" local comment ("")
  - if "`type'" == "misstable" {c -(}
  = if "cont" == "misstable" {c -(}
    local type bin
    local positive .
    local miss_opt missing
    {c )-}
  - foreach w in `missing' {c -(}
  = foreach w in  {c -(}
    if "`w'" == "brackets" local missing brackets
    if "`w'" == "cols" local missing cols
    if "`w'" == "%" local miss_per miss_per
    if "`w'" == "cond" local cond cond
    {c )-}
  - foreach w in `n_analysis' {c -(}
  = foreach w in cols % {c -(}
  - if "`w'" == "brackets" local n_analysis brackets
  = if "cols" == "brackets" local n_analysis brackets
  - if "`w'" == "append" local n_analysis append
  = if "cols" == "append" local n_analysis append
  - if "`w'" == "cols" local n_analysis cols
  = if "cols" == "cols" local n_analysis cols
  - if "`w'" == "%" local n_analysis_per n_analysis_per
  = if "cols" == "%" local n_analysis_per n_analysis_per
  - if "`w'" == "cond" local cond cond
  = if "cols" == "cond" local cond cond
  - {c )-}
  - if "`w'" == "brackets" local n_analysis brackets
  = if "%" == "brackets" local n_analysis brackets
  - if "`w'" == "append" local n_analysis append
  = if "%" == "append" local n_analysis append
  - if "`w'" == "cols" local n_analysis cols
  = if "%" == "cols" local n_analysis cols
  - if "`w'" == "%" local n_analysis_per n_analysis_per
  = if "%" == "%" local n_analysis_per n_analysis_per
  - if "`w'" == "cond" local cond cond
  = if "%" == "cond" local cond cond
  - {c )-}
  - forvalues t = 1 (1) `cat_tabs' {c -(}
  = forvalues t = 1 (1) 1 {c -(}
  - local tab1 = "`tab1'    "
  = local tab1 = "    "
  - {c )-}
  - foreach v in `varlist' {c -(}
  = foreach v in age {c -(}
  - di as result _newline(3) "****** `v' ******" _newline(1)
  = di as result _newline(3) "****** age ******" _newline(1)



{res}****** age ******

  {txt}- display as text %26s "Group {c -(}c |{c )-}" as text %19s "N obs. Percent" %24s "N missing Percent"
               Group {c |}     N obs. Percent       N missing Percent
  - di as text "{c -(}hline 21{c )-}{c -(}c +{c )-}{c -(}hline 43{c )-}"
{hline 21}{c +}{hline 43}
  - local type1 = "`type'"
  = local type1 = "cont"
  - if "`type1'" == "" {c -(}
  = if "cont" == "" {c -(}
    qui inspect `v'
    if r(N_unique) < 3 {c -(}
    local type1 = "bin"
    {c )-}
    else if r(N_unique) < 10 {c -(}
    local type1 = "cat"
    {c )-}
    else if r(N_unique) >= 10 | r(N_unique) ==. {c -(}
    local type1 = "cont"
    {c )-}
    {c )-}
  - qui count if missing(`v')
  = qui count if missing(age)
  - local miss_overall = r(N)
  - local var_label `var_lab'
  = local var_label 
  - if "`var_lab'" == "" local var_label:variable label `v'
  = if "" == "" local var_label:variable label age
  - if "`var_label'" == "" local var_label = "`v'"
  = if "Age" == "" local var_label = "age"
  - local var_label `var_label' `append_label'
  = local var_label Age 
  - if "`type1'" == "cont" local measure1 "mean (sd)"
  = if "cont" == "cont" local measure1 "mean (sd)"
  - if "`type1'" == "bin" | "`type1'" == "cat" {c -(}
  = if "cont" == "bin" | "cont" == "cat" {c -(}
    local measure1 "n (%)"
    if "`count_only'" != "" local measure1 "n"
    {c )-}
  - if "`type1'" == "skew" local measure1 "median (IQR)"
  = if "cont" == "skew" local measure1 "median (IQR)"
  - if "`missing'" == "brackets" local measure1 "`measure1' [missing]"
  = if "" == "brackets" local measure1 "mean (sd) [missing]"
  - if "`n_analysis'" == "brackets" local measure1 "`measure1' [n included in analysis]"
  = if "cols" == "brackets" local measure1 "mean (sd) [n included in analysis]"
  - if "`su_label_text'" != "" local measure1 `su_label_text'
  = if "" != "" local measure1 
  - if "`su_label'" == "append" local measure_append =" - `measure1'"
  = if "append" == "append" local measure_append =" - mean (sd)"
  - local N_append ""
  - if "`n_analysis'" == "append" & ("`cond'" =="" | `miss_overall' > 0) {c -(}
  = if "cols" == "append" & ("" =="" | 0 > 0) {c -(}
    qui count if missing(`v') ==0
    local N = r(N)
    local N_append (N = `N')
    {c )-}
  - local var_label ("`var_label'`measure_append' `N_append'")
  = local var_label ("Age - mean (sd) ")
  - local measure_post
  - if "`su_label'" == "col" local measure_post ("`measure1'")
  = if "append" == "col" local measure_post ("mean (sd)")
  - local miss_cols ""
  - local inan_cols ""
  - foreach i in `over_grps' {c -(}
  = foreach i in 1 0 overall {c -(}
  - if "`i'" == "overall" {c -(}
  = if "1" == "overall" {c -(}
    qui count
    local N_data = r(N)
    qui count if !missing(`v')
    local N_`i' = r(N)
    qui count if missing(`v')
    local n_missing_`i' = r(N)
    {c )-}
  - else {c -(}
  - qui count if `over' == `i'
  = qui count if treat == 1
  - local N_data = r(N)
  - qui count if `over' == `i' & !missing(`v')
  = qui count if treat == 1 & !missing(age)
  - local N_`i' = r(N)
  = local N_1 = r(N)
  - qui count if missing(`v') & `over'==`i'
  = qui count if missing(age) & treat==1
  - local n_missing_`i' = r(N)
  = local n_missing_1 = r(N)
  - {c )-}
  - local n_inanalysis_per_`i' = `N_`i''/`N_data' *100
  = local n_inanalysis_per_1 = 506/506 *100
  - local in_per_`i' = string(`n_inanalysis_per_`i'', "%12.`miss_decimal'f")
  = local in_per_1 = string(100, "%12.1f")
  - local inanalysis_`i' = `N_`i''
  = local inanalysis_1 = 506
  - if "`n_analysis_per'" != "" local inanalysis_`i' `N_`i'' (`in_per_`i''`per')
  = if "n_analysis_per" != "" local inanalysis_1 506 (100.0%)
  - local n_missing_per_`i' = `n_missing_`i''/`N_data'*100
  = local n_missing_per_1 = 0/506*100
  - local miss_per_`i' = string(`n_missing_per_`i'', "%12.`miss_decimal'f")
  = local miss_per_1 = string(0, "%12.1f")
  - local missing_`i' = `n_missing_`i''
  = local missing_1 = 0
  - if "`miss_per'" != "" local missing_`i' `n_missing_`i'' (`miss_per_`i''`per')
  = if "" != "" local missing_1 0 (0.0%)
  - display as text %20s abbrev("`i'",20) " {c -(}c |{c )-}" as result %9.0g `N_`i'' " " %9.0g `n_inanalysis_per_`i'' %14.0g `n_missing_`i'' " " %9.0g `n_missing_per_`i''
  = display as text %20s abbrev("1",20) " {c -(}c |{c )-}" as result %9.0g 506 " " %9.0g 100 %14.0g 0 " " %9.0g 0
                   1 {c |}{res}      506       100             0         0
  {txt}- local brackets_`i' ""
  = local brackets_1 ""
  - if "`cond'" == "" | ("`cond'" == "cond" & `miss_overall' != 0) {c -(}
  = if "" == "" | ("" == "cond" & 0 != 0) {c -(}
  - if "`missing'" == "cols" local miss_cols `miss_cols' ("`missing_`i''")
  = if "" == "cols" local miss_cols  ("0")
  - if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("`inanalysis_`i''")
  = if "cols" == "cols" local inan_cols  ("506 (100.0%)")
  - local brackets_`i'
  = local brackets_1
  - if "`missing'" == "brackets" local brackets_`i' "[`missing_`i'']"
  = if "" == "brackets" local brackets_1 "[0]"
  - if "`n_analysis'" == "brackets" local brackets_`i' "[`inanalysis_`i'']"
  = if "cols" == "brackets" local brackets_1 "[506 (100.0%)]"
  - {c )-}
  - if "`cond'" == "cond" & `miss_overall' == 0 {c -(}
  = if "" == "cond" & 0 == 0 {c -(}
    if "`missing'" == "cols" local miss_cols `miss_cols' ("")
    if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("")
    {c )-}
  - {c )-}
  - if "`i'" == "overall" {c -(}
  = if "0" == "overall" {c -(}
    qui count
    local N_data = r(N)
    qui count if !missing(`v')
    local N_`i' = r(N)
    qui count if missing(`v')
    local n_missing_`i' = r(N)
    {c )-}
  - else {c -(}
  - qui count if `over' == `i'
  = qui count if treat == 0
  - local N_data = r(N)
  - qui count if `over' == `i' & !missing(`v')
  = qui count if treat == 0 & !missing(age)
  - local N_`i' = r(N)
  = local N_0 = r(N)
  - qui count if missing(`v') & `over'==`i'
  = qui count if missing(age) & treat==0
  - local n_missing_`i' = r(N)
  = local n_missing_0 = r(N)
  - {c )-}
  - local n_inanalysis_per_`i' = `N_`i''/`N_data' *100
  = local n_inanalysis_per_0 = 494/494 *100
  - local in_per_`i' = string(`n_inanalysis_per_`i'', "%12.`miss_decimal'f")
  = local in_per_0 = string(100, "%12.1f")
  - local inanalysis_`i' = `N_`i''
  = local inanalysis_0 = 494
  - if "`n_analysis_per'" != "" local inanalysis_`i' `N_`i'' (`in_per_`i''`per')
  = if "n_analysis_per" != "" local inanalysis_0 494 (100.0%)
  - local n_missing_per_`i' = `n_missing_`i''/`N_data'*100
  = local n_missing_per_0 = 0/494*100
  - local miss_per_`i' = string(`n_missing_per_`i'', "%12.`miss_decimal'f")
  = local miss_per_0 = string(0, "%12.1f")
  - local missing_`i' = `n_missing_`i''
  = local missing_0 = 0
  - if "`miss_per'" != "" local missing_`i' `n_missing_`i'' (`miss_per_`i''`per')
  = if "" != "" local missing_0 0 (0.0%)
  - display as text %20s abbrev("`i'",20) " {c -(}c |{c )-}" as result %9.0g `N_`i'' " " %9.0g `n_inanalysis_per_`i'' %14.0g `n_missing_`i'' " " %9.0g `n_missing_per_`i''
  = display as text %20s abbrev("0",20) " {c -(}c |{c )-}" as result %9.0g 494 " " %9.0g 100 %14.0g 0 " " %9.0g 0
                   0 {c |}{res}      494       100             0         0
  {txt}- local brackets_`i' ""
  = local brackets_0 ""
  - if "`cond'" == "" | ("`cond'" == "cond" & `miss_overall' != 0) {c -(}
  = if "" == "" | ("" == "cond" & 0 != 0) {c -(}
  - if "`missing'" == "cols" local miss_cols `miss_cols' ("`missing_`i''")
  = if "" == "cols" local miss_cols  ("0")
  - if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("`inanalysis_`i''")
  = if "cols" == "cols" local inan_cols ("506 (100.0%)") ("494 (100.0%)")
  - local brackets_`i'
  = local brackets_0
  - if "`missing'" == "brackets" local brackets_`i' "[`missing_`i'']"
  = if "" == "brackets" local brackets_0 "[0]"
  - if "`n_analysis'" == "brackets" local brackets_`i' "[`inanalysis_`i'']"
  = if "cols" == "brackets" local brackets_0 "[494 (100.0%)]"
  - {c )-}
  - if "`cond'" == "cond" & `miss_overall' == 0 {c -(}
  = if "" == "cond" & 0 == 0 {c -(}
    if "`missing'" == "cols" local miss_cols `miss_cols' ("")
    if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("")
    {c )-}
  - {c )-}
  - if "`i'" == "overall" {c -(}
  = if "overall" == "overall" {c -(}
  - qui count
  - local N_data = r(N)
  - qui count if !missing(`v')
  = qui count if !missing(age)
  - local N_`i' = r(N)
  = local N_overall = r(N)
  - qui count if missing(`v')
  = qui count if missing(age)
  - local n_missing_`i' = r(N)
  = local n_missing_overall = r(N)
  - {c )-}
  - else {c -(}
    qui count if `over' == `i'
    local N_data = r(N)
    qui count if `over' == `i' & !missing(`v')
    local N_`i' = r(N)
    qui count if missing(`v') & `over'==`i'
    local n_missing_`i' = r(N)
    {c )-}
  - local n_inanalysis_per_`i' = `N_`i''/`N_data' *100
  = local n_inanalysis_per_overall = 1000/1000 *100
  - local in_per_`i' = string(`n_inanalysis_per_`i'', "%12.`miss_decimal'f")
  = local in_per_overall = string(100, "%12.1f")
  - local inanalysis_`i' = `N_`i''
  = local inanalysis_overall = 1000
  - if "`n_analysis_per'" != "" local inanalysis_`i' `N_`i'' (`in_per_`i''`per')
  = if "n_analysis_per" != "" local inanalysis_overall 1000 (100.0%)
  - local n_missing_per_`i' = `n_missing_`i''/`N_data'*100
  = local n_missing_per_overall = 0/1000*100
  - local miss_per_`i' = string(`n_missing_per_`i'', "%12.`miss_decimal'f")
  = local miss_per_overall = string(0, "%12.1f")
  - local missing_`i' = `n_missing_`i''
  = local missing_overall = 0
  - if "`miss_per'" != "" local missing_`i' `n_missing_`i'' (`miss_per_`i''`per')
  = if "" != "" local missing_overall 0 (0.0%)
  - display as text %20s abbrev("`i'",20) " {c -(}c |{c )-}" as result %9.0g `N_`i'' " " %9.0g `n_inanalysis_per_`i'' %14.0g `n_missing_`i'' " " %9.0g `n_missing_per_`i''
  = display as text %20s abbrev("overall",20) " {c -(}c |{c )-}" as result %9.0g 1000 " " %9.0g 100 %14.0g 0 " " %9.0g 0
             overall {c |}{res}     1000       100             0         0
  {txt}- local brackets_`i' ""
  = local brackets_overall ""
  - if "`cond'" == "" | ("`cond'" == "cond" & `miss_overall' != 0) {c -(}
  = if "" == "" | ("" == "cond" & 0 != 0) {c -(}
  - if "`missing'" == "cols" local miss_cols `miss_cols' ("`missing_`i''")
  = if "" == "cols" local miss_cols  ("0")
  - if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("`inanalysis_`i''")
  = if "cols" == "cols" local inan_cols ("506 (100.0%)") ("494 (100.0%)") ("1000 (100.0%)")
  - local brackets_`i'
  = local brackets_overall
  - if "`missing'" == "brackets" local brackets_`i' "[`missing_`i'']"
  = if "" == "brackets" local brackets_overall "[0]"
  - if "`n_analysis'" == "brackets" local brackets_`i' "[`inanalysis_`i'']"
  = if "cols" == "brackets" local brackets_overall "[1000 (100.0%)]"
  - {c )-}
  - if "`cond'" == "cond" & `miss_overall' == 0 {c -(}
  = if "" == "cond" & 0 == 0 {c -(}
    if "`missing'" == "cols" local miss_cols `miss_cols' ("")
    if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("")
    {c )-}
  - {c )-}
  - di as text "{c -(}hline 21{c )-}{c -(}c BT{c )-}{c -(}hline 43{c )-}"
{hline 21}{c BT}{hline 43}
  - if "`type1'" == "cat" {c -(}
  = if "cont" == "cat" {c -(}
    if "`cat_col'" == "" {c -(}
    if "`order'" == "group_sum" {c -(}
    local summaries ""
    foreach i in `over_grps' {c -(}
    local summaries `summaries' ("")
    {c )-}
    if "`sum_cols_first'" == "" {c -(}
    post `postname' `var_label' `measure_post' `miss_cols' `inan_cols' `summaries' `comment'
    {c )-}
    else {c -(}
    post `postname' `var_label' `measure_post' `summaries' `miss_cols' `inan_cols' `comment'
    {c )-}
    {c )-}
    if "`order'" == "group_treat" {c -(}
    local summaries ""
    foreach i in `over_grps' {c -(}
    if "`n_analysis'" == "cols" local treat_cols`i' ("`inanalysis_`i''")
    if "`missing'" == "cols" local treat_cols`i' ("`missing_`i''")
    local treat_cols`i' `treat_cols`i'' ("")
    local summaries `summaries' `treat_cols`i''
    {c )-}
    post `postname' `var_label' `measure_post' `summaries' `comment'
    {c )-}
    {c )-}
    if "`over'" != "" tab `v' `over', col `miss_opt'
    if "`over'" == "" tab `v', `miss_opt'
    local val_label: value label `v'
    local levels "`cat_levels'"
    if "`levels'" == "" qui levelsof `v', local(levels)
    if "`missing'" == "brackets" local levels `levels' miss
    if "`n_analysis'" == "brackets" local levels `levels' inan
    local row = 0
    foreach i in `levels' {c -(}
    local row = `row' + 1
    if "`i'" == "inan" {c -(}
    local value_name "n included in analysis"
    {c )-}
    else if "`i'" == "miss" {c -(}
    local value_name "missing"
    {c )-}
    else {c -(}
    if "`val_label'" != "" {c -(}
    local value_name: label `val_label' `i'
    {c )-}
    if "`val_label'" == "" {c -(}
    local value_name `i'
    {c )-}
    {c )-}
    foreach j in `over_grps' {c -(}
    if "`i'" != "inan" & "`i'" != "miss" {c -(}
    if "`j'" == "overall" qui count if `v' == `i'
    if "`j'" != "overall" qui count if `v' == `i' & `over' ==`j'
    local n = r(N)
    if "`count_only'" == "" {c -(}
    local percent = `n'/`N_`j''*100
    local per_str = string(`percent', "%12.`su_decimal'f")
    local per_str (`per_str'`per')
    {c )-}
    local su_`j' ("`n' `per_str'")
    {c )-}
    if "`i'" == "inan" | "`i'" == "miss" local su_`j' ("`brackets_`j''")
    {c )-}
    if "`su_label'" == "col" local measure_post ("")
    local tab "`tab1'"
    if "`cat_col'" != "" {c -(}
    if `row' == 1 {c -(}
    local ccol `var_label'
    if "`su_label'" == "col" local measure_post ("`measure1'")
    {c )-}
    if `row' > 1 local ccol ("")
    local tab ""
    {c )-}
    if "`order'" == "group_sum" {c -(}
    local summaries ""
    local miss_cols ""
    local inan_cols ""
    foreach j in `over_grps' {c -(}
    local summaries `summaries' `su_`j''
    if "`missing'" == "cols" local miss_cols `miss_cols' ("`missing_`j''")
    if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("`inanalysis_`j''")
    {c )-}
    if "`sum_cols_first'" == "" {c -(}
    post `postname' `ccol' `measure_post' ("`tab'`value_name'") `inan_cols' `miss_cols' `summaries' `comment'
    {c )-}
    else {c -(}
    post `postname' `ccol' `measure_post' ("`tab'`value_name'") `summaries' `inan_cols' `miss_cols' `comment'
    {c )-}
    {c )-}
    if "`order'" == "group_treat" {c -(}
    local summaries ""
    foreach j in `over_grps' {c -(}
    local treat_cols`j' ""
    if "`missing'" == "cols" local treat_cols`j' `treat_cols`j'' ("`missing_`j''")
    if "`n_analysis'" == "cols" local treat_cols`j' ("`inanalysis_`j''")
    local treat_cols`j' `treat_cols`j'' `su_`j''
    local summaries `summaries' `treat_cols`j''
    {c )-}
    post `postname' `ccol' `measure_post' ("`tab'`value_name'") `summaries' `comment'
    {c )-}
    {c )-}
    {c )-}
  - else {c -(}
  - if "`cat_col'" != "" local ccol ("")
  = if "" != "" local ccol ("")
  - foreach i in `over_grps' {c -(}
  = foreach i in 1 0 overall {c -(}
  - if "`type1'" == "cont" {c -(}
  = if "cont" == "cont" {c -(}
  - di "Group `i'"
  = di "Group 1"
Group 1
  - if "`i'" == "overall" su `v'
  = if "1" == "overall" su age
  - if "`i'" != "overall" su `v' if `over' == `i'
  = if "1" != "overall" su age if treat == 1

    Variable {c |}        Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 57}
{space 9}age {c |}{res}        506    44.90614    10.06612    19.5597   77.65178
  {txt}- local mean = string(r(mean), "%12.`su_decimal'f")
  = local mean = string(r(mean), "%12.1f")
  - local sd = string(r(sd), "%12.`su_decimal'f")
  = local sd = string(r(sd), "%12.1f")
  - local su_`i' ("`mean' (`sd') `brackets_`i''")
  = local su_1 ("44.9 (10.1) ")
  - {c )-}
  - if "`type1'" == "bin" {c -(}
  = if "cont" == "bin" {c -(}
    if "`i'" == "overall" qui count if `v'==`positive'
    if "`i'" != "overall" qui count if `v'==`positive' & `over' == `i'
    scalar count_treat_positive_`i' = r(N)
    local n = count_treat_positive_`i'
    if "`count_only'" == ""{c -(}
    local percent = count_treat_positive_`i'/`N_`i''*100
    local per_str = string(`percent', "%12.`su_decimal'f")
    local per_str (`per_str'`per')
    {c )-}
    local su_`i' ("`n' `per_str' `brackets_`i''")
    {c )-}
  - if "`type1'" == "skew" {c -(}
  = if "cont" == "skew" {c -(}
    di "Group `i'"
    if "`i'" == "overall" tabstat `v', stats(q) save
    if "`i'" != "overall" tabstat `v' if `over' == `i', stats(q) save
    mat define A = r(StatTotal)
    local median = string(A[2,1], "%12.`su_decimal'f")
    local q1 = string(A[1,1], "%12.`su_decimal'f")
    local q3 = string(A[3,1], "%12.`su_decimal'f")
    local su_`i' ("`median' (`q1'-`q3') `brackets_`i''")
    {c )-}
  - {c )-}
  - if "`type1'" == "cont" {c -(}
  = if "cont" == "cont" {c -(}
  - di "Group `i'"
  = di "Group 0"
Group 0
  - if "`i'" == "overall" su `v'
  = if "0" == "overall" su age
  - if "`i'" != "overall" su `v' if `over' == `i'
  = if "0" != "overall" su age if treat == 0

    Variable {c |}        Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 57}
{space 9}age {c |}{res}        494    44.59293    10.12291   18.73607   79.98365
  {txt}- local mean = string(r(mean), "%12.`su_decimal'f")
  = local mean = string(r(mean), "%12.1f")
  - local sd = string(r(sd), "%12.`su_decimal'f")
  = local sd = string(r(sd), "%12.1f")
  - local su_`i' ("`mean' (`sd') `brackets_`i''")
  = local su_0 ("44.6 (10.1) ")
  - {c )-}
  - if "`type1'" == "bin" {c -(}
  = if "cont" == "bin" {c -(}
    if "`i'" == "overall" qui count if `v'==`positive'
    if "`i'" != "overall" qui count if `v'==`positive' & `over' == `i'
    scalar count_treat_positive_`i' = r(N)
    local n = count_treat_positive_`i'
    if "`count_only'" == ""{c -(}
    local percent = count_treat_positive_`i'/`N_`i''*100
    local per_str = string(`percent', "%12.`su_decimal'f")
    local per_str (`per_str'`per')
    {c )-}
    local su_`i' ("`n' `per_str' `brackets_`i''")
    {c )-}
  - if "`type1'" == "skew" {c -(}
  = if "cont" == "skew" {c -(}
    di "Group `i'"
    if "`i'" == "overall" tabstat `v', stats(q) save
    if "`i'" != "overall" tabstat `v' if `over' == `i', stats(q) save
    mat define A = r(StatTotal)
    local median = string(A[2,1], "%12.`su_decimal'f")
    local q1 = string(A[1,1], "%12.`su_decimal'f")
    local q3 = string(A[3,1], "%12.`su_decimal'f")
    local su_`i' ("`median' (`q1'-`q3') `brackets_`i''")
    {c )-}
  - {c )-}
  - if "`type1'" == "cont" {c -(}
  = if "cont" == "cont" {c -(}
  - di "Group `i'"
  = di "Group overall"
Group overall
  - if "`i'" == "overall" su `v'
  = if "overall" == "overall" su age

    Variable {c |}        Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 57}
{space 9}age {c |}{res}      1,000    44.75141    10.09038   18.73607   79.98365
  {txt}- if "`i'" != "overall" su `v' if `over' == `i'
  = if "overall" != "overall" su age if treat == overall
  - local mean = string(r(mean), "%12.`su_decimal'f")
  = local mean = string(r(mean), "%12.1f")
  - local sd = string(r(sd), "%12.`su_decimal'f")
  = local sd = string(r(sd), "%12.1f")
  - local su_`i' ("`mean' (`sd') `brackets_`i''")
  = local su_overall ("44.8 (10.1) ")
  - {c )-}
  - if "`type1'" == "bin" {c -(}
  = if "cont" == "bin" {c -(}
    if "`i'" == "overall" qui count if `v'==`positive'
    if "`i'" != "overall" qui count if `v'==`positive' & `over' == `i'
    scalar count_treat_positive_`i' = r(N)
    local n = count_treat_positive_`i'
    if "`count_only'" == ""{c -(}
    local percent = count_treat_positive_`i'/`N_`i''*100
    local per_str = string(`percent', "%12.`su_decimal'f")
    local per_str (`per_str'`per')
    {c )-}
    local su_`i' ("`n' `per_str' `brackets_`i''")
    {c )-}
  - if "`type1'" == "skew" {c -(}
  = if "cont" == "skew" {c -(}
    di "Group `i'"
    if "`i'" == "overall" tabstat `v', stats(q) save
    if "`i'" != "overall" tabstat `v' if `over' == `i', stats(q) save
    mat define A = r(StatTotal)
    local median = string(A[2,1], "%12.`su_decimal'f")
    local q1 = string(A[1,1], "%12.`su_decimal'f")
    local q3 = string(A[3,1], "%12.`su_decimal'f")
    local su_`i' ("`median' (`q1'-`q3') `brackets_`i''")
    {c )-}
  - {c )-}
  - if "`type1'" == "bin" {c -(}
  = if "cont" == "bin" {c -(}
    if "`miss_opt'" == "" {c -(}
    if "`over'" != "" tab `v' `over', col
    if "`over'" == "" tab `v'
    {c )-}
    {c )-}
  - if "`order'" == "group_sum" {c -(}
  = if "group_treat" == "group_sum" {c -(}
    local summaries ""
    foreach i in `over_grps' {c -(}
    local summaries `summaries' `su_`i''
    {c )-}
    if "`sum_cols_first'" == "" {c -(}
    post `postname' `var_label' `measure_post' `ccol' `inan_cols' `miss_cols' `summaries' `comment'
    {c )-}
    else {c -(}
    post `postname' `var_label' `measure_post' `ccol' `summaries' `inan_cols' `miss_cols' `comment'
    {c )-}
    {c )-}
  - if "`order'" == "group_treat" {c -(}
  = if "group_treat" == "group_treat" {c -(}
  - local summaries ""
  - foreach i in `over_grps' {c -(}
  = foreach i in 1 0 overall {c -(}
  - if "`n_analysis'" == "cols" local treat_cols`i' ("`inanalysis_`i''")
  = if "cols" == "cols" local treat_cols1 ("506 (100.0%)")
  - if "`missing'" == "cols" local treat_cols`i' ("`missing_`i''")
  = if "" == "cols" local treat_cols1 ("0")
  - local treat_cols`i' `treat_cols`i'' `su_`i''
  = local treat_cols1 ("506 (100.0%)") ("44.9 (10.1) ")
  - local summaries `summaries' `treat_cols`i''
  = local summaries  ("506 (100.0%)") ("44.9 (10.1) ")
  - {c )-}
  - if "`n_analysis'" == "cols" local treat_cols`i' ("`inanalysis_`i''")
  = if "cols" == "cols" local treat_cols0 ("494 (100.0%)")
  - if "`missing'" == "cols" local treat_cols`i' ("`missing_`i''")
  = if "" == "cols" local treat_cols0 ("0")
  - local treat_cols`i' `treat_cols`i'' `su_`i''
  = local treat_cols0 ("494 (100.0%)") ("44.6 (10.1) ")
  - local summaries `summaries' `treat_cols`i''
  = local summaries ("506 (100.0%)") ("44.9 (10.1) ") ("494 (100.0%)") ("44.6 (10.1) ")
  - {c )-}
  - if "`n_analysis'" == "cols" local treat_cols`i' ("`inanalysis_`i''")
  = if "cols" == "cols" local treat_colsoverall ("1000 (100.0%)")
  - if "`missing'" == "cols" local treat_cols`i' ("`missing_`i''")
  = if "" == "cols" local treat_colsoverall ("0")
  - local treat_cols`i' `treat_cols`i'' `su_`i''
  = local treat_colsoverall ("1000 (100.0%)") ("44.8 (10.1) ")
  - local summaries `summaries' `treat_cols`i''
  = local summaries ("506 (100.0%)") ("44.9 (10.1) ") ("494 (100.0%)") ("44.6 (10.1) ") ("1000 (100.0%)") ("44.8 (10.1) ")
  - {c )-}
  - post `postname' `var_label' `measure_post' `ccol' `summaries' `comment'
  = post __000000 ("Age - mean (sd) ")   ("506 (100.0%)") ("44.9 (10.1) ") ("494 (100.0%)") ("44.6 (10.1) ") ("1000 (100.0%)") ("44.8 (10.1) ") 
  - {c )-}
  - {c )-}
  - local measure_post
  - if "`su_label'" == "col" local measure_post ("")
  = if "append" == "col" local measure_post ("")
  - if "`cat_col'" != "" local ccol ("")
  = if "" != "" local ccol ("")
  - local summaries ""
  - local miss_cols ""
  - local inan_cols ""
  - foreach i in `over_grps' {c -(}
  = foreach i in 1 0 overall {c -(}
  - local summaries `summaries' ("")
  = local summaries  ("")
  - if "`missing'" == "cols" local miss_cols `miss_cols' ("")
  = if "" == "cols" local miss_cols  ("")
  - if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("")
  = if "cols" == "cols" local inan_cols  ("")
  - {c )-}
  - local summaries `summaries' ("")
  = local summaries ("") ("")
  - if "`missing'" == "cols" local miss_cols `miss_cols' ("")
  = if "" == "cols" local miss_cols  ("")
  - if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("")
  = if "cols" == "cols" local inan_cols ("") ("")
  - {c )-}
  - local summaries `summaries' ("")
  = local summaries ("") ("") ("")
  - if "`missing'" == "cols" local miss_cols `miss_cols' ("")
  = if "" == "cols" local miss_cols  ("")
  - if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("")
  = if "cols" == "cols" local inan_cols ("") ("") ("")
  - {c )-}
  - if "`comment'" != "" local comment ("")
  = if "" != "" local comment ("")
  - if `gap' > 0 {c -(}
  = if 1 > 0 {c -(}
  - forvalues i = 1 (1) `gap' {c -(}
  = forvalues i = 1 (1) 1 {c -(}
  - post `postname' ("") `measure_post' `ccol' `inan_cols' `miss_cols' `summaries' `comment'
  = post __000000 ("")   ("") ("") ("")  ("") ("") ("") 
  - {c )-}
  - {c )-}
  - {c )-}
  - if `gap_end' > 0 {c -(}
  = if 0 > 0 {c -(}
    forvalues i = 1 (1) `gap_end' {c -(}
    post `postname' ("") `measure_post' `ccol' `inan_cols' `miss_cols' `summaries' `comment'
    {c )-}
    {c )-}
  - if "`if'" != "" restore
  = if "" != "" restore
  {hline 88} end pt_base {hline}

{com}. pt_base qol, post(`postname') over(treat)  overall(last)  over_grps(1, 0) type(skew) su_label(append)  gap(1) n_analysis(cols %) order(group_treat) per
{txt}  {hline 86} begin pt_base {hline}
  - syntax varlist(numeric) [if], POSTname(string) [ Type(string) count_only over(varname) over_grps(numlist) overall(string) cat_levels(numlist) cat_col cat_tabs(integer 1) gap(integer 0) gap_end(integer 0) decimal(integer 1) miss_decimal(integer 1) su_decimal(integer 1) positive(integer 1) Missing(string) N_analysis(string) order(string) sum_cols_first su_label(string) su_label_text(string) append_label(string) var_lab(string) per comment(string) ]
  - if "`if'" != "" {c -(}
  = if "" != "" {c -(}
    preserve
    keep `if'
    {c )-}
  - if `su_decimal' ==1 local su_decimal = `decimal'
  = if 1 ==1 local su_decimal = 1
  - if `miss_decimal' ==1 local miss_decimal = `decimal'
  = if 1 ==1 local miss_decimal = 1
  - if "`over'" != "" {c -(}
  = if "treat" != "" {c -(}
  - if "`over_grps'" == "" levelsof `over', local(over_grps)
  = if "1 0" == "" levelsof treat, local(over_grps)
  - if "`overall'" == "first" local over_grps overall `over_grps'
  = if "last" == "first" local over_grps overall 1 0
  - if "`overall'" == "last" local over_grps `over_grps' overall
  = if "last" == "last" local over_grps 1 0 overall
  - {c )-}
  - if "`over'" == "" local over_grps overall
  = if "treat" == "" local over_grps overall
  - if "`order'" == "" local order group_sum
  = if "group_treat" == "" local order group_sum
  - if "`per'" != "" local per %
  = if "per" != "" local per %
  - if "`comment'" != "" & "`comment'" != "no comment" local comment ("`comment'")
  = if "" != "" & "" != "no comment" local comment ("")
  - if "`comment'" == "no comment" local comment ("")
  = if "" == "no comment" local comment ("")
  - if "`type'" == "misstable" {c -(}
  = if "skew" == "misstable" {c -(}
    local type bin
    local positive .
    local miss_opt missing
    {c )-}
  - foreach w in `missing' {c -(}
  = foreach w in  {c -(}
    if "`w'" == "brackets" local missing brackets
    if "`w'" == "cols" local missing cols
    if "`w'" == "%" local miss_per miss_per
    if "`w'" == "cond" local cond cond
    {c )-}
  - foreach w in `n_analysis' {c -(}
  = foreach w in cols % {c -(}
  - if "`w'" == "brackets" local n_analysis brackets
  = if "cols" == "brackets" local n_analysis brackets
  - if "`w'" == "append" local n_analysis append
  = if "cols" == "append" local n_analysis append
  - if "`w'" == "cols" local n_analysis cols
  = if "cols" == "cols" local n_analysis cols
  - if "`w'" == "%" local n_analysis_per n_analysis_per
  = if "cols" == "%" local n_analysis_per n_analysis_per
  - if "`w'" == "cond" local cond cond
  = if "cols" == "cond" local cond cond
  - {c )-}
  - if "`w'" == "brackets" local n_analysis brackets
  = if "%" == "brackets" local n_analysis brackets
  - if "`w'" == "append" local n_analysis append
  = if "%" == "append" local n_analysis append
  - if "`w'" == "cols" local n_analysis cols
  = if "%" == "cols" local n_analysis cols
  - if "`w'" == "%" local n_analysis_per n_analysis_per
  = if "%" == "%" local n_analysis_per n_analysis_per
  - if "`w'" == "cond" local cond cond
  = if "%" == "cond" local cond cond
  - {c )-}
  - forvalues t = 1 (1) `cat_tabs' {c -(}
  = forvalues t = 1 (1) 1 {c -(}
  - local tab1 = "`tab1'    "
  = local tab1 = "    "
  - {c )-}
  - foreach v in `varlist' {c -(}
  = foreach v in qol {c -(}
  - di as result _newline(3) "****** `v' ******" _newline(1)
  = di as result _newline(3) "****** qol ******" _newline(1)



{res}****** qol ******

  {txt}- display as text %26s "Group {c -(}c |{c )-}" as text %19s "N obs. Percent" %24s "N missing Percent"
               Group {c |}     N obs. Percent       N missing Percent
  - di as text "{c -(}hline 21{c )-}{c -(}c +{c )-}{c -(}hline 43{c )-}"
{hline 21}{c +}{hline 43}
  - local type1 = "`type'"
  = local type1 = "skew"
  - if "`type1'" == "" {c -(}
  = if "skew" == "" {c -(}
    qui inspect `v'
    if r(N_unique) < 3 {c -(}
    local type1 = "bin"
    {c )-}
    else if r(N_unique) < 10 {c -(}
    local type1 = "cat"
    {c )-}
    else if r(N_unique) >= 10 | r(N_unique) ==. {c -(}
    local type1 = "cont"
    {c )-}
    {c )-}
  - qui count if missing(`v')
  = qui count if missing(qol)
  - local miss_overall = r(N)
  - local var_label `var_lab'
  = local var_label 
  - if "`var_lab'" == "" local var_label:variable label `v'
  = if "" == "" local var_label:variable label qol
  - if "`var_label'" == "" local var_label = "`v'"
  = if "Quality of life" == "" local var_label = "qol"
  - local var_label `var_label' `append_label'
  = local var_label Quality of life 
  - if "`type1'" == "cont" local measure1 "mean (sd)"
  = if "skew" == "cont" local measure1 "mean (sd)"
  - if "`type1'" == "bin" | "`type1'" == "cat" {c -(}
  = if "skew" == "bin" | "skew" == "cat" {c -(}
    local measure1 "n (%)"
    if "`count_only'" != "" local measure1 "n"
    {c )-}
  - if "`type1'" == "skew" local measure1 "median (IQR)"
  = if "skew" == "skew" local measure1 "median (IQR)"
  - if "`missing'" == "brackets" local measure1 "`measure1' [missing]"
  = if "" == "brackets" local measure1 "median (IQR) [missing]"
  - if "`n_analysis'" == "brackets" local measure1 "`measure1' [n included in analysis]"
  = if "cols" == "brackets" local measure1 "median (IQR) [n included in analysis]"
  - if "`su_label_text'" != "" local measure1 `su_label_text'
  = if "" != "" local measure1 
  - if "`su_label'" == "append" local measure_append =" - `measure1'"
  = if "append" == "append" local measure_append =" - median (IQR)"
  - local N_append ""
  - if "`n_analysis'" == "append" & ("`cond'" =="" | `miss_overall' > 0) {c -(}
  = if "cols" == "append" & ("" =="" | 95 > 0) {c -(}
    qui count if missing(`v') ==0
    local N = r(N)
    local N_append (N = `N')
    {c )-}
  - local var_label ("`var_label'`measure_append' `N_append'")
  = local var_label ("Quality of life - median (IQR) ")
  - local measure_post
  - if "`su_label'" == "col" local measure_post ("`measure1'")
  = if "append" == "col" local measure_post ("median (IQR)")
  - local miss_cols ""
  - local inan_cols ""
  - foreach i in `over_grps' {c -(}
  = foreach i in 1 0 overall {c -(}
  - if "`i'" == "overall" {c -(}
  = if "1" == "overall" {c -(}
    qui count
    local N_data = r(N)
    qui count if !missing(`v')
    local N_`i' = r(N)
    qui count if missing(`v')
    local n_missing_`i' = r(N)
    {c )-}
  - else {c -(}
  - qui count if `over' == `i'
  = qui count if treat == 1
  - local N_data = r(N)
  - qui count if `over' == `i' & !missing(`v')
  = qui count if treat == 1 & !missing(qol)
  - local N_`i' = r(N)
  = local N_1 = r(N)
  - qui count if missing(`v') & `over'==`i'
  = qui count if missing(qol) & treat==1
  - local n_missing_`i' = r(N)
  = local n_missing_1 = r(N)
  - {c )-}
  - local n_inanalysis_per_`i' = `N_`i''/`N_data' *100
  = local n_inanalysis_per_1 = 461/506 *100
  - local in_per_`i' = string(`n_inanalysis_per_`i'', "%12.`miss_decimal'f")
  = local in_per_1 = string(91.10671936758892, "%12.1f")
  - local inanalysis_`i' = `N_`i''
  = local inanalysis_1 = 461
  - if "`n_analysis_per'" != "" local inanalysis_`i' `N_`i'' (`in_per_`i''`per')
  = if "n_analysis_per" != "" local inanalysis_1 461 (91.1%)
  - local n_missing_per_`i' = `n_missing_`i''/`N_data'*100
  = local n_missing_per_1 = 45/506*100
  - local miss_per_`i' = string(`n_missing_per_`i'', "%12.`miss_decimal'f")
  = local miss_per_1 = string(8.893280632411066, "%12.1f")
  - local missing_`i' = `n_missing_`i''
  = local missing_1 = 45
  - if "`miss_per'" != "" local missing_`i' `n_missing_`i'' (`miss_per_`i''`per')
  = if "" != "" local missing_1 45 (8.9%)
  - display as text %20s abbrev("`i'",20) " {c -(}c |{c )-}" as result %9.0g `N_`i'' " " %9.0g `n_inanalysis_per_`i'' %14.0g `n_missing_`i'' " " %9.0g `n_missing_per_`i''
  = display as text %20s abbrev("1",20) " {c -(}c |{c )-}" as result %9.0g 461 " " %9.0g 91.10671936758892 %14.0g 45 " " %9.0g 8.893280632411066
                   1 {c |}{res}      461  91.10672            45  8.893281
  {txt}- local brackets_`i' ""
  = local brackets_1 ""
  - if "`cond'" == "" | ("`cond'" == "cond" & `miss_overall' != 0) {c -(}
  = if "" == "" | ("" == "cond" & 95 != 0) {c -(}
  - if "`missing'" == "cols" local miss_cols `miss_cols' ("`missing_`i''")
  = if "" == "cols" local miss_cols  ("45")
  - if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("`inanalysis_`i''")
  = if "cols" == "cols" local inan_cols  ("461 (91.1%)")
  - local brackets_`i'
  = local brackets_1
  - if "`missing'" == "brackets" local brackets_`i' "[`missing_`i'']"
  = if "" == "brackets" local brackets_1 "[45]"
  - if "`n_analysis'" == "brackets" local brackets_`i' "[`inanalysis_`i'']"
  = if "cols" == "brackets" local brackets_1 "[461 (91.1%)]"
  - {c )-}
  - if "`cond'" == "cond" & `miss_overall' == 0 {c -(}
  = if "" == "cond" & 95 == 0 {c -(}
    if "`missing'" == "cols" local miss_cols `miss_cols' ("")
    if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("")
    {c )-}
  - {c )-}
  - if "`i'" == "overall" {c -(}
  = if "0" == "overall" {c -(}
    qui count
    local N_data = r(N)
    qui count if !missing(`v')
    local N_`i' = r(N)
    qui count if missing(`v')
    local n_missing_`i' = r(N)
    {c )-}
  - else {c -(}
  - qui count if `over' == `i'
  = qui count if treat == 0
  - local N_data = r(N)
  - qui count if `over' == `i' & !missing(`v')
  = qui count if treat == 0 & !missing(qol)
  - local N_`i' = r(N)
  = local N_0 = r(N)
  - qui count if missing(`v') & `over'==`i'
  = qui count if missing(qol) & treat==0
  - local n_missing_`i' = r(N)
  = local n_missing_0 = r(N)
  - {c )-}
  - local n_inanalysis_per_`i' = `N_`i''/`N_data' *100
  = local n_inanalysis_per_0 = 444/494 *100
  - local in_per_`i' = string(`n_inanalysis_per_`i'', "%12.`miss_decimal'f")
  = local in_per_0 = string(89.87854251012146, "%12.1f")
  - local inanalysis_`i' = `N_`i''
  = local inanalysis_0 = 444
  - if "`n_analysis_per'" != "" local inanalysis_`i' `N_`i'' (`in_per_`i''`per')
  = if "n_analysis_per" != "" local inanalysis_0 444 (89.9%)
  - local n_missing_per_`i' = `n_missing_`i''/`N_data'*100
  = local n_missing_per_0 = 50/494*100
  - local miss_per_`i' = string(`n_missing_per_`i'', "%12.`miss_decimal'f")
  = local miss_per_0 = string(10.12145748987854, "%12.1f")
  - local missing_`i' = `n_missing_`i''
  = local missing_0 = 50
  - if "`miss_per'" != "" local missing_`i' `n_missing_`i'' (`miss_per_`i''`per')
  = if "" != "" local missing_0 50 (10.1%)
  - display as text %20s abbrev("`i'",20) " {c -(}c |{c )-}" as result %9.0g `N_`i'' " " %9.0g `n_inanalysis_per_`i'' %14.0g `n_missing_`i'' " " %9.0g `n_missing_per_`i''
  = display as text %20s abbrev("0",20) " {c -(}c |{c )-}" as result %9.0g 444 " " %9.0g 89.87854251012146 %14.0g 50 " " %9.0g 10.12145748987854
                   0 {c |}{res}      444  89.87854            50  10.12146
  {txt}- local brackets_`i' ""
  = local brackets_0 ""
  - if "`cond'" == "" | ("`cond'" == "cond" & `miss_overall' != 0) {c -(}
  = if "" == "" | ("" == "cond" & 95 != 0) {c -(}
  - if "`missing'" == "cols" local miss_cols `miss_cols' ("`missing_`i''")
  = if "" == "cols" local miss_cols  ("50")
  - if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("`inanalysis_`i''")
  = if "cols" == "cols" local inan_cols ("461 (91.1%)") ("444 (89.9%)")
  - local brackets_`i'
  = local brackets_0
  - if "`missing'" == "brackets" local brackets_`i' "[`missing_`i'']"
  = if "" == "brackets" local brackets_0 "[50]"
  - if "`n_analysis'" == "brackets" local brackets_`i' "[`inanalysis_`i'']"
  = if "cols" == "brackets" local brackets_0 "[444 (89.9%)]"
  - {c )-}
  - if "`cond'" == "cond" & `miss_overall' == 0 {c -(}
  = if "" == "cond" & 95 == 0 {c -(}
    if "`missing'" == "cols" local miss_cols `miss_cols' ("")
    if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("")
    {c )-}
  - {c )-}
  - if "`i'" == "overall" {c -(}
  = if "overall" == "overall" {c -(}
  - qui count
  - local N_data = r(N)
  - qui count if !missing(`v')
  = qui count if !missing(qol)
  - local N_`i' = r(N)
  = local N_overall = r(N)
  - qui count if missing(`v')
  = qui count if missing(qol)
  - local n_missing_`i' = r(N)
  = local n_missing_overall = r(N)
  - {c )-}
  - else {c -(}
    qui count if `over' == `i'
    local N_data = r(N)
    qui count if `over' == `i' & !missing(`v')
    local N_`i' = r(N)
    qui count if missing(`v') & `over'==`i'
    local n_missing_`i' = r(N)
    {c )-}
  - local n_inanalysis_per_`i' = `N_`i''/`N_data' *100
  = local n_inanalysis_per_overall = 905/1000 *100
  - local in_per_`i' = string(`n_inanalysis_per_`i'', "%12.`miss_decimal'f")
  = local in_per_overall = string(90.5, "%12.1f")
  - local inanalysis_`i' = `N_`i''
  = local inanalysis_overall = 905
  - if "`n_analysis_per'" != "" local inanalysis_`i' `N_`i'' (`in_per_`i''`per')
  = if "n_analysis_per" != "" local inanalysis_overall 905 (90.5%)
  - local n_missing_per_`i' = `n_missing_`i''/`N_data'*100
  = local n_missing_per_overall = 95/1000*100
  - local miss_per_`i' = string(`n_missing_per_`i'', "%12.`miss_decimal'f")
  = local miss_per_overall = string(9.5, "%12.1f")
  - local missing_`i' = `n_missing_`i''
  = local missing_overall = 95
  - if "`miss_per'" != "" local missing_`i' `n_missing_`i'' (`miss_per_`i''`per')
  = if "" != "" local missing_overall 95 (9.5%)
  - display as text %20s abbrev("`i'",20) " {c -(}c |{c )-}" as result %9.0g `N_`i'' " " %9.0g `n_inanalysis_per_`i'' %14.0g `n_missing_`i'' " " %9.0g `n_missing_per_`i''
  = display as text %20s abbrev("overall",20) " {c -(}c |{c )-}" as result %9.0g 905 " " %9.0g 90.5 %14.0g 95 " " %9.0g 9.5
             overall {c |}{res}      905      90.5            95       9.5
  {txt}- local brackets_`i' ""
  = local brackets_overall ""
  - if "`cond'" == "" | ("`cond'" == "cond" & `miss_overall' != 0) {c -(}
  = if "" == "" | ("" == "cond" & 95 != 0) {c -(}
  - if "`missing'" == "cols" local miss_cols `miss_cols' ("`missing_`i''")
  = if "" == "cols" local miss_cols  ("95")
  - if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("`inanalysis_`i''")
  = if "cols" == "cols" local inan_cols ("461 (91.1%)") ("444 (89.9%)") ("905 (90.5%)")
  - local brackets_`i'
  = local brackets_overall
  - if "`missing'" == "brackets" local brackets_`i' "[`missing_`i'']"
  = if "" == "brackets" local brackets_overall "[95]"
  - if "`n_analysis'" == "brackets" local brackets_`i' "[`inanalysis_`i'']"
  = if "cols" == "brackets" local brackets_overall "[905 (90.5%)]"
  - {c )-}
  - if "`cond'" == "cond" & `miss_overall' == 0 {c -(}
  = if "" == "cond" & 95 == 0 {c -(}
    if "`missing'" == "cols" local miss_cols `miss_cols' ("")
    if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("")
    {c )-}
  - {c )-}
  - di as text "{c -(}hline 21{c )-}{c -(}c BT{c )-}{c -(}hline 43{c )-}"
{hline 21}{c BT}{hline 43}
  - if "`type1'" == "cat" {c -(}
  = if "skew" == "cat" {c -(}
    if "`cat_col'" == "" {c -(}
    if "`order'" == "group_sum" {c -(}
    local summaries ""
    foreach i in `over_grps' {c -(}
    local summaries `summaries' ("")
    {c )-}
    if "`sum_cols_first'" == "" {c -(}
    post `postname' `var_label' `measure_post' `miss_cols' `inan_cols' `summaries' `comment'
    {c )-}
    else {c -(}
    post `postname' `var_label' `measure_post' `summaries' `miss_cols' `inan_cols' `comment'
    {c )-}
    {c )-}
    if "`order'" == "group_treat" {c -(}
    local summaries ""
    foreach i in `over_grps' {c -(}
    if "`n_analysis'" == "cols" local treat_cols`i' ("`inanalysis_`i''")
    if "`missing'" == "cols" local treat_cols`i' ("`missing_`i''")
    local treat_cols`i' `treat_cols`i'' ("")
    local summaries `summaries' `treat_cols`i''
    {c )-}
    post `postname' `var_label' `measure_post' `summaries' `comment'
    {c )-}
    {c )-}
    if "`over'" != "" tab `v' `over', col `miss_opt'
    if "`over'" == "" tab `v', `miss_opt'
    local val_label: value label `v'
    local levels "`cat_levels'"
    if "`levels'" == "" qui levelsof `v', local(levels)
    if "`missing'" == "brackets" local levels `levels' miss
    if "`n_analysis'" == "brackets" local levels `levels' inan
    local row = 0
    foreach i in `levels' {c -(}
    local row = `row' + 1
    if "`i'" == "inan" {c -(}
    local value_name "n included in analysis"
    {c )-}
    else if "`i'" == "miss" {c -(}
    local value_name "missing"
    {c )-}
    else {c -(}
    if "`val_label'" != "" {c -(}
    local value_name: label `val_label' `i'
    {c )-}
    if "`val_label'" == "" {c -(}
    local value_name `i'
    {c )-}
    {c )-}
    foreach j in `over_grps' {c -(}
    if "`i'" != "inan" & "`i'" != "miss" {c -(}
    if "`j'" == "overall" qui count if `v' == `i'
    if "`j'" != "overall" qui count if `v' == `i' & `over' ==`j'
    local n = r(N)
    if "`count_only'" == "" {c -(}
    local percent = `n'/`N_`j''*100
    local per_str = string(`percent', "%12.`su_decimal'f")
    local per_str (`per_str'`per')
    {c )-}
    local su_`j' ("`n' `per_str'")
    {c )-}
    if "`i'" == "inan" | "`i'" == "miss" local su_`j' ("`brackets_`j''")
    {c )-}
    if "`su_label'" == "col" local measure_post ("")
    local tab "`tab1'"
    if "`cat_col'" != "" {c -(}
    if `row' == 1 {c -(}
    local ccol `var_label'
    if "`su_label'" == "col" local measure_post ("`measure1'")
    {c )-}
    if `row' > 1 local ccol ("")
    local tab ""
    {c )-}
    if "`order'" == "group_sum" {c -(}
    local summaries ""
    local miss_cols ""
    local inan_cols ""
    foreach j in `over_grps' {c -(}
    local summaries `summaries' `su_`j''
    if "`missing'" == "cols" local miss_cols `miss_cols' ("`missing_`j''")
    if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("`inanalysis_`j''")
    {c )-}
    if "`sum_cols_first'" == "" {c -(}
    post `postname' `ccol' `measure_post' ("`tab'`value_name'") `inan_cols' `miss_cols' `summaries' `comment'
    {c )-}
    else {c -(}
    post `postname' `ccol' `measure_post' ("`tab'`value_name'") `summaries' `inan_cols' `miss_cols' `comment'
    {c )-}
    {c )-}
    if "`order'" == "group_treat" {c -(}
    local summaries ""
    foreach j in `over_grps' {c -(}
    local treat_cols`j' ""
    if "`missing'" == "cols" local treat_cols`j' `treat_cols`j'' ("`missing_`j''")
    if "`n_analysis'" == "cols" local treat_cols`j' ("`inanalysis_`j''")
    local treat_cols`j' `treat_cols`j'' `su_`j''
    local summaries `summaries' `treat_cols`j''
    {c )-}
    post `postname' `ccol' `measure_post' ("`tab'`value_name'") `summaries' `comment'
    {c )-}
    {c )-}
    {c )-}
  - else {c -(}
  - if "`cat_col'" != "" local ccol ("")
  = if "" != "" local ccol ("")
  - foreach i in `over_grps' {c -(}
  = foreach i in 1 0 overall {c -(}
  - if "`type1'" == "cont" {c -(}
  = if "skew" == "cont" {c -(}
    di "Group `i'"
    if "`i'" == "overall" su `v'
    if "`i'" != "overall" su `v' if `over' == `i'
    local mean = string(r(mean), "%12.`su_decimal'f")
    local sd = string(r(sd), "%12.`su_decimal'f")
    local su_`i' ("`mean' (`sd') `brackets_`i''")
    {c )-}
  - if "`type1'" == "bin" {c -(}
  = if "skew" == "bin" {c -(}
    if "`i'" == "overall" qui count if `v'==`positive'
    if "`i'" != "overall" qui count if `v'==`positive' & `over' == `i'
    scalar count_treat_positive_`i' = r(N)
    local n = count_treat_positive_`i'
    if "`count_only'" == ""{c -(}
    local percent = count_treat_positive_`i'/`N_`i''*100
    local per_str = string(`percent', "%12.`su_decimal'f")
    local per_str (`per_str'`per')
    {c )-}
    local su_`i' ("`n' `per_str' `brackets_`i''")
    {c )-}
  - if "`type1'" == "skew" {c -(}
  = if "skew" == "skew" {c -(}
  - di "Group `i'"
  = di "Group 1"
Group 1
  - if "`i'" == "overall" tabstat `v', stats(q) save
  = if "1" == "overall" tabstat qol, stats(q) save
  - if "`i'" != "overall" tabstat `v' if `over' == `i', stats(q) save
  = if "1" != "overall" tabstat qol if treat == 1, stats(q) save
    {hline 84} begin tabstat {hline}
    - version 8, missing
    - syntax varlist(numeric) [if] [in] [aw fw] [ , BY(varname) CASEwise Columns(str) Format Format2(str) LAbelwidth(int -1) VArwidth(int -1) LOngstub Missing SAME SAVE noSEParator Statistics(str) STATS(str) noTotal ]
    - if "`casewise'" != "" {c -(}
    = if "" != "" {c -(}
      local same same
      {c )-}
    - if `"`stats'"' != "" {c -(}
    = if `"q"' != "" {c -(}
    - if `"`statistics'"' != "" {c -(}
    = if `""' != "" {c -(}
      di as err "may not specify both statistics() and stats() options"
      exit 198
      {c )-}
    - local statistics `"`stats'"'
    = local statistics `"q"'
    - local stats
    - {c )-}
    - if "`total'" != "" & "`by'" == "" {c -(}
    = if "" != "" & "" == "" {c -(}
      di as txt "nothing to display"
      exit 0
      {c )-}
    - if "`format'" != "" & `"`format2'"' != "" {c -(}
    = if "" != "" & `""' != "" {c -(}
      di as err "may not specify both format and format()"
      exit 198
      {c )-}
    - if `"`format2'"' != "" {c -(}
    = if `""' != "" {c -(}
      capt local tmp : display `format2' 1
      if _rc {c -(}
      di as err `"invalid %fmt in format(): `format2'"'
      exit 120
      {c )-}
      {c )-}
    - if `"`columns'"' == "" {c -(}
    = if `""' == "" {c -(}
    - local incol "variables"
    - {c )-}
    - else if `"`columns'"' == bsubstr("variables",1,length(`"`columns'"')) {c -(}
    = else if `""' == bsubstr("variables",1,length(`""')) {c -(}
      local incol "variables"
      {c )-}
    - else if `"`columns'"' == bsubstr("statistics",1,length(`"`columns'"')) {c -(}
    = else if `""' == bsubstr("statistics",1,length(`""')) {c -(}
      local incol "statistics"
      {c )-}
    - else if `"`columns'"' == "stats" {c -(}
    = else if `""' == "stats" {c -(}
      local incol "statistics"
      {c )-}
    - else {c -(}
      di as err `"column(`columns') invalid -- specify "' "column(variables) or column(statistics)"
      exit 198
      {c )-}
    - if "`longstub'" != "" | "`by'" == "" | `varwidth' != -1 {c -(}
    = if "" != "" | "" == "" | -1 != -1 {c -(}
    - local descr descr
    - {c )-}
    - if `varwidth' == -1 {c -(}
    = if -1 == -1 {c -(}
    - local varwidth 12
    - {c )-}
    - else if !inrange(`varwidth',8,c(namelen)) {c -(}
    = else if !inrange(12,8,c(namelen)) {c -(}
      local varwidth = clip(`varwidth',8,c(namelen))
      dis as txt "(option varwidth() outside valid range 8..`c(namelen)'; `varwidth' assumed)"
      {c )-}
    - if `labelwidth' == -1 {c -(}
    = if -1 == -1 {c -(}
    - local labelwidth 16
    - {c )-}
    - else if !inrange(`labelwidth',8,32) {c -(}
    = else if !inrange(16,8,32) {c -(}
      local labelwidth = clip(`labelwidth',8,32)
      dis as txt "(option labelwidth() outside valid range 8..32; `labelwidth' assumed)"
      {c )-}
    - marksample touse, novar
    - if "`same'" != "" {c -(}
    = if "" != "" {c -(}
      markout `touse' `varlist'
      {c )-}
    - if "`by'" != "" & "`missing'" == "" {c -(}
    = if "" != "" & "" == "" {c -(}
      markout `touse' `by' , strok
      {c )-}
    - qui count if `touse'
    = qui count if __000002
    - local ntouse = r(N)
    - if `ntouse' == 0 {c -(}
    = if 506 == 0 {c -(}
      error 2000
      {c )-}
    - if `"`weight'"' != "" {c -(}
    = if `""' != "" {c -(}
      local wght `"[`weight'`exp']"'
      {c )-}
    - tokenize "`varlist'"
    = tokenize "qol"
    - local nvars : word count `varlist'
    = local nvars : word count qol
    - forvalues i = 1/`nvars' {c -(}
    = forvalues i = 1/1 {c -(}
    - local var`i' ``i''
    = local var1 qol
    - if "`format'" != "" {c -(}
    = if "" != "" {c -(}
      local fmt`i' : format ``i''
      {c )-}
    - else if `"`format2'"' != "" {c -(}
    = else if `""' != "" {c -(}
      local fmt`i' `format2'
      {c )-}
    - else {c -(}
    - local fmt`i' %9.0g
    = local fmt1 %9.0g
    - {c )-}
    - {c )-}
    - if `nvars' == 1 & `"`columns'"' == "" {c -(}
    = if 1 == 1 & `""' == "" {c -(}
    - local incol statistics
    - {c )-}
    - Stats `statistics'
    = Stats q
      {hline 76} begin tabstat.Stats {hline}
      - if `"`0'"' == "" {c -(}
      = if `"q"' == "" {c -(}
        local opt "mean"
        {c )-}
      - else {c -(}
      - local opt `"`0'"'
      = local opt `"q"'
      - {c )-}
      - local class 0
      - foreach st of local opt {c -(}
      - local 0 = lower(`", `st'"')
      = local 0 = lower(`", q"')
      - capt syntax [, n MEan sd Variance SUm COunt MIn MAx Range SKewness Kurtosis SDMean SEMean p1 p5 p10 p25 p50 p75 p90 p95 p99 iqr q MEDian CV ]
      - if _rc {c -(}
        di in err `"unknown statistic: `st'"'
        exit 198
        {c )-}
      - if "`median'" != "" {c -(}
      = if "" != "" {c -(}
        local p50 p50
        {c )-}
      - if "`count'" != "" {c -(}
      = if "" != "" {c -(}
        local n n
        {c )-}
      - if "`n'" != "" {c -(}
      = if "" != "" {c -(}
        local n N
        {c )-}
      - local s "`n'`min'`mean'`max'`sum'"
      = local s ""
      - if "`s'" != "" {c -(}
      = if "" != "" {c -(}
        local names "`names' `s'"
        local expr "`expr' r(`s')"
        local class = max(`class',1)
        {c )-}
      - if "`range'" != "" {c -(}
      = if "" != "" {c -(}
        local names "`names' range"
        local expr "`expr' r(max)-r(min)"
        local class = max(`class',1)
        {c )-}
      - if "`sd'" != "" {c -(}
      = if "" != "" {c -(}
        local names "`names' sd"
        local expr "`expr' r(sd)"
        local class = max(`class',2)
        {c )-}
      - if "`sdmean'" != "" | "`semean'"!="" {c -(}
      = if "" != "" | ""!="" {c -(}
        local names "`names' se(mean)"
        local expr "`expr' r(sd)/sqrt(r(N))"
        local class = max(`class',2)
        {c )-}
      - if "`variance'" != "" {c -(}
      = if "" != "" {c -(}
        local names "`names' variance"
        local expr "`expr' r(Var)"
        local class = max(`class',2)
        {c )-}
      - if "`cv'" != "" {c -(}
      = if "" != "" {c -(}
        local names "`names' cv"
        local expr "`expr' (r(sd)/r(mean))"
        local class = max(`class',2)
        {c )-}
      - local s "`skewness'`kurtosis'`p1'`p5'`p10'`p25'`p50'`p75'`p90'`p95'`p99'"
      = local s ""
      - if "`s'" != "" {c -(}
      = if "" != "" {c -(}
        local names "`names' `s'"
        local expr "`expr' r(`s')"
        local class = max(`class',3)
        {c )-}
      - if "`iqr'" != "" {c -(}
      = if "" != "" {c -(}
        local names "`names' iqr"
        local expr "`expr' r(p75)-r(p25)"
        local class = max(`class',3)
        {c )-}
      - if "`q'" != "" {c -(}
      = if "q" != "" {c -(}
      - local names "`names' p25 p50 p75"
      = local names " p25 p50 p75"
      - local expr "`expr' r(p25) r(p50) r(p75)"
      = local expr " r(p25) r(p50) r(p75)"
      - local class = max(`class',3)
      = local class = max(0,3)
      - {c )-}
      - {c )-}
      - return local names `names'
      = return local names  p25 p50 p75
      - return local expr `expr'
      = return local expr  r(p25) r(p50) r(p75)
      - if `class' == 1 {c -(}
      = if 3 == 1 {c -(}
        return local summopt "meanonly"
        {c )-}
      - else if `class' == 3 {c -(}
      = else if 3 == 3 {c -(}
      - return local summopt "detail"
      - {c )-}
      {hline 78} end tabstat.Stats {hline}
    - local stats `r(names)'
    = local stats p25 p50 p75
    - local expr `r(expr)'
    = local expr r(p25) r(p50) r(p75)
    - local summopt `r(summopt)'
    = local summopt detail
    - local nstats : word count `stats'
    = local nstats : word count p25 p50 p75
    - tokenize `expr'
    = tokenize r(p25) r(p50) r(p75)
    - forvalues i = 1/`nstats' {c -(}
    = forvalues i = 1/3 {c -(}
    - local expr`i' ``i''
    = local expr1 r(p25)
    - {c )-}
    - local expr`i' ``i''
    = local expr2 r(p50)
    - {c )-}
    - local expr`i' ``i''
    = local expr3 r(p75)
    - {c )-}
    - tokenize `stats'
    = tokenize p25 p50 p75
    - forvalues i = 1/`nstats' {c -(}
    = forvalues i = 1/3 {c -(}
    - local name`i' ``i''
    = local name1 p25
    - local names "`names' ``i''"
    = local names " p25"
    - if `i' < `nstats' {c -(}
    = if 1 < 3 {c -(}
    - local names "`names',"
    = local names " p25,"
    - {c )-}
    - {c )-}
    - local name`i' ``i''
    = local name2 p50
    - local names "`names' ``i''"
    = local names " p25, p50"
    - if `i' < `nstats' {c -(}
    = if 2 < 3 {c -(}
    - local names "`names',"
    = local names " p25, p50,"
    - {c )-}
    - {c )-}
    - local name`i' ``i''
    = local name3 p75
    - local names "`names' ``i''"
    = local names " p25, p50, p75"
    - if `i' < `nstats' {c -(}
    = if 3 < 3 {c -(}
      local names "`names',"
      {c )-}
    - {c )-}
    - if "`separator'" == "" & ( (`nstats' > 1 & "`incol'" == "variables") |(`nvars' > 1 & "`incol'" == "statistics")) {c -(}
    = if "" == "" & ( (3 > 1 & "statistics" == "variables") |(1 > 1 & "statistics" == "statistics")) {c -(}
      local sepline yes
      {c )-}
    - local matsize : set matsize
    - local matreq = max(`nstats',`nvars')
    = local matreq = max(3,1)
    - if `matsize' < `matreq' {c -(}
    = if 400 < 3 {c -(}
      di as err "set matsize to at least `matreq' (see help matsize for details)"
      exit 908
      {c )-}
    - if "`by'" != "" {c -(}
    = if "" != "" {c -(}
      qui replace `touse' = - `touse'
      sort `touse' `by'
      local bytype : type `by'
      local by2 0
      local iby 1
      while `by2' < `ntouse' {c -(}
      tempname Stat`iby'
      mat `Stat`iby'' = J(`nstats',`nvars',0)
      mat colnames `Stat`iby'' = `varlist'
      mat rownames `Stat`iby'' = `stats'
      local by1 = `by2' + 1
      qui count if (`by'==`by'[`by1']) & (`touse')
      local by2 = `by1' + r(N) - 1
      forvalues i = 1/`nvars' {c -(}
      qui summ `var`i'' in `by1'/`by2' `wght', `summopt'
      forvalues is = 1/`nstats' {c -(}
      mat `Stat`iby''[`is',`i'] = `expr`is''
      {c )-}
      {c )-}
      if bsubstr("`bytype'",1,3) != "str" {c -(}
      local iby1 = `by'[`by1']
      local lab`iby' : label (`by') `iby1'
      {c )-}
      else {c -(}
      local lab`iby' : di (ubsubstr(`by'[`by1'], 1, c(maxvlabellen)))
      {c )-}
      local iby = `iby' + 1
      {c )-}
      local nby = `iby' - 1
      {c )-}
    - else {c -(}
    - local nby 0
    - {c )-}
    - if "`total'" == "" {c -(}
    = if "" == "" {c -(}
    - local iby = `nby'+1
    = local iby = 0+1
    - tempname Stat`iby'
    = tempname Stat1
    - mat `Stat`iby'' = J(`nstats',`nvars',0)
    = mat __000003 = J(3,1,0)
    - mat colnames `Stat`iby'' = `varlist'
    = mat colnames __000003 = qol
    - mat rownames `Stat`iby'' = `stats'
    = mat rownames __000003 = p25 p50 p75
    - forvalues i = 1/`nvars' {c -(}
    = forvalues i = 1/1 {c -(}
    - qui summ `var`i'' if `touse' `wght' , `summopt'
    = qui summ qol if __000002  , detail
    - forvalues is = 1/`nstats' {c -(}
    = forvalues is = 1/3 {c -(}
    - mat `Stat`iby''[`is',`i'] = `expr`is''
    = mat __000003[1,1] = r(p25)
    - {c )-}
    - mat `Stat`iby''[`is',`i'] = `expr`is''
    = mat __000003[2,1] = r(p50)
    - {c )-}
    - mat `Stat`iby''[`is',`i'] = `expr`is''
    = mat __000003[3,1] = r(p75)
    - {c )-}
    - {c )-}
    - local lab`iby' "Total"
    = local lab1 "Total"
    - {c )-}
    - if "`by'" != "" {c -(}
    = if "" != "" {c -(}
      if bsubstr("`bytype'",1,3) != "str" {c -(}
      local lv : value label `by'
      if "`lv'" != "" {c -(}
      local lg : label (`by') maxlength
      local byw = min(`labelwidth',`lg')
      {c )-}
      else {c -(}
      local byw 8
      {c )-}
      {c )-}
      else {c -(}
      local byw=min(real(bsubstr("`bytype'",4,.)),`labelwidth')
      local bytype str
      {c )-}
      capture local for : format `by'
      capture local if_date_for = bsubstr("`for'", index("`for'", "%"), index("`for'", "d"))
      capture local if_time_for = bsubstr("`for'", index("`for'", "%"), index("`for'", "t"))
      if "`if_date_for'" == "%d" | "`if_time_for'" == "%t" {c -(}
      if "`if_date_for'" == "%d" {c -(}
      local has_M = index("`for'", "M")
      local has_L = index("`for'", "L")
      if `has_M' > 0 | `has_L' > 0 {c -(}
      local byw = 18
      {c )-}
      else {c -(}
      local byw = 11
      {c )-}
      {c )-}
      else {c -(}
      local byw = 9
      {c )-}
      {c )-}
      else {c -(}
      local byw = max(udstrlen("`by'"), `byw')
      {c )-}
      if "`total'" == "" {c -(}
      local byw = max(`byw', 6)
      {c )-}
      {c )-}
    - else {c -(}
    - local byw 8
    - {c )-}
    - local ndigit 9
    - local colwidth = `ndigit'+1
    = local colwidth = 9+1
    - if "`incol'" == "statistics" {c -(}
    = if "statistics" == "statistics" {c -(}
    - local lleft = (1 + `byw')*("`by'"!="") + (`varwidth'+1)*("`descr'"!="")
    = local lleft = (1 + 8)*(""!="") + (12+1)*("descr"!="")
    - {c )-}
    - else {c -(}
      local lleft = (1 + `byw')*("`by'"!="") + (8+1)*("`descr'"!="")
      {c )-}
    - local cbar = `lleft' + 1
    = local cbar = 13 + 1
    - local lsize = c(linesize)
    - local neblock = int((`lsize' - `cbar')/10)
    = local neblock = int((106 - 14)/10)
    - local nsblock = 1 + int((`nstats'-1)/`neblock')
    = local nsblock = 1 + int((3-1)/9)
    - local nvblock = 1 + int((`nvars'-1)/`neblock')
    = local nvblock = 1 + int((1-1)/9)
    - if "`descr'" != "" & "`by'" != "" {c -(}
    = if "descr" != "" & "" != "" {c -(}
      local byalign lalign
      {c )-}
    - else {c -(}
    - local byalign ralign
    - {c )-}
    - if "`incol'" == "statistics" {c -(}
    = if "statistics" == "statistics" {c -(}
    - if "`descr'" == "" {c -(}
    = if "descr" == "" {c -(}
      di as txt _n `"Summary for variables: `varlist'"'
      if "`by'" != "" {c -(}
      local bylabel : var label `by'
      if `"`bylabel'"' != "" {c -(}
      local bylabel `"(`bylabel')"'
      {c )-}
      di as txt _col(6) `"by categories of: `by' `bylabel'"'
      {c )-}
      {c )-}
    - di

    - local is2 0
    - forvalues isblock = 1/`nsblock' {c -(}
    = forvalues isblock = 1/1 {c -(}
    - local is1 = `is2' + 1
    = local is1 = 0 + 1
    - local is2 = min(`nstats', `is1'+`neblock'-1)
    = local is2 = min(3, 1+9-1)
    - if "`by'" != "" {c -(}
    = if "" != "" {c -(}
      local byname = abbrev("`by'",`byw')
      di as txt "{c -(}`byalign' `byw':`byname'{c )-} {c -(}...{c )-}"
      {c )-}
    - if "`descr'" != "" {c -(}
    = if "descr" != "" {c -(}
    - di as txt "{c -(}ralign `varwidth':variable{c )-} {c -(}...{c )-}"
    = di as txt "{c -(}ralign 12:variable{c )-} {c -(}...{c )-}"
{ralign 12:variable} {...}
    - {c )-}
    - di as txt "{c -(}c |{c )-}" _c
{c |}    - forvalues is = `is1'/`is2' {c -(}
    = forvalues is = 1/3 {c -(}
    - di as txt %`colwidth's "`name`is''" _c
    = di as txt %10s "p25" _c
       p25    - {c )-}
    - di as txt %`colwidth's "`name`is''" _c
    = di as txt %10s "p50" _c
       p50    - {c )-}
    - di as txt %`colwidth's "`name`is''" _c
    = di as txt %10s "p75" _c
       p75    - {c )-}
    - local ndash = `colwidth'*(`is2'-`is1'+1)
    = local ndash = 10*(3-1+1)
    - di as txt _n "{c -(}hline `lleft'{c )-}{c -(}c +{c )-}{c -(}hline `ndash'{c )-}"
    = di as txt _n "{c -(}hline 13{c )-}{c -(}c +{c )-}{c -(}hline 30{c )-}"

{hline 13}{c +}{hline 30}
    - local nbyt = `nby' + ("`total'" == "")
    = local nbyt = 0 + ("" == "")
    - forvalues iby = 1/`nbyt'{c -(}
    = forvalues iby = 1/1{c -(}
    - forvalues i = 1/`nvars' {c -(}
    = forvalues i = 1/1 {c -(}
    - if "`by'" != "" {c -(}
    = if "" != "" {c -(}
      if `i' == 1 {c -(}
      local lab = udsubstr(`"`lab`iby''"', 1,`byw')
      if `"`lab'"' != "Total" {c -(}
      capture local val_lab : value label `by'
      if "`val_lab'" == "" {c -(}
      local type : type `by'
      local yes_str = index("`type'", "str")
      if `yes_str' == 0 {c -(}
      capture local for : format `by'
      capture local if_date_for = index("`for'", "%d")
      capture local if_time_for = index("`for'", "%t")
      if `if_date_for' > 0 | `if_time_for' > 0 {c -(}
      local date_for : display `for' `lab'
      di in txt `"{c -(}`byalign' `byw':`date_for'{c )-} {c -(}...{c )-}"'
      {c )-}
      else {c -(}
      di in txt `"{c -(}`byalign' `byw':`lab'{c )-} {c -(}...{c )-}"'
      {c )-}
      {c )-}
      else {c -(}
      di in txt `"{c -(}`byalign' `byw':`lab'{c )-} {c -(}...{c )-}"'
      {c )-}
      {c )-}
      else {c -(}
      di in txt `"{c -(}`byalign' `byw':`lab'{c )-} {c -(}...{c )-}"'
      {c )-}
      {c )-}
      else {c -(}
      di in txt `"{c -(}`byalign' `byw':`lab'{c )-} {c -(}...{c )-}"'
      {c )-}
      {c )-}
      else {c -(}
      di "{c -(}space `byw'{c )-} {c -(}...{c )-}"
      {c )-}
      {c )-}
    - if "`descr'" != "" {c -(}
    = if "descr" != "" {c -(}
    - local avn = abbrev("`var`i''",`varwidth')
    = local avn = abbrev("qol",12)
    - di as txt "{c -(}ralign `varwidth':`avn'{c )-} {c -(}...{c )-}"
    = di as txt "{c -(}ralign 12:qol{c )-} {c -(}...{c )-}"
{ralign 12:qol} {...}
    - {c )-}
    - di as txt "{c -(}c |{c )-}{c -(}...{c )-}"
{c |}{...}
    - forvalues is = `is1'/`is2' {c -(}
    = forvalues is = 1/3 {c -(}
    - local s : display `fmt`i'' `Stat`iby''[`is',`i']
    = local s : display %9.0g __000003[1,1]
    - di as res %`colwidth's "`s'" _c
    = di as res %10s " 40.56173" _c
 {res} 40.56173    {txt}- {c )-}
    - local s : display `fmt`i'' `Stat`iby''[`is',`i']
    = local s : display %9.0g __000003[2,1]
    - di as res %`colwidth's "`s'" _c
    = di as res %10s "  50.7649" _c
 {res}  50.7649    {txt}- {c )-}
    - local s : display `fmt`i'' `Stat`iby''[`is',`i']
    = local s : display %9.0g __000003[3,1]
    - di as res %`colwidth's "`s'" _c
    = di as res %10s " 60.73298" _c
 {res} 60.73298    {txt}- {c )-}
    - di

    - {c )-}
    - if (`iby' >= `nbyt') {c -(}
    = if (1 >= 1) {c -(}
    - di as txt "{c -(}hline `lleft'{c )-}{c -(}c BT{c )-}{c -(}hline `ndash'{c )-}"
    = di as txt "{c -(}hline 13{c )-}{c -(}c BT{c )-}{c -(}hline 30{c )-}"
{hline 13}{c BT}{hline 30}
    - {c )-}
    - else if ("`sepline'" != "") | ((`iby'+1 == `nbyt') & ("`total'" == "")) {c -(}
    = else if ("" != "") | ((1+1 == 1) & ("" == "")) {c -(}
      di as txt "{c -(}hline `lleft'{c )-}{c -(}c +{c )-}{c -(}hline `ndash'{c )-}"
      {c )-}
    - {c )-}
    - if `isblock' < `nsblock' {c -(}
    = if 1 < 1 {c -(}
      display
      {c )-}
    - {c )-}
    - {c )-}
    - else {c -(}
      if "`descr'" == "" {c -(}
      di as txt _n `"Summary statistics:`names'"'
      if "`by'" != "" {c -(}
      local bylabel : var label `by'
      if `"`bylabel'"' != "" {c -(}
      local bylabel `"(`bylabel')"'
      {c )-}
      di as txt `"  by categories of: `by' `bylabel'"'
      {c )-}
      {c )-}
      di
      local i2 0
      forvalues iblock = 1/`nvblock' {c -(}
      local i1 = `i2' + 1
      local i2 = min(`nvars', `i1'+`neblock'-1)
      if "`by'" != "" {c -(}
      di as txt "{c -(}`byalign' `byw':`by'{c )-} {c -(}...{c )-}"
      {c )-}
      if "`descr'" != "" {c -(}
      di as txt "   stats {c -(}...{c )-}"
      {c )-}
      di as txt "{c -(}c |{c )-}{c -(}...{c )-}"
      forvalues i = `i1'/`i2' {c -(}
      di as txt %`colwidth's abbrev("`var`i''",8) _c
      {c )-}
      local ndash = (`ndigit'+1)*(`i2'-`i1'+1)
      di as txt _n "{c -(}hline `lleft'{c )-}{c -(}c +{c )-}{c -(}hline `ndash'{c )-}"
      local nbyt = `nby' + ("`total'" == "")
      forvalues iby = 1/`nbyt'{c -(}
      forvalues is = 1/`nstats' {c -(}
      if "`by'" != "" {c -(}
      if `is' == 1 {c -(}
      local lab = udsubstr(`"`lab`iby''"', 1, `byw')
      di as txt `"{c -(}`byalign' `byw':`lab'{c )-} {c -(}...{c )-}"'
      {c )-}
      else {c -(}
      di as txt "{c -(}space `byw'{c )-} {c -(}...{c )-}"
      {c )-}
      {c )-}
      if "`descr'" != "" {c -(}
      di as txt `"{c -(}ralign 8:`name`is''{c )-} {c -(}...{c )-}"'
      {c )-}
      di as txt "{c -(}c |{c )-}{c -(}...{c )-}"
      forvalues i = `i1'/`i2' {c -(}
      local s : display `fmt`i'' `Stat`iby''[`is',`i']
      di as res %`colwidth's "`s'" _c
      {c )-}
      di
      {c )-}
      if (`iby' >= `nbyt') {c -(}
      di as txt "{c -(}hline `lleft'{c )-}{c -(}c BT{c )-}{c -(}hline `ndash'{c )-}"
      {c )-}
      else if ("`sepline'" != "") | ((`iby'+1 == `nbyt') & ("`total'" == "")) {c -(}
      di as txt "{c -(}hline `lleft'{c )-}{c -(}c +{c )-}{c -(}hline `ndash'{c )-}"
      {c )-}
      {c )-}
      if `iblock' < `nvblock' {c -(}
      display
      {c )-}
      {c )-}
      {c )-}
    - if "`save'" != "" {c -(}
    = if "save" != "" {c -(}
    - if "`total'" == "" {c -(}
    = if "" == "" {c -(}
    - local iby = `nby'+1
    = local iby = 0+1
    - if _caller() < 9 {c -(}
      return matrix StatTot `Stat`iby''
      {c )-}
    - else {c -(}
    - return matrix StatTotal `Stat`iby''
    = return matrix StatTotal __000003
    - {c )-}
    - {c )-}
    - if "`by'" == "" {c -(}
    = if "" == "" {c -(}
    - exit
    {hline 86} end tabstat {hline}
  - mat define A = r(StatTotal)
  - local median = string(A[2,1], "%12.`su_decimal'f")
  = local median = string(A[2,1], "%12.1f")
  - local q1 = string(A[1,1], "%12.`su_decimal'f")
  = local q1 = string(A[1,1], "%12.1f")
  - local q3 = string(A[3,1], "%12.`su_decimal'f")
  = local q3 = string(A[3,1], "%12.1f")
  - local su_`i' ("`median' (`q1'-`q3') `brackets_`i''")
  = local su_1 ("50.8 (40.6-60.7) ")
  - {c )-}
  - {c )-}
  - if "`type1'" == "cont" {c -(}
  = if "skew" == "cont" {c -(}
    di "Group `i'"
    if "`i'" == "overall" su `v'
    if "`i'" != "overall" su `v' if `over' == `i'
    local mean = string(r(mean), "%12.`su_decimal'f")
    local sd = string(r(sd), "%12.`su_decimal'f")
    local su_`i' ("`mean' (`sd') `brackets_`i''")
    {c )-}
  - if "`type1'" == "bin" {c -(}
  = if "skew" == "bin" {c -(}
    if "`i'" == "overall" qui count if `v'==`positive'
    if "`i'" != "overall" qui count if `v'==`positive' & `over' == `i'
    scalar count_treat_positive_`i' = r(N)
    local n = count_treat_positive_`i'
    if "`count_only'" == ""{c -(}
    local percent = count_treat_positive_`i'/`N_`i''*100
    local per_str = string(`percent', "%12.`su_decimal'f")
    local per_str (`per_str'`per')
    {c )-}
    local su_`i' ("`n' `per_str' `brackets_`i''")
    {c )-}
  - if "`type1'" == "skew" {c -(}
  = if "skew" == "skew" {c -(}
  - di "Group `i'"
  = di "Group 0"
Group 0
  - if "`i'" == "overall" tabstat `v', stats(q) save
  = if "0" == "overall" tabstat qol, stats(q) save
  - if "`i'" != "overall" tabstat `v' if `over' == `i', stats(q) save
  = if "0" != "overall" tabstat qol if treat == 0, stats(q) save
    {hline 84} begin tabstat {hline}
    - version 8, missing
    - syntax varlist(numeric) [if] [in] [aw fw] [ , BY(varname) CASEwise Columns(str) Format Format2(str) LAbelwidth(int -1) VArwidth(int -1) LOngstub Missing SAME SAVE noSEParator Statistics(str) STATS(str) noTotal ]
    - if "`casewise'" != "" {c -(}
    = if "" != "" {c -(}
      local same same
      {c )-}
    - if `"`stats'"' != "" {c -(}
    = if `"q"' != "" {c -(}
    - if `"`statistics'"' != "" {c -(}
    = if `""' != "" {c -(}
      di as err "may not specify both statistics() and stats() options"
      exit 198
      {c )-}
    - local statistics `"`stats'"'
    = local statistics `"q"'
    - local stats
    - {c )-}
    - if "`total'" != "" & "`by'" == "" {c -(}
    = if "" != "" & "" == "" {c -(}
      di as txt "nothing to display"
      exit 0
      {c )-}
    - if "`format'" != "" & `"`format2'"' != "" {c -(}
    = if "" != "" & `""' != "" {c -(}
      di as err "may not specify both format and format()"
      exit 198
      {c )-}
    - if `"`format2'"' != "" {c -(}
    = if `""' != "" {c -(}
      capt local tmp : display `format2' 1
      if _rc {c -(}
      di as err `"invalid %fmt in format(): `format2'"'
      exit 120
      {c )-}
      {c )-}
    - if `"`columns'"' == "" {c -(}
    = if `""' == "" {c -(}
    - local incol "variables"
    - {c )-}
    - else if `"`columns'"' == bsubstr("variables",1,length(`"`columns'"')) {c -(}
    = else if `""' == bsubstr("variables",1,length(`""')) {c -(}
      local incol "variables"
      {c )-}
    - else if `"`columns'"' == bsubstr("statistics",1,length(`"`columns'"')) {c -(}
    = else if `""' == bsubstr("statistics",1,length(`""')) {c -(}
      local incol "statistics"
      {c )-}
    - else if `"`columns'"' == "stats" {c -(}
    = else if `""' == "stats" {c -(}
      local incol "statistics"
      {c )-}
    - else {c -(}
      di as err `"column(`columns') invalid -- specify "' "column(variables) or column(statistics)"
      exit 198
      {c )-}
    - if "`longstub'" != "" | "`by'" == "" | `varwidth' != -1 {c -(}
    = if "" != "" | "" == "" | -1 != -1 {c -(}
    - local descr descr
    - {c )-}
    - if `varwidth' == -1 {c -(}
    = if -1 == -1 {c -(}
    - local varwidth 12
    - {c )-}
    - else if !inrange(`varwidth',8,c(namelen)) {c -(}
    = else if !inrange(12,8,c(namelen)) {c -(}
      local varwidth = clip(`varwidth',8,c(namelen))
      dis as txt "(option varwidth() outside valid range 8..`c(namelen)'; `varwidth' assumed)"
      {c )-}
    - if `labelwidth' == -1 {c -(}
    = if -1 == -1 {c -(}
    - local labelwidth 16
    - {c )-}
    - else if !inrange(`labelwidth',8,32) {c -(}
    = else if !inrange(16,8,32) {c -(}
      local labelwidth = clip(`labelwidth',8,32)
      dis as txt "(option labelwidth() outside valid range 8..32; `labelwidth' assumed)"
      {c )-}
    - marksample touse, novar
    - if "`same'" != "" {c -(}
    = if "" != "" {c -(}
      markout `touse' `varlist'
      {c )-}
    - if "`by'" != "" & "`missing'" == "" {c -(}
    = if "" != "" & "" == "" {c -(}
      markout `touse' `by' , strok
      {c )-}
    - qui count if `touse'
    = qui count if __000002
    - local ntouse = r(N)
    - if `ntouse' == 0 {c -(}
    = if 494 == 0 {c -(}
      error 2000
      {c )-}
    - if `"`weight'"' != "" {c -(}
    = if `""' != "" {c -(}
      local wght `"[`weight'`exp']"'
      {c )-}
    - tokenize "`varlist'"
    = tokenize "qol"
    - local nvars : word count `varlist'
    = local nvars : word count qol
    - forvalues i = 1/`nvars' {c -(}
    = forvalues i = 1/1 {c -(}
    - local var`i' ``i''
    = local var1 qol
    - if "`format'" != "" {c -(}
    = if "" != "" {c -(}
      local fmt`i' : format ``i''
      {c )-}
    - else if `"`format2'"' != "" {c -(}
    = else if `""' != "" {c -(}
      local fmt`i' `format2'
      {c )-}
    - else {c -(}
    - local fmt`i' %9.0g
    = local fmt1 %9.0g
    - {c )-}
    - {c )-}
    - if `nvars' == 1 & `"`columns'"' == "" {c -(}
    = if 1 == 1 & `""' == "" {c -(}
    - local incol statistics
    - {c )-}
    - Stats `statistics'
    = Stats q
      {hline 76} begin tabstat.Stats {hline}
      - if `"`0'"' == "" {c -(}
      = if `"q"' == "" {c -(}
        local opt "mean"
        {c )-}
      - else {c -(}
      - local opt `"`0'"'
      = local opt `"q"'
      - {c )-}
      - local class 0
      - foreach st of local opt {c -(}
      - local 0 = lower(`", `st'"')
      = local 0 = lower(`", q"')
      - capt syntax [, n MEan sd Variance SUm COunt MIn MAx Range SKewness Kurtosis SDMean SEMean p1 p5 p10 p25 p50 p75 p90 p95 p99 iqr q MEDian CV ]
      - if _rc {c -(}
        di in err `"unknown statistic: `st'"'
        exit 198
        {c )-}
      - if "`median'" != "" {c -(}
      = if "" != "" {c -(}
        local p50 p50
        {c )-}
      - if "`count'" != "" {c -(}
      = if "" != "" {c -(}
        local n n
        {c )-}
      - if "`n'" != "" {c -(}
      = if "" != "" {c -(}
        local n N
        {c )-}
      - local s "`n'`min'`mean'`max'`sum'"
      = local s ""
      - if "`s'" != "" {c -(}
      = if "" != "" {c -(}
        local names "`names' `s'"
        local expr "`expr' r(`s')"
        local class = max(`class',1)
        {c )-}
      - if "`range'" != "" {c -(}
      = if "" != "" {c -(}
        local names "`names' range"
        local expr "`expr' r(max)-r(min)"
        local class = max(`class',1)
        {c )-}
      - if "`sd'" != "" {c -(}
      = if "" != "" {c -(}
        local names "`names' sd"
        local expr "`expr' r(sd)"
        local class = max(`class',2)
        {c )-}
      - if "`sdmean'" != "" | "`semean'"!="" {c -(}
      = if "" != "" | ""!="" {c -(}
        local names "`names' se(mean)"
        local expr "`expr' r(sd)/sqrt(r(N))"
        local class = max(`class',2)
        {c )-}
      - if "`variance'" != "" {c -(}
      = if "" != "" {c -(}
        local names "`names' variance"
        local expr "`expr' r(Var)"
        local class = max(`class',2)
        {c )-}
      - if "`cv'" != "" {c -(}
      = if "" != "" {c -(}
        local names "`names' cv"
        local expr "`expr' (r(sd)/r(mean))"
        local class = max(`class',2)
        {c )-}
      - local s "`skewness'`kurtosis'`p1'`p5'`p10'`p25'`p50'`p75'`p90'`p95'`p99'"
      = local s ""
      - if "`s'" != "" {c -(}
      = if "" != "" {c -(}
        local names "`names' `s'"
        local expr "`expr' r(`s')"
        local class = max(`class',3)
        {c )-}
      - if "`iqr'" != "" {c -(}
      = if "" != "" {c -(}
        local names "`names' iqr"
        local expr "`expr' r(p75)-r(p25)"
        local class = max(`class',3)
        {c )-}
      - if "`q'" != "" {c -(}
      = if "q" != "" {c -(}
      - local names "`names' p25 p50 p75"
      = local names " p25 p50 p75"
      - local expr "`expr' r(p25) r(p50) r(p75)"
      = local expr " r(p25) r(p50) r(p75)"
      - local class = max(`class',3)
      = local class = max(0,3)
      - {c )-}
      - {c )-}
      - return local names `names'
      = return local names  p25 p50 p75
      - return local expr `expr'
      = return local expr  r(p25) r(p50) r(p75)
      - if `class' == 1 {c -(}
      = if 3 == 1 {c -(}
        return local summopt "meanonly"
        {c )-}
      - else if `class' == 3 {c -(}
      = else if 3 == 3 {c -(}
      - return local summopt "detail"
      - {c )-}
      {hline 78} end tabstat.Stats {hline}
    - local stats `r(names)'
    = local stats p25 p50 p75
    - local expr `r(expr)'
    = local expr r(p25) r(p50) r(p75)
    - local summopt `r(summopt)'
    = local summopt detail
    - local nstats : word count `stats'
    = local nstats : word count p25 p50 p75
    - tokenize `expr'
    = tokenize r(p25) r(p50) r(p75)
    - forvalues i = 1/`nstats' {c -(}
    = forvalues i = 1/3 {c -(}
    - local expr`i' ``i''
    = local expr1 r(p25)
    - {c )-}
    - local expr`i' ``i''
    = local expr2 r(p50)
    - {c )-}
    - local expr`i' ``i''
    = local expr3 r(p75)
    - {c )-}
    - tokenize `stats'
    = tokenize p25 p50 p75
    - forvalues i = 1/`nstats' {c -(}
    = forvalues i = 1/3 {c -(}
    - local name`i' ``i''
    = local name1 p25
    - local names "`names' ``i''"
    = local names " p25"
    - if `i' < `nstats' {c -(}
    = if 1 < 3 {c -(}
    - local names "`names',"
    = local names " p25,"
    - {c )-}
    - {c )-}
    - local name`i' ``i''
    = local name2 p50
    - local names "`names' ``i''"
    = local names " p25, p50"
    - if `i' < `nstats' {c -(}
    = if 2 < 3 {c -(}
    - local names "`names',"
    = local names " p25, p50,"
    - {c )-}
    - {c )-}
    - local name`i' ``i''
    = local name3 p75
    - local names "`names' ``i''"
    = local names " p25, p50, p75"
    - if `i' < `nstats' {c -(}
    = if 3 < 3 {c -(}
      local names "`names',"
      {c )-}
    - {c )-}
    - if "`separator'" == "" & ( (`nstats' > 1 & "`incol'" == "variables") |(`nvars' > 1 & "`incol'" == "statistics")) {c -(}
    = if "" == "" & ( (3 > 1 & "statistics" == "variables") |(1 > 1 & "statistics" == "statistics")) {c -(}
      local sepline yes
      {c )-}
    - local matsize : set matsize
    - local matreq = max(`nstats',`nvars')
    = local matreq = max(3,1)
    - if `matsize' < `matreq' {c -(}
    = if 400 < 3 {c -(}
      di as err "set matsize to at least `matreq' (see help matsize for details)"
      exit 908
      {c )-}
    - if "`by'" != "" {c -(}
    = if "" != "" {c -(}
      qui replace `touse' = - `touse'
      sort `touse' `by'
      local bytype : type `by'
      local by2 0
      local iby 1
      while `by2' < `ntouse' {c -(}
      tempname Stat`iby'
      mat `Stat`iby'' = J(`nstats',`nvars',0)
      mat colnames `Stat`iby'' = `varlist'
      mat rownames `Stat`iby'' = `stats'
      local by1 = `by2' + 1
      qui count if (`by'==`by'[`by1']) & (`touse')
      local by2 = `by1' + r(N) - 1
      forvalues i = 1/`nvars' {c -(}
      qui summ `var`i'' in `by1'/`by2' `wght', `summopt'
      forvalues is = 1/`nstats' {c -(}
      mat `Stat`iby''[`is',`i'] = `expr`is''
      {c )-}
      {c )-}
      if bsubstr("`bytype'",1,3) != "str" {c -(}
      local iby1 = `by'[`by1']
      local lab`iby' : label (`by') `iby1'
      {c )-}
      else {c -(}
      local lab`iby' : di (ubsubstr(`by'[`by1'], 1, c(maxvlabellen)))
      {c )-}
      local iby = `iby' + 1
      {c )-}
      local nby = `iby' - 1
      {c )-}
    - else {c -(}
    - local nby 0
    - {c )-}
    - if "`total'" == "" {c -(}
    = if "" == "" {c -(}
    - local iby = `nby'+1
    = local iby = 0+1
    - tempname Stat`iby'
    = tempname Stat1
    - mat `Stat`iby'' = J(`nstats',`nvars',0)
    = mat __000003 = J(3,1,0)
    - mat colnames `Stat`iby'' = `varlist'
    = mat colnames __000003 = qol
    - mat rownames `Stat`iby'' = `stats'
    = mat rownames __000003 = p25 p50 p75
    - forvalues i = 1/`nvars' {c -(}
    = forvalues i = 1/1 {c -(}
    - qui summ `var`i'' if `touse' `wght' , `summopt'
    = qui summ qol if __000002  , detail
    - forvalues is = 1/`nstats' {c -(}
    = forvalues is = 1/3 {c -(}
    - mat `Stat`iby''[`is',`i'] = `expr`is''
    = mat __000003[1,1] = r(p25)
    - {c )-}
    - mat `Stat`iby''[`is',`i'] = `expr`is''
    = mat __000003[2,1] = r(p50)
    - {c )-}
    - mat `Stat`iby''[`is',`i'] = `expr`is''
    = mat __000003[3,1] = r(p75)
    - {c )-}
    - {c )-}
    - local lab`iby' "Total"
    = local lab1 "Total"
    - {c )-}
    - if "`by'" != "" {c -(}
    = if "" != "" {c -(}
      if bsubstr("`bytype'",1,3) != "str" {c -(}
      local lv : value label `by'
      if "`lv'" != "" {c -(}
      local lg : label (`by') maxlength
      local byw = min(`labelwidth',`lg')
      {c )-}
      else {c -(}
      local byw 8
      {c )-}
      {c )-}
      else {c -(}
      local byw=min(real(bsubstr("`bytype'",4,.)),`labelwidth')
      local bytype str
      {c )-}
      capture local for : format `by'
      capture local if_date_for = bsubstr("`for'", index("`for'", "%"), index("`for'", "d"))
      capture local if_time_for = bsubstr("`for'", index("`for'", "%"), index("`for'", "t"))
      if "`if_date_for'" == "%d" | "`if_time_for'" == "%t" {c -(}
      if "`if_date_for'" == "%d" {c -(}
      local has_M = index("`for'", "M")
      local has_L = index("`for'", "L")
      if `has_M' > 0 | `has_L' > 0 {c -(}
      local byw = 18
      {c )-}
      else {c -(}
      local byw = 11
      {c )-}
      {c )-}
      else {c -(}
      local byw = 9
      {c )-}
      {c )-}
      else {c -(}
      local byw = max(udstrlen("`by'"), `byw')
      {c )-}
      if "`total'" == "" {c -(}
      local byw = max(`byw', 6)
      {c )-}
      {c )-}
    - else {c -(}
    - local byw 8
    - {c )-}
    - local ndigit 9
    - local colwidth = `ndigit'+1
    = local colwidth = 9+1
    - if "`incol'" == "statistics" {c -(}
    = if "statistics" == "statistics" {c -(}
    - local lleft = (1 + `byw')*("`by'"!="") + (`varwidth'+1)*("`descr'"!="")
    = local lleft = (1 + 8)*(""!="") + (12+1)*("descr"!="")
    - {c )-}
    - else {c -(}
      local lleft = (1 + `byw')*("`by'"!="") + (8+1)*("`descr'"!="")
      {c )-}
    - local cbar = `lleft' + 1
    = local cbar = 13 + 1
    - local lsize = c(linesize)
    - local neblock = int((`lsize' - `cbar')/10)
    = local neblock = int((106 - 14)/10)
    - local nsblock = 1 + int((`nstats'-1)/`neblock')
    = local nsblock = 1 + int((3-1)/9)
    - local nvblock = 1 + int((`nvars'-1)/`neblock')
    = local nvblock = 1 + int((1-1)/9)
    - if "`descr'" != "" & "`by'" != "" {c -(}
    = if "descr" != "" & "" != "" {c -(}
      local byalign lalign
      {c )-}
    - else {c -(}
    - local byalign ralign
    - {c )-}
    - if "`incol'" == "statistics" {c -(}
    = if "statistics" == "statistics" {c -(}
    - if "`descr'" == "" {c -(}
    = if "descr" == "" {c -(}
      di as txt _n `"Summary for variables: `varlist'"'
      if "`by'" != "" {c -(}
      local bylabel : var label `by'
      if `"`bylabel'"' != "" {c -(}
      local bylabel `"(`bylabel')"'
      {c )-}
      di as txt _col(6) `"by categories of: `by' `bylabel'"'
      {c )-}
      {c )-}
    - di

    - local is2 0
    - forvalues isblock = 1/`nsblock' {c -(}
    = forvalues isblock = 1/1 {c -(}
    - local is1 = `is2' + 1
    = local is1 = 0 + 1
    - local is2 = min(`nstats', `is1'+`neblock'-1)
    = local is2 = min(3, 1+9-1)
    - if "`by'" != "" {c -(}
    = if "" != "" {c -(}
      local byname = abbrev("`by'",`byw')
      di as txt "{c -(}`byalign' `byw':`byname'{c )-} {c -(}...{c )-}"
      {c )-}
    - if "`descr'" != "" {c -(}
    = if "descr" != "" {c -(}
    - di as txt "{c -(}ralign `varwidth':variable{c )-} {c -(}...{c )-}"
    = di as txt "{c -(}ralign 12:variable{c )-} {c -(}...{c )-}"
{ralign 12:variable} {...}
    - {c )-}
    - di as txt "{c -(}c |{c )-}" _c
{c |}    - forvalues is = `is1'/`is2' {c -(}
    = forvalues is = 1/3 {c -(}
    - di as txt %`colwidth's "`name`is''" _c
    = di as txt %10s "p25" _c
       p25    - {c )-}
    - di as txt %`colwidth's "`name`is''" _c
    = di as txt %10s "p50" _c
       p50    - {c )-}
    - di as txt %`colwidth's "`name`is''" _c
    = di as txt %10s "p75" _c
       p75    - {c )-}
    - local ndash = `colwidth'*(`is2'-`is1'+1)
    = local ndash = 10*(3-1+1)
    - di as txt _n "{c -(}hline `lleft'{c )-}{c -(}c +{c )-}{c -(}hline `ndash'{c )-}"
    = di as txt _n "{c -(}hline 13{c )-}{c -(}c +{c )-}{c -(}hline 30{c )-}"

{hline 13}{c +}{hline 30}
    - local nbyt = `nby' + ("`total'" == "")
    = local nbyt = 0 + ("" == "")
    - forvalues iby = 1/`nbyt'{c -(}
    = forvalues iby = 1/1{c -(}
    - forvalues i = 1/`nvars' {c -(}
    = forvalues i = 1/1 {c -(}
    - if "`by'" != "" {c -(}
    = if "" != "" {c -(}
      if `i' == 1 {c -(}
      local lab = udsubstr(`"`lab`iby''"', 1,`byw')
      if `"`lab'"' != "Total" {c -(}
      capture local val_lab : value label `by'
      if "`val_lab'" == "" {c -(}
      local type : type `by'
      local yes_str = index("`type'", "str")
      if `yes_str' == 0 {c -(}
      capture local for : format `by'
      capture local if_date_for = index("`for'", "%d")
      capture local if_time_for = index("`for'", "%t")
      if `if_date_for' > 0 | `if_time_for' > 0 {c -(}
      local date_for : display `for' `lab'
      di in txt `"{c -(}`byalign' `byw':`date_for'{c )-} {c -(}...{c )-}"'
      {c )-}
      else {c -(}
      di in txt `"{c -(}`byalign' `byw':`lab'{c )-} {c -(}...{c )-}"'
      {c )-}
      {c )-}
      else {c -(}
      di in txt `"{c -(}`byalign' `byw':`lab'{c )-} {c -(}...{c )-}"'
      {c )-}
      {c )-}
      else {c -(}
      di in txt `"{c -(}`byalign' `byw':`lab'{c )-} {c -(}...{c )-}"'
      {c )-}
      {c )-}
      else {c -(}
      di in txt `"{c -(}`byalign' `byw':`lab'{c )-} {c -(}...{c )-}"'
      {c )-}
      {c )-}
      else {c -(}
      di "{c -(}space `byw'{c )-} {c -(}...{c )-}"
      {c )-}
      {c )-}
    - if "`descr'" != "" {c -(}
    = if "descr" != "" {c -(}
    - local avn = abbrev("`var`i''",`varwidth')
    = local avn = abbrev("qol",12)
    - di as txt "{c -(}ralign `varwidth':`avn'{c )-} {c -(}...{c )-}"
    = di as txt "{c -(}ralign 12:qol{c )-} {c -(}...{c )-}"
{ralign 12:qol} {...}
    - {c )-}
    - di as txt "{c -(}c |{c )-}{c -(}...{c )-}"
{c |}{...}
    - forvalues is = `is1'/`is2' {c -(}
    = forvalues is = 1/3 {c -(}
    - local s : display `fmt`i'' `Stat`iby''[`is',`i']
    = local s : display %9.0g __000003[1,1]
    - di as res %`colwidth's "`s'" _c
    = di as res %10s " 39.00128" _c
 {res} 39.00128    {txt}- {c )-}
    - local s : display `fmt`i'' `Stat`iby''[`is',`i']
    = local s : display %9.0g __000003[2,1]
    - di as res %`colwidth's "`s'" _c
    = di as res %10s " 49.60532" _c
 {res} 49.60532    {txt}- {c )-}
    - local s : display `fmt`i'' `Stat`iby''[`is',`i']
    = local s : display %9.0g __000003[3,1]
    - di as res %`colwidth's "`s'" _c
    = di as res %10s " 59.21922" _c
 {res} 59.21922    {txt}- {c )-}
    - di

    - {c )-}
    - if (`iby' >= `nbyt') {c -(}
    = if (1 >= 1) {c -(}
    - di as txt "{c -(}hline `lleft'{c )-}{c -(}c BT{c )-}{c -(}hline `ndash'{c )-}"
    = di as txt "{c -(}hline 13{c )-}{c -(}c BT{c )-}{c -(}hline 30{c )-}"
{hline 13}{c BT}{hline 30}
    - {c )-}
    - else if ("`sepline'" != "") | ((`iby'+1 == `nbyt') & ("`total'" == "")) {c -(}
    = else if ("" != "") | ((1+1 == 1) & ("" == "")) {c -(}
      di as txt "{c -(}hline `lleft'{c )-}{c -(}c +{c )-}{c -(}hline `ndash'{c )-}"
      {c )-}
    - {c )-}
    - if `isblock' < `nsblock' {c -(}
    = if 1 < 1 {c -(}
      display
      {c )-}
    - {c )-}
    - {c )-}
    - else {c -(}
      if "`descr'" == "" {c -(}
      di as txt _n `"Summary statistics:`names'"'
      if "`by'" != "" {c -(}
      local bylabel : var label `by'
      if `"`bylabel'"' != "" {c -(}
      local bylabel `"(`bylabel')"'
      {c )-}
      di as txt `"  by categories of: `by' `bylabel'"'
      {c )-}
      {c )-}
      di
      local i2 0
      forvalues iblock = 1/`nvblock' {c -(}
      local i1 = `i2' + 1
      local i2 = min(`nvars', `i1'+`neblock'-1)
      if "`by'" != "" {c -(}
      di as txt "{c -(}`byalign' `byw':`by'{c )-} {c -(}...{c )-}"
      {c )-}
      if "`descr'" != "" {c -(}
      di as txt "   stats {c -(}...{c )-}"
      {c )-}
      di as txt "{c -(}c |{c )-}{c -(}...{c )-}"
      forvalues i = `i1'/`i2' {c -(}
      di as txt %`colwidth's abbrev("`var`i''",8) _c
      {c )-}
      local ndash = (`ndigit'+1)*(`i2'-`i1'+1)
      di as txt _n "{c -(}hline `lleft'{c )-}{c -(}c +{c )-}{c -(}hline `ndash'{c )-}"
      local nbyt = `nby' + ("`total'" == "")
      forvalues iby = 1/`nbyt'{c -(}
      forvalues is = 1/`nstats' {c -(}
      if "`by'" != "" {c -(}
      if `is' == 1 {c -(}
      local lab = udsubstr(`"`lab`iby''"', 1, `byw')
      di as txt `"{c -(}`byalign' `byw':`lab'{c )-} {c -(}...{c )-}"'
      {c )-}
      else {c -(}
      di as txt "{c -(}space `byw'{c )-} {c -(}...{c )-}"
      {c )-}
      {c )-}
      if "`descr'" != "" {c -(}
      di as txt `"{c -(}ralign 8:`name`is''{c )-} {c -(}...{c )-}"'
      {c )-}
      di as txt "{c -(}c |{c )-}{c -(}...{c )-}"
      forvalues i = `i1'/`i2' {c -(}
      local s : display `fmt`i'' `Stat`iby''[`is',`i']
      di as res %`colwidth's "`s'" _c
      {c )-}
      di
      {c )-}
      if (`iby' >= `nbyt') {c -(}
      di as txt "{c -(}hline `lleft'{c )-}{c -(}c BT{c )-}{c -(}hline `ndash'{c )-}"
      {c )-}
      else if ("`sepline'" != "") | ((`iby'+1 == `nbyt') & ("`total'" == "")) {c -(}
      di as txt "{c -(}hline `lleft'{c )-}{c -(}c +{c )-}{c -(}hline `ndash'{c )-}"
      {c )-}
      {c )-}
      if `iblock' < `nvblock' {c -(}
      display
      {c )-}
      {c )-}
      {c )-}
    - if "`save'" != "" {c -(}
    = if "save" != "" {c -(}
    - if "`total'" == "" {c -(}
    = if "" == "" {c -(}
    - local iby = `nby'+1
    = local iby = 0+1
    - if _caller() < 9 {c -(}
      return matrix StatTot `Stat`iby''
      {c )-}
    - else {c -(}
    - return matrix StatTotal `Stat`iby''
    = return matrix StatTotal __000003
    - {c )-}
    - {c )-}
    - if "`by'" == "" {c -(}
    = if "" == "" {c -(}
    - exit
    {hline 86} end tabstat {hline}
  - mat define A = r(StatTotal)
  - local median = string(A[2,1], "%12.`su_decimal'f")
  = local median = string(A[2,1], "%12.1f")
  - local q1 = string(A[1,1], "%12.`su_decimal'f")
  = local q1 = string(A[1,1], "%12.1f")
  - local q3 = string(A[3,1], "%12.`su_decimal'f")
  = local q3 = string(A[3,1], "%12.1f")
  - local su_`i' ("`median' (`q1'-`q3') `brackets_`i''")
  = local su_0 ("49.6 (39.0-59.2) ")
  - {c )-}
  - {c )-}
  - if "`type1'" == "cont" {c -(}
  = if "skew" == "cont" {c -(}
    di "Group `i'"
    if "`i'" == "overall" su `v'
    if "`i'" != "overall" su `v' if `over' == `i'
    local mean = string(r(mean), "%12.`su_decimal'f")
    local sd = string(r(sd), "%12.`su_decimal'f")
    local su_`i' ("`mean' (`sd') `brackets_`i''")
    {c )-}
  - if "`type1'" == "bin" {c -(}
  = if "skew" == "bin" {c -(}
    if "`i'" == "overall" qui count if `v'==`positive'
    if "`i'" != "overall" qui count if `v'==`positive' & `over' == `i'
    scalar count_treat_positive_`i' = r(N)
    local n = count_treat_positive_`i'
    if "`count_only'" == ""{c -(}
    local percent = count_treat_positive_`i'/`N_`i''*100
    local per_str = string(`percent', "%12.`su_decimal'f")
    local per_str (`per_str'`per')
    {c )-}
    local su_`i' ("`n' `per_str' `brackets_`i''")
    {c )-}
  - if "`type1'" == "skew" {c -(}
  = if "skew" == "skew" {c -(}
  - di "Group `i'"
  = di "Group overall"
Group overall
  - if "`i'" == "overall" tabstat `v', stats(q) save
  = if "overall" == "overall" tabstat qol, stats(q) save
    {hline 84} begin tabstat {hline}
    - version 8, missing
    - syntax varlist(numeric) [if] [in] [aw fw] [ , BY(varname) CASEwise Columns(str) Format Format2(str) LAbelwidth(int -1) VArwidth(int -1) LOngstub Missing SAME SAVE noSEParator Statistics(str) STATS(str) noTotal ]
    - if "`casewise'" != "" {c -(}
    = if "" != "" {c -(}
      local same same
      {c )-}
    - if `"`stats'"' != "" {c -(}
    = if `"q"' != "" {c -(}
    - if `"`statistics'"' != "" {c -(}
    = if `""' != "" {c -(}
      di as err "may not specify both statistics() and stats() options"
      exit 198
      {c )-}
    - local statistics `"`stats'"'
    = local statistics `"q"'
    - local stats
    - {c )-}
    - if "`total'" != "" & "`by'" == "" {c -(}
    = if "" != "" & "" == "" {c -(}
      di as txt "nothing to display"
      exit 0
      {c )-}
    - if "`format'" != "" & `"`format2'"' != "" {c -(}
    = if "" != "" & `""' != "" {c -(}
      di as err "may not specify both format and format()"
      exit 198
      {c )-}
    - if `"`format2'"' != "" {c -(}
    = if `""' != "" {c -(}
      capt local tmp : display `format2' 1
      if _rc {c -(}
      di as err `"invalid %fmt in format(): `format2'"'
      exit 120
      {c )-}
      {c )-}
    - if `"`columns'"' == "" {c -(}
    = if `""' == "" {c -(}
    - local incol "variables"
    - {c )-}
    - else if `"`columns'"' == bsubstr("variables",1,length(`"`columns'"')) {c -(}
    = else if `""' == bsubstr("variables",1,length(`""')) {c -(}
      local incol "variables"
      {c )-}
    - else if `"`columns'"' == bsubstr("statistics",1,length(`"`columns'"')) {c -(}
    = else if `""' == bsubstr("statistics",1,length(`""')) {c -(}
      local incol "statistics"
      {c )-}
    - else if `"`columns'"' == "stats" {c -(}
    = else if `""' == "stats" {c -(}
      local incol "statistics"
      {c )-}
    - else {c -(}
      di as err `"column(`columns') invalid -- specify "' "column(variables) or column(statistics)"
      exit 198
      {c )-}
    - if "`longstub'" != "" | "`by'" == "" | `varwidth' != -1 {c -(}
    = if "" != "" | "" == "" | -1 != -1 {c -(}
    - local descr descr
    - {c )-}
    - if `varwidth' == -1 {c -(}
    = if -1 == -1 {c -(}
    - local varwidth 12
    - {c )-}
    - else if !inrange(`varwidth',8,c(namelen)) {c -(}
    = else if !inrange(12,8,c(namelen)) {c -(}
      local varwidth = clip(`varwidth',8,c(namelen))
      dis as txt "(option varwidth() outside valid range 8..`c(namelen)'; `varwidth' assumed)"
      {c )-}
    - if `labelwidth' == -1 {c -(}
    = if -1 == -1 {c -(}
    - local labelwidth 16
    - {c )-}
    - else if !inrange(`labelwidth',8,32) {c -(}
    = else if !inrange(16,8,32) {c -(}
      local labelwidth = clip(`labelwidth',8,32)
      dis as txt "(option labelwidth() outside valid range 8..32; `labelwidth' assumed)"
      {c )-}
    - marksample touse, novar
    - if "`same'" != "" {c -(}
    = if "" != "" {c -(}
      markout `touse' `varlist'
      {c )-}
    - if "`by'" != "" & "`missing'" == "" {c -(}
    = if "" != "" & "" == "" {c -(}
      markout `touse' `by' , strok
      {c )-}
    - qui count if `touse'
    = qui count if __000002
    - local ntouse = r(N)
    - if `ntouse' == 0 {c -(}
    = if 1000 == 0 {c -(}
      error 2000
      {c )-}
    - if `"`weight'"' != "" {c -(}
    = if `""' != "" {c -(}
      local wght `"[`weight'`exp']"'
      {c )-}
    - tokenize "`varlist'"
    = tokenize "qol"
    - local nvars : word count `varlist'
    = local nvars : word count qol
    - forvalues i = 1/`nvars' {c -(}
    = forvalues i = 1/1 {c -(}
    - local var`i' ``i''
    = local var1 qol
    - if "`format'" != "" {c -(}
    = if "" != "" {c -(}
      local fmt`i' : format ``i''
      {c )-}
    - else if `"`format2'"' != "" {c -(}
    = else if `""' != "" {c -(}
      local fmt`i' `format2'
      {c )-}
    - else {c -(}
    - local fmt`i' %9.0g
    = local fmt1 %9.0g
    - {c )-}
    - {c )-}
    - if `nvars' == 1 & `"`columns'"' == "" {c -(}
    = if 1 == 1 & `""' == "" {c -(}
    - local incol statistics
    - {c )-}
    - Stats `statistics'
    = Stats q
      {hline 76} begin tabstat.Stats {hline}
      - if `"`0'"' == "" {c -(}
      = if `"q"' == "" {c -(}
        local opt "mean"
        {c )-}
      - else {c -(}
      - local opt `"`0'"'
      = local opt `"q"'
      - {c )-}
      - local class 0
      - foreach st of local opt {c -(}
      - local 0 = lower(`", `st'"')
      = local 0 = lower(`", q"')
      - capt syntax [, n MEan sd Variance SUm COunt MIn MAx Range SKewness Kurtosis SDMean SEMean p1 p5 p10 p25 p50 p75 p90 p95 p99 iqr q MEDian CV ]
      - if _rc {c -(}
        di in err `"unknown statistic: `st'"'
        exit 198
        {c )-}
      - if "`median'" != "" {c -(}
      = if "" != "" {c -(}
        local p50 p50
        {c )-}
      - if "`count'" != "" {c -(}
      = if "" != "" {c -(}
        local n n
        {c )-}
      - if "`n'" != "" {c -(}
      = if "" != "" {c -(}
        local n N
        {c )-}
      - local s "`n'`min'`mean'`max'`sum'"
      = local s ""
      - if "`s'" != "" {c -(}
      = if "" != "" {c -(}
        local names "`names' `s'"
        local expr "`expr' r(`s')"
        local class = max(`class',1)
        {c )-}
      - if "`range'" != "" {c -(}
      = if "" != "" {c -(}
        local names "`names' range"
        local expr "`expr' r(max)-r(min)"
        local class = max(`class',1)
        {c )-}
      - if "`sd'" != "" {c -(}
      = if "" != "" {c -(}
        local names "`names' sd"
        local expr "`expr' r(sd)"
        local class = max(`class',2)
        {c )-}
      - if "`sdmean'" != "" | "`semean'"!="" {c -(}
      = if "" != "" | ""!="" {c -(}
        local names "`names' se(mean)"
        local expr "`expr' r(sd)/sqrt(r(N))"
        local class = max(`class',2)
        {c )-}
      - if "`variance'" != "" {c -(}
      = if "" != "" {c -(}
        local names "`names' variance"
        local expr "`expr' r(Var)"
        local class = max(`class',2)
        {c )-}
      - if "`cv'" != "" {c -(}
      = if "" != "" {c -(}
        local names "`names' cv"
        local expr "`expr' (r(sd)/r(mean))"
        local class = max(`class',2)
        {c )-}
      - local s "`skewness'`kurtosis'`p1'`p5'`p10'`p25'`p50'`p75'`p90'`p95'`p99'"
      = local s ""
      - if "`s'" != "" {c -(}
      = if "" != "" {c -(}
        local names "`names' `s'"
        local expr "`expr' r(`s')"
        local class = max(`class',3)
        {c )-}
      - if "`iqr'" != "" {c -(}
      = if "" != "" {c -(}
        local names "`names' iqr"
        local expr "`expr' r(p75)-r(p25)"
        local class = max(`class',3)
        {c )-}
      - if "`q'" != "" {c -(}
      = if "q" != "" {c -(}
      - local names "`names' p25 p50 p75"
      = local names " p25 p50 p75"
      - local expr "`expr' r(p25) r(p50) r(p75)"
      = local expr " r(p25) r(p50) r(p75)"
      - local class = max(`class',3)
      = local class = max(0,3)
      - {c )-}
      - {c )-}
      - return local names `names'
      = return local names  p25 p50 p75
      - return local expr `expr'
      = return local expr  r(p25) r(p50) r(p75)
      - if `class' == 1 {c -(}
      = if 3 == 1 {c -(}
        return local summopt "meanonly"
        {c )-}
      - else if `class' == 3 {c -(}
      = else if 3 == 3 {c -(}
      - return local summopt "detail"
      - {c )-}
      {hline 78} end tabstat.Stats {hline}
    - local stats `r(names)'
    = local stats p25 p50 p75
    - local expr `r(expr)'
    = local expr r(p25) r(p50) r(p75)
    - local summopt `r(summopt)'
    = local summopt detail
    - local nstats : word count `stats'
    = local nstats : word count p25 p50 p75
    - tokenize `expr'
    = tokenize r(p25) r(p50) r(p75)
    - forvalues i = 1/`nstats' {c -(}
    = forvalues i = 1/3 {c -(}
    - local expr`i' ``i''
    = local expr1 r(p25)
    - {c )-}
    - local expr`i' ``i''
    = local expr2 r(p50)
    - {c )-}
    - local expr`i' ``i''
    = local expr3 r(p75)
    - {c )-}
    - tokenize `stats'
    = tokenize p25 p50 p75
    - forvalues i = 1/`nstats' {c -(}
    = forvalues i = 1/3 {c -(}
    - local name`i' ``i''
    = local name1 p25
    - local names "`names' ``i''"
    = local names " p25"
    - if `i' < `nstats' {c -(}
    = if 1 < 3 {c -(}
    - local names "`names',"
    = local names " p25,"
    - {c )-}
    - {c )-}
    - local name`i' ``i''
    = local name2 p50
    - local names "`names' ``i''"
    = local names " p25, p50"
    - if `i' < `nstats' {c -(}
    = if 2 < 3 {c -(}
    - local names "`names',"
    = local names " p25, p50,"
    - {c )-}
    - {c )-}
    - local name`i' ``i''
    = local name3 p75
    - local names "`names' ``i''"
    = local names " p25, p50, p75"
    - if `i' < `nstats' {c -(}
    = if 3 < 3 {c -(}
      local names "`names',"
      {c )-}
    - {c )-}
    - if "`separator'" == "" & ( (`nstats' > 1 & "`incol'" == "variables") |(`nvars' > 1 & "`incol'" == "statistics")) {c -(}
    = if "" == "" & ( (3 > 1 & "statistics" == "variables") |(1 > 1 & "statistics" == "statistics")) {c -(}
      local sepline yes
      {c )-}
    - local matsize : set matsize
    - local matreq = max(`nstats',`nvars')
    = local matreq = max(3,1)
    - if `matsize' < `matreq' {c -(}
    = if 400 < 3 {c -(}
      di as err "set matsize to at least `matreq' (see help matsize for details)"
      exit 908
      {c )-}
    - if "`by'" != "" {c -(}
    = if "" != "" {c -(}
      qui replace `touse' = - `touse'
      sort `touse' `by'
      local bytype : type `by'
      local by2 0
      local iby 1
      while `by2' < `ntouse' {c -(}
      tempname Stat`iby'
      mat `Stat`iby'' = J(`nstats',`nvars',0)
      mat colnames `Stat`iby'' = `varlist'
      mat rownames `Stat`iby'' = `stats'
      local by1 = `by2' + 1
      qui count if (`by'==`by'[`by1']) & (`touse')
      local by2 = `by1' + r(N) - 1
      forvalues i = 1/`nvars' {c -(}
      qui summ `var`i'' in `by1'/`by2' `wght', `summopt'
      forvalues is = 1/`nstats' {c -(}
      mat `Stat`iby''[`is',`i'] = `expr`is''
      {c )-}
      {c )-}
      if bsubstr("`bytype'",1,3) != "str" {c -(}
      local iby1 = `by'[`by1']
      local lab`iby' : label (`by') `iby1'
      {c )-}
      else {c -(}
      local lab`iby' : di (ubsubstr(`by'[`by1'], 1, c(maxvlabellen)))
      {c )-}
      local iby = `iby' + 1
      {c )-}
      local nby = `iby' - 1
      {c )-}
    - else {c -(}
    - local nby 0
    - {c )-}
    - if "`total'" == "" {c -(}
    = if "" == "" {c -(}
    - local iby = `nby'+1
    = local iby = 0+1
    - tempname Stat`iby'
    = tempname Stat1
    - mat `Stat`iby'' = J(`nstats',`nvars',0)
    = mat __000003 = J(3,1,0)
    - mat colnames `Stat`iby'' = `varlist'
    = mat colnames __000003 = qol
    - mat rownames `Stat`iby'' = `stats'
    = mat rownames __000003 = p25 p50 p75
    - forvalues i = 1/`nvars' {c -(}
    = forvalues i = 1/1 {c -(}
    - qui summ `var`i'' if `touse' `wght' , `summopt'
    = qui summ qol if __000002  , detail
    - forvalues is = 1/`nstats' {c -(}
    = forvalues is = 1/3 {c -(}
    - mat `Stat`iby''[`is',`i'] = `expr`is''
    = mat __000003[1,1] = r(p25)
    - {c )-}
    - mat `Stat`iby''[`is',`i'] = `expr`is''
    = mat __000003[2,1] = r(p50)
    - {c )-}
    - mat `Stat`iby''[`is',`i'] = `expr`is''
    = mat __000003[3,1] = r(p75)
    - {c )-}
    - {c )-}
    - local lab`iby' "Total"
    = local lab1 "Total"
    - {c )-}
    - if "`by'" != "" {c -(}
    = if "" != "" {c -(}
      if bsubstr("`bytype'",1,3) != "str" {c -(}
      local lv : value label `by'
      if "`lv'" != "" {c -(}
      local lg : label (`by') maxlength
      local byw = min(`labelwidth',`lg')
      {c )-}
      else {c -(}
      local byw 8
      {c )-}
      {c )-}
      else {c -(}
      local byw=min(real(bsubstr("`bytype'",4,.)),`labelwidth')
      local bytype str
      {c )-}
      capture local for : format `by'
      capture local if_date_for = bsubstr("`for'", index("`for'", "%"), index("`for'", "d"))
      capture local if_time_for = bsubstr("`for'", index("`for'", "%"), index("`for'", "t"))
      if "`if_date_for'" == "%d" | "`if_time_for'" == "%t" {c -(}
      if "`if_date_for'" == "%d" {c -(}
      local has_M = index("`for'", "M")
      local has_L = index("`for'", "L")
      if `has_M' > 0 | `has_L' > 0 {c -(}
      local byw = 18
      {c )-}
      else {c -(}
      local byw = 11
      {c )-}
      {c )-}
      else {c -(}
      local byw = 9
      {c )-}
      {c )-}
      else {c -(}
      local byw = max(udstrlen("`by'"), `byw')
      {c )-}
      if "`total'" == "" {c -(}
      local byw = max(`byw', 6)
      {c )-}
      {c )-}
    - else {c -(}
    - local byw 8
    - {c )-}
    - local ndigit 9
    - local colwidth = `ndigit'+1
    = local colwidth = 9+1
    - if "`incol'" == "statistics" {c -(}
    = if "statistics" == "statistics" {c -(}
    - local lleft = (1 + `byw')*("`by'"!="") + (`varwidth'+1)*("`descr'"!="")
    = local lleft = (1 + 8)*(""!="") + (12+1)*("descr"!="")
    - {c )-}
    - else {c -(}
      local lleft = (1 + `byw')*("`by'"!="") + (8+1)*("`descr'"!="")
      {c )-}
    - local cbar = `lleft' + 1
    = local cbar = 13 + 1
    - local lsize = c(linesize)
    - local neblock = int((`lsize' - `cbar')/10)
    = local neblock = int((106 - 14)/10)
    - local nsblock = 1 + int((`nstats'-1)/`neblock')
    = local nsblock = 1 + int((3-1)/9)
    - local nvblock = 1 + int((`nvars'-1)/`neblock')
    = local nvblock = 1 + int((1-1)/9)
    - if "`descr'" != "" & "`by'" != "" {c -(}
    = if "descr" != "" & "" != "" {c -(}
      local byalign lalign
      {c )-}
    - else {c -(}
    - local byalign ralign
    - {c )-}
    - if "`incol'" == "statistics" {c -(}
    = if "statistics" == "statistics" {c -(}
    - if "`descr'" == "" {c -(}
    = if "descr" == "" {c -(}
      di as txt _n `"Summary for variables: `varlist'"'
      if "`by'" != "" {c -(}
      local bylabel : var label `by'
      if `"`bylabel'"' != "" {c -(}
      local bylabel `"(`bylabel')"'
      {c )-}
      di as txt _col(6) `"by categories of: `by' `bylabel'"'
      {c )-}
      {c )-}
    - di

    - local is2 0
    - forvalues isblock = 1/`nsblock' {c -(}
    = forvalues isblock = 1/1 {c -(}
    - local is1 = `is2' + 1
    = local is1 = 0 + 1
    - local is2 = min(`nstats', `is1'+`neblock'-1)
    = local is2 = min(3, 1+9-1)
    - if "`by'" != "" {c -(}
    = if "" != "" {c -(}
      local byname = abbrev("`by'",`byw')
      di as txt "{c -(}`byalign' `byw':`byname'{c )-} {c -(}...{c )-}"
      {c )-}
    - if "`descr'" != "" {c -(}
    = if "descr" != "" {c -(}
    - di as txt "{c -(}ralign `varwidth':variable{c )-} {c -(}...{c )-}"
    = di as txt "{c -(}ralign 12:variable{c )-} {c -(}...{c )-}"
{ralign 12:variable} {...}
    - {c )-}
    - di as txt "{c -(}c |{c )-}" _c
{c |}    - forvalues is = `is1'/`is2' {c -(}
    = forvalues is = 1/3 {c -(}
    - di as txt %`colwidth's "`name`is''" _c
    = di as txt %10s "p25" _c
       p25    - {c )-}
    - di as txt %`colwidth's "`name`is''" _c
    = di as txt %10s "p50" _c
       p50    - {c )-}
    - di as txt %`colwidth's "`name`is''" _c
    = di as txt %10s "p75" _c
       p75    - {c )-}
    - local ndash = `colwidth'*(`is2'-`is1'+1)
    = local ndash = 10*(3-1+1)
    - di as txt _n "{c -(}hline `lleft'{c )-}{c -(}c +{c )-}{c -(}hline `ndash'{c )-}"
    = di as txt _n "{c -(}hline 13{c )-}{c -(}c +{c )-}{c -(}hline 30{c )-}"

{hline 13}{c +}{hline 30}
    - local nbyt = `nby' + ("`total'" == "")
    = local nbyt = 0 + ("" == "")
    - forvalues iby = 1/`nbyt'{c -(}
    = forvalues iby = 1/1{c -(}
    - forvalues i = 1/`nvars' {c -(}
    = forvalues i = 1/1 {c -(}
    - if "`by'" != "" {c -(}
    = if "" != "" {c -(}
      if `i' == 1 {c -(}
      local lab = udsubstr(`"`lab`iby''"', 1,`byw')
      if `"`lab'"' != "Total" {c -(}
      capture local val_lab : value label `by'
      if "`val_lab'" == "" {c -(}
      local type : type `by'
      local yes_str = index("`type'", "str")
      if `yes_str' == 0 {c -(}
      capture local for : format `by'
      capture local if_date_for = index("`for'", "%d")
      capture local if_time_for = index("`for'", "%t")
      if `if_date_for' > 0 | `if_time_for' > 0 {c -(}
      local date_for : display `for' `lab'
      di in txt `"{c -(}`byalign' `byw':`date_for'{c )-} {c -(}...{c )-}"'
      {c )-}
      else {c -(}
      di in txt `"{c -(}`byalign' `byw':`lab'{c )-} {c -(}...{c )-}"'
      {c )-}
      {c )-}
      else {c -(}
      di in txt `"{c -(}`byalign' `byw':`lab'{c )-} {c -(}...{c )-}"'
      {c )-}
      {c )-}
      else {c -(}
      di in txt `"{c -(}`byalign' `byw':`lab'{c )-} {c -(}...{c )-}"'
      {c )-}
      {c )-}
      else {c -(}
      di in txt `"{c -(}`byalign' `byw':`lab'{c )-} {c -(}...{c )-}"'
      {c )-}
      {c )-}
      else {c -(}
      di "{c -(}space `byw'{c )-} {c -(}...{c )-}"
      {c )-}
      {c )-}
    - if "`descr'" != "" {c -(}
    = if "descr" != "" {c -(}
    - local avn = abbrev("`var`i''",`varwidth')
    = local avn = abbrev("qol",12)
    - di as txt "{c -(}ralign `varwidth':`avn'{c )-} {c -(}...{c )-}"
    = di as txt "{c -(}ralign 12:qol{c )-} {c -(}...{c )-}"
{ralign 12:qol} {...}
    - {c )-}
    - di as txt "{c -(}c |{c )-}{c -(}...{c )-}"
{c |}{...}
    - forvalues is = `is1'/`is2' {c -(}
    = forvalues is = 1/3 {c -(}
    - local s : display `fmt`i'' `Stat`iby''[`is',`i']
    = local s : display %9.0g __000003[1,1]
    - di as res %`colwidth's "`s'" _c
    = di as res %10s " 39.80885" _c
 {res} 39.80885    {txt}- {c )-}
    - local s : display `fmt`i'' `Stat`iby''[`is',`i']
    = local s : display %9.0g __000003[2,1]
    - di as res %`colwidth's "`s'" _c
    = di as res %10s " 50.07267" _c
 {res} 50.07267    {txt}- {c )-}
    - local s : display `fmt`i'' `Stat`iby''[`is',`i']
    = local s : display %9.0g __000003[3,1]
    - di as res %`colwidth's "`s'" _c
    = di as res %10s " 60.41745" _c
 {res} 60.41745    {txt}- {c )-}
    - di

    - {c )-}
    - if (`iby' >= `nbyt') {c -(}
    = if (1 >= 1) {c -(}
    - di as txt "{c -(}hline `lleft'{c )-}{c -(}c BT{c )-}{c -(}hline `ndash'{c )-}"
    = di as txt "{c -(}hline 13{c )-}{c -(}c BT{c )-}{c -(}hline 30{c )-}"
{hline 13}{c BT}{hline 30}
    - {c )-}
    - else if ("`sepline'" != "") | ((`iby'+1 == `nbyt') & ("`total'" == "")) {c -(}
    = else if ("" != "") | ((1+1 == 1) & ("" == "")) {c -(}
      di as txt "{c -(}hline `lleft'{c )-}{c -(}c +{c )-}{c -(}hline `ndash'{c )-}"
      {c )-}
    - {c )-}
    - if `isblock' < `nsblock' {c -(}
    = if 1 < 1 {c -(}
      display
      {c )-}
    - {c )-}
    - {c )-}
    - else {c -(}
      if "`descr'" == "" {c -(}
      di as txt _n `"Summary statistics:`names'"'
      if "`by'" != "" {c -(}
      local bylabel : var label `by'
      if `"`bylabel'"' != "" {c -(}
      local bylabel `"(`bylabel')"'
      {c )-}
      di as txt `"  by categories of: `by' `bylabel'"'
      {c )-}
      {c )-}
      di
      local i2 0
      forvalues iblock = 1/`nvblock' {c -(}
      local i1 = `i2' + 1
      local i2 = min(`nvars', `i1'+`neblock'-1)
      if "`by'" != "" {c -(}
      di as txt "{c -(}`byalign' `byw':`by'{c )-} {c -(}...{c )-}"
      {c )-}
      if "`descr'" != "" {c -(}
      di as txt "   stats {c -(}...{c )-}"
      {c )-}
      di as txt "{c -(}c |{c )-}{c -(}...{c )-}"
      forvalues i = `i1'/`i2' {c -(}
      di as txt %`colwidth's abbrev("`var`i''",8) _c
      {c )-}
      local ndash = (`ndigit'+1)*(`i2'-`i1'+1)
      di as txt _n "{c -(}hline `lleft'{c )-}{c -(}c +{c )-}{c -(}hline `ndash'{c )-}"
      local nbyt = `nby' + ("`total'" == "")
      forvalues iby = 1/`nbyt'{c -(}
      forvalues is = 1/`nstats' {c -(}
      if "`by'" != "" {c -(}
      if `is' == 1 {c -(}
      local lab = udsubstr(`"`lab`iby''"', 1, `byw')
      di as txt `"{c -(}`byalign' `byw':`lab'{c )-} {c -(}...{c )-}"'
      {c )-}
      else {c -(}
      di as txt "{c -(}space `byw'{c )-} {c -(}...{c )-}"
      {c )-}
      {c )-}
      if "`descr'" != "" {c -(}
      di as txt `"{c -(}ralign 8:`name`is''{c )-} {c -(}...{c )-}"'
      {c )-}
      di as txt "{c -(}c |{c )-}{c -(}...{c )-}"
      forvalues i = `i1'/`i2' {c -(}
      local s : display `fmt`i'' `Stat`iby''[`is',`i']
      di as res %`colwidth's "`s'" _c
      {c )-}
      di
      {c )-}
      if (`iby' >= `nbyt') {c -(}
      di as txt "{c -(}hline `lleft'{c )-}{c -(}c BT{c )-}{c -(}hline `ndash'{c )-}"
      {c )-}
      else if ("`sepline'" != "") | ((`iby'+1 == `nbyt') & ("`total'" == "")) {c -(}
      di as txt "{c -(}hline `lleft'{c )-}{c -(}c +{c )-}{c -(}hline `ndash'{c )-}"
      {c )-}
      {c )-}
      if `iblock' < `nvblock' {c -(}
      display
      {c )-}
      {c )-}
      {c )-}
    - if "`save'" != "" {c -(}
    = if "save" != "" {c -(}
    - if "`total'" == "" {c -(}
    = if "" == "" {c -(}
    - local iby = `nby'+1
    = local iby = 0+1
    - if _caller() < 9 {c -(}
      return matrix StatTot `Stat`iby''
      {c )-}
    - else {c -(}
    - return matrix StatTotal `Stat`iby''
    = return matrix StatTotal __000003
    - {c )-}
    - {c )-}
    - if "`by'" == "" {c -(}
    = if "" == "" {c -(}
    - exit
    {hline 86} end tabstat {hline}
  - if "`i'" != "overall" tabstat `v' if `over' == `i', stats(q) save
  = if "overall" != "overall" tabstat qol if treat == overall, stats(q) save
  - mat define A = r(StatTotal)
  - local median = string(A[2,1], "%12.`su_decimal'f")
  = local median = string(A[2,1], "%12.1f")
  - local q1 = string(A[1,1], "%12.`su_decimal'f")
  = local q1 = string(A[1,1], "%12.1f")
  - local q3 = string(A[3,1], "%12.`su_decimal'f")
  = local q3 = string(A[3,1], "%12.1f")
  - local su_`i' ("`median' (`q1'-`q3') `brackets_`i''")
  = local su_overall ("50.1 (39.8-60.4) ")
  - {c )-}
  - {c )-}
  - if "`type1'" == "bin" {c -(}
  = if "skew" == "bin" {c -(}
    if "`miss_opt'" == "" {c -(}
    if "`over'" != "" tab `v' `over', col
    if "`over'" == "" tab `v'
    {c )-}
    {c )-}
  - if "`order'" == "group_sum" {c -(}
  = if "group_treat" == "group_sum" {c -(}
    local summaries ""
    foreach i in `over_grps' {c -(}
    local summaries `summaries' `su_`i''
    {c )-}
    if "`sum_cols_first'" == "" {c -(}
    post `postname' `var_label' `measure_post' `ccol' `inan_cols' `miss_cols' `summaries' `comment'
    {c )-}
    else {c -(}
    post `postname' `var_label' `measure_post' `ccol' `summaries' `inan_cols' `miss_cols' `comment'
    {c )-}
    {c )-}
  - if "`order'" == "group_treat" {c -(}
  = if "group_treat" == "group_treat" {c -(}
  - local summaries ""
  - foreach i in `over_grps' {c -(}
  = foreach i in 1 0 overall {c -(}
  - if "`n_analysis'" == "cols" local treat_cols`i' ("`inanalysis_`i''")
  = if "cols" == "cols" local treat_cols1 ("461 (91.1%)")
  - if "`missing'" == "cols" local treat_cols`i' ("`missing_`i''")
  = if "" == "cols" local treat_cols1 ("45")
  - local treat_cols`i' `treat_cols`i'' `su_`i''
  = local treat_cols1 ("461 (91.1%)") ("50.8 (40.6-60.7) ")
  - local summaries `summaries' `treat_cols`i''
  = local summaries  ("461 (91.1%)") ("50.8 (40.6-60.7) ")
  - {c )-}
  - if "`n_analysis'" == "cols" local treat_cols`i' ("`inanalysis_`i''")
  = if "cols" == "cols" local treat_cols0 ("444 (89.9%)")
  - if "`missing'" == "cols" local treat_cols`i' ("`missing_`i''")
  = if "" == "cols" local treat_cols0 ("50")
  - local treat_cols`i' `treat_cols`i'' `su_`i''
  = local treat_cols0 ("444 (89.9%)") ("49.6 (39.0-59.2) ")
  - local summaries `summaries' `treat_cols`i''
  = local summaries ("461 (91.1%)") ("50.8 (40.6-60.7) ") ("444 (89.9%)") ("49.6 (39.0-59.2) ")
  - {c )-}
  - if "`n_analysis'" == "cols" local treat_cols`i' ("`inanalysis_`i''")
  = if "cols" == "cols" local treat_colsoverall ("905 (90.5%)")
  - if "`missing'" == "cols" local treat_cols`i' ("`missing_`i''")
  = if "" == "cols" local treat_colsoverall ("95")
  - local treat_cols`i' `treat_cols`i'' `su_`i''
  = local treat_colsoverall ("905 (90.5%)") ("50.1 (39.8-60.4) ")
  - local summaries `summaries' `treat_cols`i''
  = local summaries ("461 (91.1%)") ("50.8 (40.6-60.7) ") ("444 (89.9%)") ("49.6 (39.0-59.2) ") ("905 (90.5%)") ("50.1 (39.8-60.4) ")
  - {c )-}
  - post `postname' `var_label' `measure_post' `ccol' `summaries' `comment'
  = post __000000 ("Quality of life - median (IQR) ")   ("461 (91.1%)") ("50.8 (40.6-60.7) ") ("444 (89.9%)") ("49.6 (39.0-59.2) ") ("905 (90.5%)") ("50.1 (39.8-60.4) ") 
  - {c )-}
  - {c )-}
  - local measure_post
  - if "`su_label'" == "col" local measure_post ("")
  = if "append" == "col" local measure_post ("")
  - if "`cat_col'" != "" local ccol ("")
  = if "" != "" local ccol ("")
  - local summaries ""
  - local miss_cols ""
  - local inan_cols ""
  - foreach i in `over_grps' {c -(}
  = foreach i in 1 0 overall {c -(}
  - local summaries `summaries' ("")
  = local summaries  ("")
  - if "`missing'" == "cols" local miss_cols `miss_cols' ("")
  = if "" == "cols" local miss_cols  ("")
  - if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("")
  = if "cols" == "cols" local inan_cols  ("")
  - {c )-}
  - local summaries `summaries' ("")
  = local summaries ("") ("")
  - if "`missing'" == "cols" local miss_cols `miss_cols' ("")
  = if "" == "cols" local miss_cols  ("")
  - if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("")
  = if "cols" == "cols" local inan_cols ("") ("")
  - {c )-}
  - local summaries `summaries' ("")
  = local summaries ("") ("") ("")
  - if "`missing'" == "cols" local miss_cols `miss_cols' ("")
  = if "" == "cols" local miss_cols  ("")
  - if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("")
  = if "cols" == "cols" local inan_cols ("") ("") ("")
  - {c )-}
  - if "`comment'" != "" local comment ("")
  = if "" != "" local comment ("")
  - if `gap' > 0 {c -(}
  = if 1 > 0 {c -(}
  - forvalues i = 1 (1) `gap' {c -(}
  = forvalues i = 1 (1) 1 {c -(}
  - post `postname' ("") `measure_post' `ccol' `inan_cols' `miss_cols' `summaries' `comment'
  = post __000000 ("")   ("") ("") ("")  ("") ("") ("") 
  - {c )-}
  - {c )-}
  - {c )-}
  - if `gap_end' > 0 {c -(}
  = if 0 > 0 {c -(}
    forvalues i = 1 (1) `gap_end' {c -(}
    post `postname' ("") `measure_post' `ccol' `inan_cols' `miss_cols' `summaries' `comment'
    {c )-}
    {c )-}
  - if "`if'" != "" restore
  = if "" != "" restore
  {hline 88} end pt_base {hline}

{com}. pt_base  gender  , post(`postname') over(treat)  overall(last)  over_grps(1, 0) type(bin)  su_label(append)   gap(1) n_analysis(cols %)  order(group_treat) per
{txt}  {hline 86} begin pt_base {hline}
  - syntax varlist(numeric) [if], POSTname(string) [ Type(string) count_only over(varname) over_grps(numlist) overall(string) cat_levels(numlist) cat_col cat_tabs(integer 1) gap(integer 0) gap_end(integer 0) decimal(integer 1) miss_decimal(integer 1) su_decimal(integer 1) positive(integer 1) Missing(string) N_analysis(string) order(string) sum_cols_first su_label(string) su_label_text(string) append_label(string) var_lab(string) per comment(string) ]
  - if "`if'" != "" {c -(}
  = if "" != "" {c -(}
    preserve
    keep `if'
    {c )-}
  - if `su_decimal' ==1 local su_decimal = `decimal'
  = if 1 ==1 local su_decimal = 1
  - if `miss_decimal' ==1 local miss_decimal = `decimal'
  = if 1 ==1 local miss_decimal = 1
  - if "`over'" != "" {c -(}
  = if "treat" != "" {c -(}
  - if "`over_grps'" == "" levelsof `over', local(over_grps)
  = if "1 0" == "" levelsof treat, local(over_grps)
  - if "`overall'" == "first" local over_grps overall `over_grps'
  = if "last" == "first" local over_grps overall 1 0
  - if "`overall'" == "last" local over_grps `over_grps' overall
  = if "last" == "last" local over_grps 1 0 overall
  - {c )-}
  - if "`over'" == "" local over_grps overall
  = if "treat" == "" local over_grps overall
  - if "`order'" == "" local order group_sum
  = if "group_treat" == "" local order group_sum
  - if "`per'" != "" local per %
  = if "per" != "" local per %
  - if "`comment'" != "" & "`comment'" != "no comment" local comment ("`comment'")
  = if "" != "" & "" != "no comment" local comment ("")
  - if "`comment'" == "no comment" local comment ("")
  = if "" == "no comment" local comment ("")
  - if "`type'" == "misstable" {c -(}
  = if "bin" == "misstable" {c -(}
    local type bin
    local positive .
    local miss_opt missing
    {c )-}
  - foreach w in `missing' {c -(}
  = foreach w in  {c -(}
    if "`w'" == "brackets" local missing brackets
    if "`w'" == "cols" local missing cols
    if "`w'" == "%" local miss_per miss_per
    if "`w'" == "cond" local cond cond
    {c )-}
  - foreach w in `n_analysis' {c -(}
  = foreach w in cols % {c -(}
  - if "`w'" == "brackets" local n_analysis brackets
  = if "cols" == "brackets" local n_analysis brackets
  - if "`w'" == "append" local n_analysis append
  = if "cols" == "append" local n_analysis append
  - if "`w'" == "cols" local n_analysis cols
  = if "cols" == "cols" local n_analysis cols
  - if "`w'" == "%" local n_analysis_per n_analysis_per
  = if "cols" == "%" local n_analysis_per n_analysis_per
  - if "`w'" == "cond" local cond cond
  = if "cols" == "cond" local cond cond
  - {c )-}
  - if "`w'" == "brackets" local n_analysis brackets
  = if "%" == "brackets" local n_analysis brackets
  - if "`w'" == "append" local n_analysis append
  = if "%" == "append" local n_analysis append
  - if "`w'" == "cols" local n_analysis cols
  = if "%" == "cols" local n_analysis cols
  - if "`w'" == "%" local n_analysis_per n_analysis_per
  = if "%" == "%" local n_analysis_per n_analysis_per
  - if "`w'" == "cond" local cond cond
  = if "%" == "cond" local cond cond
  - {c )-}
  - forvalues t = 1 (1) `cat_tabs' {c -(}
  = forvalues t = 1 (1) 1 {c -(}
  - local tab1 = "`tab1'    "
  = local tab1 = "    "
  - {c )-}
  - foreach v in `varlist' {c -(}
  = foreach v in gender {c -(}
  - di as result _newline(3) "****** `v' ******" _newline(1)
  = di as result _newline(3) "****** gender ******" _newline(1)



{res}****** gender ******

  {txt}- display as text %26s "Group {c -(}c |{c )-}" as text %19s "N obs. Percent" %24s "N missing Percent"
               Group {c |}     N obs. Percent       N missing Percent
  - di as text "{c -(}hline 21{c )-}{c -(}c +{c )-}{c -(}hline 43{c )-}"
{hline 21}{c +}{hline 43}
  - local type1 = "`type'"
  = local type1 = "bin"
  - if "`type1'" == "" {c -(}
  = if "bin" == "" {c -(}
    qui inspect `v'
    if r(N_unique) < 3 {c -(}
    local type1 = "bin"
    {c )-}
    else if r(N_unique) < 10 {c -(}
    local type1 = "cat"
    {c )-}
    else if r(N_unique) >= 10 | r(N_unique) ==. {c -(}
    local type1 = "cont"
    {c )-}
    {c )-}
  - qui count if missing(`v')
  = qui count if missing(gender)
  - local miss_overall = r(N)
  - local var_label `var_lab'
  = local var_label 
  - if "`var_lab'" == "" local var_label:variable label `v'
  = if "" == "" local var_label:variable label gender
  - if "`var_label'" == "" local var_label = "`v'"
  = if "Female" == "" local var_label = "gender"
  - local var_label `var_label' `append_label'
  = local var_label Female 
  - if "`type1'" == "cont" local measure1 "mean (sd)"
  = if "bin" == "cont" local measure1 "mean (sd)"
  - if "`type1'" == "bin" | "`type1'" == "cat" {c -(}
  = if "bin" == "bin" | "bin" == "cat" {c -(}
  - local measure1 "n (%)"
  - if "`count_only'" != "" local measure1 "n"
  = if "" != "" local measure1 "n"
  - {c )-}
  - if "`type1'" == "skew" local measure1 "median (IQR)"
  = if "bin" == "skew" local measure1 "median (IQR)"
  - if "`missing'" == "brackets" local measure1 "`measure1' [missing]"
  = if "" == "brackets" local measure1 "n (%) [missing]"
  - if "`n_analysis'" == "brackets" local measure1 "`measure1' [n included in analysis]"
  = if "cols" == "brackets" local measure1 "n (%) [n included in analysis]"
  - if "`su_label_text'" != "" local measure1 `su_label_text'
  = if "" != "" local measure1 
  - if "`su_label'" == "append" local measure_append =" - `measure1'"
  = if "append" == "append" local measure_append =" - n (%)"
  - local N_append ""
  - if "`n_analysis'" == "append" & ("`cond'" =="" | `miss_overall' > 0) {c -(}
  = if "cols" == "append" & ("" =="" | 0 > 0) {c -(}
    qui count if missing(`v') ==0
    local N = r(N)
    local N_append (N = `N')
    {c )-}
  - local var_label ("`var_label'`measure_append' `N_append'")
  = local var_label ("Female - n (%) ")
  - local measure_post
  - if "`su_label'" == "col" local measure_post ("`measure1'")
  = if "append" == "col" local measure_post ("n (%)")
  - local miss_cols ""
  - local inan_cols ""
  - foreach i in `over_grps' {c -(}
  = foreach i in 1 0 overall {c -(}
  - if "`i'" == "overall" {c -(}
  = if "1" == "overall" {c -(}
    qui count
    local N_data = r(N)
    qui count if !missing(`v')
    local N_`i' = r(N)
    qui count if missing(`v')
    local n_missing_`i' = r(N)
    {c )-}
  - else {c -(}
  - qui count if `over' == `i'
  = qui count if treat == 1
  - local N_data = r(N)
  - qui count if `over' == `i' & !missing(`v')
  = qui count if treat == 1 & !missing(gender)
  - local N_`i' = r(N)
  = local N_1 = r(N)
  - qui count if missing(`v') & `over'==`i'
  = qui count if missing(gender) & treat==1
  - local n_missing_`i' = r(N)
  = local n_missing_1 = r(N)
  - {c )-}
  - local n_inanalysis_per_`i' = `N_`i''/`N_data' *100
  = local n_inanalysis_per_1 = 506/506 *100
  - local in_per_`i' = string(`n_inanalysis_per_`i'', "%12.`miss_decimal'f")
  = local in_per_1 = string(100, "%12.1f")
  - local inanalysis_`i' = `N_`i''
  = local inanalysis_1 = 506
  - if "`n_analysis_per'" != "" local inanalysis_`i' `N_`i'' (`in_per_`i''`per')
  = if "n_analysis_per" != "" local inanalysis_1 506 (100.0%)
  - local n_missing_per_`i' = `n_missing_`i''/`N_data'*100
  = local n_missing_per_1 = 0/506*100
  - local miss_per_`i' = string(`n_missing_per_`i'', "%12.`miss_decimal'f")
  = local miss_per_1 = string(0, "%12.1f")
  - local missing_`i' = `n_missing_`i''
  = local missing_1 = 0
  - if "`miss_per'" != "" local missing_`i' `n_missing_`i'' (`miss_per_`i''`per')
  = if "" != "" local missing_1 0 (0.0%)
  - display as text %20s abbrev("`i'",20) " {c -(}c |{c )-}" as result %9.0g `N_`i'' " " %9.0g `n_inanalysis_per_`i'' %14.0g `n_missing_`i'' " " %9.0g `n_missing_per_`i''
  = display as text %20s abbrev("1",20) " {c -(}c |{c )-}" as result %9.0g 506 " " %9.0g 100 %14.0g 0 " " %9.0g 0
                   1 {c |}{res}      506       100             0         0
  {txt}- local brackets_`i' ""
  = local brackets_1 ""
  - if "`cond'" == "" | ("`cond'" == "cond" & `miss_overall' != 0) {c -(}
  = if "" == "" | ("" == "cond" & 0 != 0) {c -(}
  - if "`missing'" == "cols" local miss_cols `miss_cols' ("`missing_`i''")
  = if "" == "cols" local miss_cols  ("0")
  - if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("`inanalysis_`i''")
  = if "cols" == "cols" local inan_cols  ("506 (100.0%)")
  - local brackets_`i'
  = local brackets_1
  - if "`missing'" == "brackets" local brackets_`i' "[`missing_`i'']"
  = if "" == "brackets" local brackets_1 "[0]"
  - if "`n_analysis'" == "brackets" local brackets_`i' "[`inanalysis_`i'']"
  = if "cols" == "brackets" local brackets_1 "[506 (100.0%)]"
  - {c )-}
  - if "`cond'" == "cond" & `miss_overall' == 0 {c -(}
  = if "" == "cond" & 0 == 0 {c -(}
    if "`missing'" == "cols" local miss_cols `miss_cols' ("")
    if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("")
    {c )-}
  - {c )-}
  - if "`i'" == "overall" {c -(}
  = if "0" == "overall" {c -(}
    qui count
    local N_data = r(N)
    qui count if !missing(`v')
    local N_`i' = r(N)
    qui count if missing(`v')
    local n_missing_`i' = r(N)
    {c )-}
  - else {c -(}
  - qui count if `over' == `i'
  = qui count if treat == 0
  - local N_data = r(N)
  - qui count if `over' == `i' & !missing(`v')
  = qui count if treat == 0 & !missing(gender)
  - local N_`i' = r(N)
  = local N_0 = r(N)
  - qui count if missing(`v') & `over'==`i'
  = qui count if missing(gender) & treat==0
  - local n_missing_`i' = r(N)
  = local n_missing_0 = r(N)
  - {c )-}
  - local n_inanalysis_per_`i' = `N_`i''/`N_data' *100
  = local n_inanalysis_per_0 = 494/494 *100
  - local in_per_`i' = string(`n_inanalysis_per_`i'', "%12.`miss_decimal'f")
  = local in_per_0 = string(100, "%12.1f")
  - local inanalysis_`i' = `N_`i''
  = local inanalysis_0 = 494
  - if "`n_analysis_per'" != "" local inanalysis_`i' `N_`i'' (`in_per_`i''`per')
  = if "n_analysis_per" != "" local inanalysis_0 494 (100.0%)
  - local n_missing_per_`i' = `n_missing_`i''/`N_data'*100
  = local n_missing_per_0 = 0/494*100
  - local miss_per_`i' = string(`n_missing_per_`i'', "%12.`miss_decimal'f")
  = local miss_per_0 = string(0, "%12.1f")
  - local missing_`i' = `n_missing_`i''
  = local missing_0 = 0
  - if "`miss_per'" != "" local missing_`i' `n_missing_`i'' (`miss_per_`i''`per')
  = if "" != "" local missing_0 0 (0.0%)
  - display as text %20s abbrev("`i'",20) " {c -(}c |{c )-}" as result %9.0g `N_`i'' " " %9.0g `n_inanalysis_per_`i'' %14.0g `n_missing_`i'' " " %9.0g `n_missing_per_`i''
  = display as text %20s abbrev("0",20) " {c -(}c |{c )-}" as result %9.0g 494 " " %9.0g 100 %14.0g 0 " " %9.0g 0
                   0 {c |}{res}      494       100             0         0
  {txt}- local brackets_`i' ""
  = local brackets_0 ""
  - if "`cond'" == "" | ("`cond'" == "cond" & `miss_overall' != 0) {c -(}
  = if "" == "" | ("" == "cond" & 0 != 0) {c -(}
  - if "`missing'" == "cols" local miss_cols `miss_cols' ("`missing_`i''")
  = if "" == "cols" local miss_cols  ("0")
  - if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("`inanalysis_`i''")
  = if "cols" == "cols" local inan_cols ("506 (100.0%)") ("494 (100.0%)")
  - local brackets_`i'
  = local brackets_0
  - if "`missing'" == "brackets" local brackets_`i' "[`missing_`i'']"
  = if "" == "brackets" local brackets_0 "[0]"
  - if "`n_analysis'" == "brackets" local brackets_`i' "[`inanalysis_`i'']"
  = if "cols" == "brackets" local brackets_0 "[494 (100.0%)]"
  - {c )-}
  - if "`cond'" == "cond" & `miss_overall' == 0 {c -(}
  = if "" == "cond" & 0 == 0 {c -(}
    if "`missing'" == "cols" local miss_cols `miss_cols' ("")
    if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("")
    {c )-}
  - {c )-}
  - if "`i'" == "overall" {c -(}
  = if "overall" == "overall" {c -(}
  - qui count
  - local N_data = r(N)
  - qui count if !missing(`v')
  = qui count if !missing(gender)
  - local N_`i' = r(N)
  = local N_overall = r(N)
  - qui count if missing(`v')
  = qui count if missing(gender)
  - local n_missing_`i' = r(N)
  = local n_missing_overall = r(N)
  - {c )-}
  - else {c -(}
    qui count if `over' == `i'
    local N_data = r(N)
    qui count if `over' == `i' & !missing(`v')
    local N_`i' = r(N)
    qui count if missing(`v') & `over'==`i'
    local n_missing_`i' = r(N)
    {c )-}
  - local n_inanalysis_per_`i' = `N_`i''/`N_data' *100
  = local n_inanalysis_per_overall = 1000/1000 *100
  - local in_per_`i' = string(`n_inanalysis_per_`i'', "%12.`miss_decimal'f")
  = local in_per_overall = string(100, "%12.1f")
  - local inanalysis_`i' = `N_`i''
  = local inanalysis_overall = 1000
  - if "`n_analysis_per'" != "" local inanalysis_`i' `N_`i'' (`in_per_`i''`per')
  = if "n_analysis_per" != "" local inanalysis_overall 1000 (100.0%)
  - local n_missing_per_`i' = `n_missing_`i''/`N_data'*100
  = local n_missing_per_overall = 0/1000*100
  - local miss_per_`i' = string(`n_missing_per_`i'', "%12.`miss_decimal'f")
  = local miss_per_overall = string(0, "%12.1f")
  - local missing_`i' = `n_missing_`i''
  = local missing_overall = 0
  - if "`miss_per'" != "" local missing_`i' `n_missing_`i'' (`miss_per_`i''`per')
  = if "" != "" local missing_overall 0 (0.0%)
  - display as text %20s abbrev("`i'",20) " {c -(}c |{c )-}" as result %9.0g `N_`i'' " " %9.0g `n_inanalysis_per_`i'' %14.0g `n_missing_`i'' " " %9.0g `n_missing_per_`i''
  = display as text %20s abbrev("overall",20) " {c -(}c |{c )-}" as result %9.0g 1000 " " %9.0g 100 %14.0g 0 " " %9.0g 0
             overall {c |}{res}     1000       100             0         0
  {txt}- local brackets_`i' ""
  = local brackets_overall ""
  - if "`cond'" == "" | ("`cond'" == "cond" & `miss_overall' != 0) {c -(}
  = if "" == "" | ("" == "cond" & 0 != 0) {c -(}
  - if "`missing'" == "cols" local miss_cols `miss_cols' ("`missing_`i''")
  = if "" == "cols" local miss_cols  ("0")
  - if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("`inanalysis_`i''")
  = if "cols" == "cols" local inan_cols ("506 (100.0%)") ("494 (100.0%)") ("1000 (100.0%)")
  - local brackets_`i'
  = local brackets_overall
  - if "`missing'" == "brackets" local brackets_`i' "[`missing_`i'']"
  = if "" == "brackets" local brackets_overall "[0]"
  - if "`n_analysis'" == "brackets" local brackets_`i' "[`inanalysis_`i'']"
  = if "cols" == "brackets" local brackets_overall "[1000 (100.0%)]"
  - {c )-}
  - if "`cond'" == "cond" & `miss_overall' == 0 {c -(}
  = if "" == "cond" & 0 == 0 {c -(}
    if "`missing'" == "cols" local miss_cols `miss_cols' ("")
    if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("")
    {c )-}
  - {c )-}
  - di as text "{c -(}hline 21{c )-}{c -(}c BT{c )-}{c -(}hline 43{c )-}"
{hline 21}{c BT}{hline 43}
  - if "`type1'" == "cat" {c -(}
  = if "bin" == "cat" {c -(}
    if "`cat_col'" == "" {c -(}
    if "`order'" == "group_sum" {c -(}
    local summaries ""
    foreach i in `over_grps' {c -(}
    local summaries `summaries' ("")
    {c )-}
    if "`sum_cols_first'" == "" {c -(}
    post `postname' `var_label' `measure_post' `miss_cols' `inan_cols' `summaries' `comment'
    {c )-}
    else {c -(}
    post `postname' `var_label' `measure_post' `summaries' `miss_cols' `inan_cols' `comment'
    {c )-}
    {c )-}
    if "`order'" == "group_treat" {c -(}
    local summaries ""
    foreach i in `over_grps' {c -(}
    if "`n_analysis'" == "cols" local treat_cols`i' ("`inanalysis_`i''")
    if "`missing'" == "cols" local treat_cols`i' ("`missing_`i''")
    local treat_cols`i' `treat_cols`i'' ("")
    local summaries `summaries' `treat_cols`i''
    {c )-}
    post `postname' `var_label' `measure_post' `summaries' `comment'
    {c )-}
    {c )-}
    if "`over'" != "" tab `v' `over', col `miss_opt'
    if "`over'" == "" tab `v', `miss_opt'
    local val_label: value label `v'
    local levels "`cat_levels'"
    if "`levels'" == "" qui levelsof `v', local(levels)
    if "`missing'" == "brackets" local levels `levels' miss
    if "`n_analysis'" == "brackets" local levels `levels' inan
    local row = 0
    foreach i in `levels' {c -(}
    local row = `row' + 1
    if "`i'" == "inan" {c -(}
    local value_name "n included in analysis"
    {c )-}
    else if "`i'" == "miss" {c -(}
    local value_name "missing"
    {c )-}
    else {c -(}
    if "`val_label'" != "" {c -(}
    local value_name: label `val_label' `i'
    {c )-}
    if "`val_label'" == "" {c -(}
    local value_name `i'
    {c )-}
    {c )-}
    foreach j in `over_grps' {c -(}
    if "`i'" != "inan" & "`i'" != "miss" {c -(}
    if "`j'" == "overall" qui count if `v' == `i'
    if "`j'" != "overall" qui count if `v' == `i' & `over' ==`j'
    local n = r(N)
    if "`count_only'" == "" {c -(}
    local percent = `n'/`N_`j''*100
    local per_str = string(`percent', "%12.`su_decimal'f")
    local per_str (`per_str'`per')
    {c )-}
    local su_`j' ("`n' `per_str'")
    {c )-}
    if "`i'" == "inan" | "`i'" == "miss" local su_`j' ("`brackets_`j''")
    {c )-}
    if "`su_label'" == "col" local measure_post ("")
    local tab "`tab1'"
    if "`cat_col'" != "" {c -(}
    if `row' == 1 {c -(}
    local ccol `var_label'
    if "`su_label'" == "col" local measure_post ("`measure1'")
    {c )-}
    if `row' > 1 local ccol ("")
    local tab ""
    {c )-}
    if "`order'" == "group_sum" {c -(}
    local summaries ""
    local miss_cols ""
    local inan_cols ""
    foreach j in `over_grps' {c -(}
    local summaries `summaries' `su_`j''
    if "`missing'" == "cols" local miss_cols `miss_cols' ("`missing_`j''")
    if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("`inanalysis_`j''")
    {c )-}
    if "`sum_cols_first'" == "" {c -(}
    post `postname' `ccol' `measure_post' ("`tab'`value_name'") `inan_cols' `miss_cols' `summaries' `comment'
    {c )-}
    else {c -(}
    post `postname' `ccol' `measure_post' ("`tab'`value_name'") `summaries' `inan_cols' `miss_cols' `comment'
    {c )-}
    {c )-}
    if "`order'" == "group_treat" {c -(}
    local summaries ""
    foreach j in `over_grps' {c -(}
    local treat_cols`j' ""
    if "`missing'" == "cols" local treat_cols`j' `treat_cols`j'' ("`missing_`j''")
    if "`n_analysis'" == "cols" local treat_cols`j' ("`inanalysis_`j''")
    local treat_cols`j' `treat_cols`j'' `su_`j''
    local summaries `summaries' `treat_cols`j''
    {c )-}
    post `postname' `ccol' `measure_post' ("`tab'`value_name'") `summaries' `comment'
    {c )-}
    {c )-}
    {c )-}
  - else {c -(}
  - if "`cat_col'" != "" local ccol ("")
  = if "" != "" local ccol ("")
  - foreach i in `over_grps' {c -(}
  = foreach i in 1 0 overall {c -(}
  - if "`type1'" == "cont" {c -(}
  = if "bin" == "cont" {c -(}
    di "Group `i'"
    if "`i'" == "overall" su `v'
    if "`i'" != "overall" su `v' if `over' == `i'
    local mean = string(r(mean), "%12.`su_decimal'f")
    local sd = string(r(sd), "%12.`su_decimal'f")
    local su_`i' ("`mean' (`sd') `brackets_`i''")
    {c )-}
  - if "`type1'" == "bin" {c -(}
  = if "bin" == "bin" {c -(}
  - if "`i'" == "overall" qui count if `v'==`positive'
  = if "1" == "overall" qui count if gender==1
  - if "`i'" != "overall" qui count if `v'==`positive' & `over' == `i'
  = if "1" != "overall" qui count if gender==1 & treat == 1
  - scalar count_treat_positive_`i' = r(N)
  = scalar count_treat_positive_1 = r(N)
  - local n = count_treat_positive_`i'
  = local n = count_treat_positive_1
  - if "`count_only'" == ""{c -(}
  = if "" == ""{c -(}
  - local percent = count_treat_positive_`i'/`N_`i''*100
  = local percent = count_treat_positive_1/506*100
  - local per_str = string(`percent', "%12.`su_decimal'f")
  = local per_str = string(50.98814229249012, "%12.1f")
  - local per_str (`per_str'`per')
  = local per_str (51.0%)
  - {c )-}
  - local su_`i' ("`n' `per_str' `brackets_`i''")
  = local su_1 ("258 (51.0%) ")
  - {c )-}
  - if "`type1'" == "skew" {c -(}
  = if "bin" == "skew" {c -(}
    di "Group `i'"
    if "`i'" == "overall" tabstat `v', stats(q) save
    if "`i'" != "overall" tabstat `v' if `over' == `i', stats(q) save
    mat define A = r(StatTotal)
    local median = string(A[2,1], "%12.`su_decimal'f")
    local q1 = string(A[1,1], "%12.`su_decimal'f")
    local q3 = string(A[3,1], "%12.`su_decimal'f")
    local su_`i' ("`median' (`q1'-`q3') `brackets_`i''")
    {c )-}
  - {c )-}
  - if "`type1'" == "cont" {c -(}
  = if "bin" == "cont" {c -(}
    di "Group `i'"
    if "`i'" == "overall" su `v'
    if "`i'" != "overall" su `v' if `over' == `i'
    local mean = string(r(mean), "%12.`su_decimal'f")
    local sd = string(r(sd), "%12.`su_decimal'f")
    local su_`i' ("`mean' (`sd') `brackets_`i''")
    {c )-}
  - if "`type1'" == "bin" {c -(}
  = if "bin" == "bin" {c -(}
  - if "`i'" == "overall" qui count if `v'==`positive'
  = if "0" == "overall" qui count if gender==1
  - if "`i'" != "overall" qui count if `v'==`positive' & `over' == `i'
  = if "0" != "overall" qui count if gender==1 & treat == 0
  - scalar count_treat_positive_`i' = r(N)
  = scalar count_treat_positive_0 = r(N)
  - local n = count_treat_positive_`i'
  = local n = count_treat_positive_0
  - if "`count_only'" == ""{c -(}
  = if "" == ""{c -(}
  - local percent = count_treat_positive_`i'/`N_`i''*100
  = local percent = count_treat_positive_0/494*100
  - local per_str = string(`percent', "%12.`su_decimal'f")
  = local per_str = string(52.834008097166, "%12.1f")
  - local per_str (`per_str'`per')
  = local per_str (52.8%)
  - {c )-}
  - local su_`i' ("`n' `per_str' `brackets_`i''")
  = local su_0 ("261 (52.8%) ")
  - {c )-}
  - if "`type1'" == "skew" {c -(}
  = if "bin" == "skew" {c -(}
    di "Group `i'"
    if "`i'" == "overall" tabstat `v', stats(q) save
    if "`i'" != "overall" tabstat `v' if `over' == `i', stats(q) save
    mat define A = r(StatTotal)
    local median = string(A[2,1], "%12.`su_decimal'f")
    local q1 = string(A[1,1], "%12.`su_decimal'f")
    local q3 = string(A[3,1], "%12.`su_decimal'f")
    local su_`i' ("`median' (`q1'-`q3') `brackets_`i''")
    {c )-}
  - {c )-}
  - if "`type1'" == "cont" {c -(}
  = if "bin" == "cont" {c -(}
    di "Group `i'"
    if "`i'" == "overall" su `v'
    if "`i'" != "overall" su `v' if `over' == `i'
    local mean = string(r(mean), "%12.`su_decimal'f")
    local sd = string(r(sd), "%12.`su_decimal'f")
    local su_`i' ("`mean' (`sd') `brackets_`i''")
    {c )-}
  - if "`type1'" == "bin" {c -(}
  = if "bin" == "bin" {c -(}
  - if "`i'" == "overall" qui count if `v'==`positive'
  = if "overall" == "overall" qui count if gender==1
  - if "`i'" != "overall" qui count if `v'==`positive' & `over' == `i'
  = if "overall" != "overall" qui count if gender==1 & treat == overall
  - scalar count_treat_positive_`i' = r(N)
  = scalar count_treat_positive_overall = r(N)
  - local n = count_treat_positive_`i'
  = local n = count_treat_positive_overall
  - if "`count_only'" == ""{c -(}
  = if "" == ""{c -(}
  - local percent = count_treat_positive_`i'/`N_`i''*100
  = local percent = count_treat_positive_overall/1000*100
  - local per_str = string(`percent', "%12.`su_decimal'f")
  = local per_str = string(51.9, "%12.1f")
  - local per_str (`per_str'`per')
  = local per_str (51.9%)
  - {c )-}
  - local su_`i' ("`n' `per_str' `brackets_`i''")
  = local su_overall ("519 (51.9%) ")
  - {c )-}
  - if "`type1'" == "skew" {c -(}
  = if "bin" == "skew" {c -(}
    di "Group `i'"
    if "`i'" == "overall" tabstat `v', stats(q) save
    if "`i'" != "overall" tabstat `v' if `over' == `i', stats(q) save
    mat define A = r(StatTotal)
    local median = string(A[2,1], "%12.`su_decimal'f")
    local q1 = string(A[1,1], "%12.`su_decimal'f")
    local q3 = string(A[3,1], "%12.`su_decimal'f")
    local su_`i' ("`median' (`q1'-`q3') `brackets_`i''")
    {c )-}
  - {c )-}
  - if "`type1'" == "bin" {c -(}
  = if "bin" == "bin" {c -(}
  - if "`miss_opt'" == "" {c -(}
  = if "" == "" {c -(}
  - if "`over'" != "" tab `v' `over', col
  = if "treat" != "" tab gender treat, col

{c TLC}{hline 19}{c TRC}
{c |} Key{col 21}{c |}
{c LT}{hline 19}{c RT}
{c |}{space 5}{it:frequency}{col 21}{c |}
{c |}{space 1}{it:column percentage}{col 21}{c |}
{c BLC}{hline 19}{c BRC}

           {c |}         treat
    Female {c |}         0          1 {c |}     Total
{hline 11}{c +}{hline 22}{c +}{hline 10}
      Male {c |}{res}       233        248 {txt}{c |}{res}       481 
           {txt}{c |}{res}     47.17      49.01 {txt}{c |}{res}     48.10 
{txt}{hline 11}{c +}{hline 22}{c +}{hline 10}
    Female {c |}{res}       261        258 {txt}{c |}{res}       519 
           {txt}{c |}{res}     52.83      50.99 {txt}{c |}{res}     51.90 
{txt}{hline 11}{c +}{hline 22}{c +}{hline 10}
     Total {c |}{res}       494        506 {txt}{c |}{res}     1,000 
           {txt}{c |}{res}    100.00     100.00 {txt}{c |}{res}    100.00 
  {txt}- if "`over'" == "" tab `v'
  = if "treat" == "" tab gender
  - {c )-}
  - {c )-}
  - if "`order'" == "group_sum" {c -(}
  = if "group_treat" == "group_sum" {c -(}
    local summaries ""
    foreach i in `over_grps' {c -(}
    local summaries `summaries' `su_`i''
    {c )-}
    if "`sum_cols_first'" == "" {c -(}
    post `postname' `var_label' `measure_post' `ccol' `inan_cols' `miss_cols' `summaries' `comment'
    {c )-}
    else {c -(}
    post `postname' `var_label' `measure_post' `ccol' `summaries' `inan_cols' `miss_cols' `comment'
    {c )-}
    {c )-}
  - if "`order'" == "group_treat" {c -(}
  = if "group_treat" == "group_treat" {c -(}
  - local summaries ""
  - foreach i in `over_grps' {c -(}
  = foreach i in 1 0 overall {c -(}
  - if "`n_analysis'" == "cols" local treat_cols`i' ("`inanalysis_`i''")
  = if "cols" == "cols" local treat_cols1 ("506 (100.0%)")
  - if "`missing'" == "cols" local treat_cols`i' ("`missing_`i''")
  = if "" == "cols" local treat_cols1 ("0")
  - local treat_cols`i' `treat_cols`i'' `su_`i''
  = local treat_cols1 ("506 (100.0%)") ("258 (51.0%) ")
  - local summaries `summaries' `treat_cols`i''
  = local summaries  ("506 (100.0%)") ("258 (51.0%) ")
  - {c )-}
  - if "`n_analysis'" == "cols" local treat_cols`i' ("`inanalysis_`i''")
  = if "cols" == "cols" local treat_cols0 ("494 (100.0%)")
  - if "`missing'" == "cols" local treat_cols`i' ("`missing_`i''")
  = if "" == "cols" local treat_cols0 ("0")
  - local treat_cols`i' `treat_cols`i'' `su_`i''
  = local treat_cols0 ("494 (100.0%)") ("261 (52.8%) ")
  - local summaries `summaries' `treat_cols`i''
  = local summaries ("506 (100.0%)") ("258 (51.0%) ") ("494 (100.0%)") ("261 (52.8%) ")
  - {c )-}
  - if "`n_analysis'" == "cols" local treat_cols`i' ("`inanalysis_`i''")
  = if "cols" == "cols" local treat_colsoverall ("1000 (100.0%)")
  - if "`missing'" == "cols" local treat_cols`i' ("`missing_`i''")
  = if "" == "cols" local treat_colsoverall ("0")
  - local treat_cols`i' `treat_cols`i'' `su_`i''
  = local treat_colsoverall ("1000 (100.0%)") ("519 (51.9%) ")
  - local summaries `summaries' `treat_cols`i''
  = local summaries ("506 (100.0%)") ("258 (51.0%) ") ("494 (100.0%)") ("261 (52.8%) ") ("1000 (100.0%)") ("519 (51.9%) ")
  - {c )-}
  - post `postname' `var_label' `measure_post' `ccol' `summaries' `comment'
  = post __000000 ("Female - n (%) ")   ("506 (100.0%)") ("258 (51.0%) ") ("494 (100.0%)") ("261 (52.8%) ") ("1000 (100.0%)") ("519 (51.9%) ") 
  - {c )-}
  - {c )-}
  - local measure_post
  - if "`su_label'" == "col" local measure_post ("")
  = if "append" == "col" local measure_post ("")
  - if "`cat_col'" != "" local ccol ("")
  = if "" != "" local ccol ("")
  - local summaries ""
  - local miss_cols ""
  - local inan_cols ""
  - foreach i in `over_grps' {c -(}
  = foreach i in 1 0 overall {c -(}
  - local summaries `summaries' ("")
  = local summaries  ("")
  - if "`missing'" == "cols" local miss_cols `miss_cols' ("")
  = if "" == "cols" local miss_cols  ("")
  - if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("")
  = if "cols" == "cols" local inan_cols  ("")
  - {c )-}
  - local summaries `summaries' ("")
  = local summaries ("") ("")
  - if "`missing'" == "cols" local miss_cols `miss_cols' ("")
  = if "" == "cols" local miss_cols  ("")
  - if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("")
  = if "cols" == "cols" local inan_cols ("") ("")
  - {c )-}
  - local summaries `summaries' ("")
  = local summaries ("") ("") ("")
  - if "`missing'" == "cols" local miss_cols `miss_cols' ("")
  = if "" == "cols" local miss_cols  ("")
  - if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("")
  = if "cols" == "cols" local inan_cols ("") ("") ("")
  - {c )-}
  - if "`comment'" != "" local comment ("")
  = if "" != "" local comment ("")
  - if `gap' > 0 {c -(}
  = if 1 > 0 {c -(}
  - forvalues i = 1 (1) `gap' {c -(}
  = forvalues i = 1 (1) 1 {c -(}
  - post `postname' ("") `measure_post' `ccol' `inan_cols' `miss_cols' `summaries' `comment'
  = post __000000 ("")   ("") ("") ("")  ("") ("") ("") 
  - {c )-}
  - {c )-}
  - {c )-}
  - if `gap_end' > 0 {c -(}
  = if 0 > 0 {c -(}
    forvalues i = 1 (1) `gap_end' {c -(}
    post `postname' ("") `measure_post' `ccol' `inan_cols' `miss_cols' `summaries' `comment'
    {c )-}
    {c )-}
  - if "`if'" != "" restore
  = if "" != "" restore
  {hline 88} end pt_base {hline}

{com}. pt_base ethnicity, post(`postname') over(treat)  overall(last)  over_grps(1, 0) type(cat)  su_label(append)   cat_levels(4 3 2 1 0)  gap(1) n_analysis(cols %)  order(group_treat) per
{txt}  {hline 86} begin pt_base {hline}
  - syntax varlist(numeric) [if], POSTname(string) [ Type(string) count_only over(varname) over_grps(numlist) overall(string) cat_levels(numlist) cat_col cat_tabs(integer 1) gap(integer 0) gap_end(integer 0) decimal(integer 1) miss_decimal(integer 1) su_decimal(integer 1) positive(integer 1) Missing(string) N_analysis(string) order(string) sum_cols_first su_label(string) su_label_text(string) append_label(string) var_lab(string) per comment(string) ]
  - if "`if'" != "" {c -(}
  = if "" != "" {c -(}
    preserve
    keep `if'
    {c )-}
  - if `su_decimal' ==1 local su_decimal = `decimal'
  = if 1 ==1 local su_decimal = 1
  - if `miss_decimal' ==1 local miss_decimal = `decimal'
  = if 1 ==1 local miss_decimal = 1
  - if "`over'" != "" {c -(}
  = if "treat" != "" {c -(}
  - if "`over_grps'" == "" levelsof `over', local(over_grps)
  = if "1 0" == "" levelsof treat, local(over_grps)
  - if "`overall'" == "first" local over_grps overall `over_grps'
  = if "last" == "first" local over_grps overall 1 0
  - if "`overall'" == "last" local over_grps `over_grps' overall
  = if "last" == "last" local over_grps 1 0 overall
  - {c )-}
  - if "`over'" == "" local over_grps overall
  = if "treat" == "" local over_grps overall
  - if "`order'" == "" local order group_sum
  = if "group_treat" == "" local order group_sum
  - if "`per'" != "" local per %
  = if "per" != "" local per %
  - if "`comment'" != "" & "`comment'" != "no comment" local comment ("`comment'")
  = if "" != "" & "" != "no comment" local comment ("")
  - if "`comment'" == "no comment" local comment ("")
  = if "" == "no comment" local comment ("")
  - if "`type'" == "misstable" {c -(}
  = if "cat" == "misstable" {c -(}
    local type bin
    local positive .
    local miss_opt missing
    {c )-}
  - foreach w in `missing' {c -(}
  = foreach w in  {c -(}
    if "`w'" == "brackets" local missing brackets
    if "`w'" == "cols" local missing cols
    if "`w'" == "%" local miss_per miss_per
    if "`w'" == "cond" local cond cond
    {c )-}
  - foreach w in `n_analysis' {c -(}
  = foreach w in cols % {c -(}
  - if "`w'" == "brackets" local n_analysis brackets
  = if "cols" == "brackets" local n_analysis brackets
  - if "`w'" == "append" local n_analysis append
  = if "cols" == "append" local n_analysis append
  - if "`w'" == "cols" local n_analysis cols
  = if "cols" == "cols" local n_analysis cols
  - if "`w'" == "%" local n_analysis_per n_analysis_per
  = if "cols" == "%" local n_analysis_per n_analysis_per
  - if "`w'" == "cond" local cond cond
  = if "cols" == "cond" local cond cond
  - {c )-}
  - if "`w'" == "brackets" local n_analysis brackets
  = if "%" == "brackets" local n_analysis brackets
  - if "`w'" == "append" local n_analysis append
  = if "%" == "append" local n_analysis append
  - if "`w'" == "cols" local n_analysis cols
  = if "%" == "cols" local n_analysis cols
  - if "`w'" == "%" local n_analysis_per n_analysis_per
  = if "%" == "%" local n_analysis_per n_analysis_per
  - if "`w'" == "cond" local cond cond
  = if "%" == "cond" local cond cond
  - {c )-}
  - forvalues t = 1 (1) `cat_tabs' {c -(}
  = forvalues t = 1 (1) 1 {c -(}
  - local tab1 = "`tab1'    "
  = local tab1 = "    "
  - {c )-}
  - foreach v in `varlist' {c -(}
  = foreach v in ethnicity {c -(}
  - di as result _newline(3) "****** `v' ******" _newline(1)
  = di as result _newline(3) "****** ethnicity ******" _newline(1)



{res}****** ethnicity ******

  {txt}- display as text %26s "Group {c -(}c |{c )-}" as text %19s "N obs. Percent" %24s "N missing Percent"
               Group {c |}     N obs. Percent       N missing Percent
  - di as text "{c -(}hline 21{c )-}{c -(}c +{c )-}{c -(}hline 43{c )-}"
{hline 21}{c +}{hline 43}
  - local type1 = "`type'"
  = local type1 = "cat"
  - if "`type1'" == "" {c -(}
  = if "cat" == "" {c -(}
    qui inspect `v'
    if r(N_unique) < 3 {c -(}
    local type1 = "bin"
    {c )-}
    else if r(N_unique) < 10 {c -(}
    local type1 = "cat"
    {c )-}
    else if r(N_unique) >= 10 | r(N_unique) ==. {c -(}
    local type1 = "cont"
    {c )-}
    {c )-}
  - qui count if missing(`v')
  = qui count if missing(ethnicity)
  - local miss_overall = r(N)
  - local var_label `var_lab'
  = local var_label 
  - if "`var_lab'" == "" local var_label:variable label `v'
  = if "" == "" local var_label:variable label ethnicity
  - if "`var_label'" == "" local var_label = "`v'"
  = if "Ethnicity" == "" local var_label = "ethnicity"
  - local var_label `var_label' `append_label'
  = local var_label Ethnicity 
  - if "`type1'" == "cont" local measure1 "mean (sd)"
  = if "cat" == "cont" local measure1 "mean (sd)"
  - if "`type1'" == "bin" | "`type1'" == "cat" {c -(}
  = if "cat" == "bin" | "cat" == "cat" {c -(}
  - local measure1 "n (%)"
  - if "`count_only'" != "" local measure1 "n"
  = if "" != "" local measure1 "n"
  - {c )-}
  - if "`type1'" == "skew" local measure1 "median (IQR)"
  = if "cat" == "skew" local measure1 "median (IQR)"
  - if "`missing'" == "brackets" local measure1 "`measure1' [missing]"
  = if "" == "brackets" local measure1 "n (%) [missing]"
  - if "`n_analysis'" == "brackets" local measure1 "`measure1' [n included in analysis]"
  = if "cols" == "brackets" local measure1 "n (%) [n included in analysis]"
  - if "`su_label_text'" != "" local measure1 `su_label_text'
  = if "" != "" local measure1 
  - if "`su_label'" == "append" local measure_append =" - `measure1'"
  = if "append" == "append" local measure_append =" - n (%)"
  - local N_append ""
  - if "`n_analysis'" == "append" & ("`cond'" =="" | `miss_overall' > 0) {c -(}
  = if "cols" == "append" & ("" =="" | 111 > 0) {c -(}
    qui count if missing(`v') ==0
    local N = r(N)
    local N_append (N = `N')
    {c )-}
  - local var_label ("`var_label'`measure_append' `N_append'")
  = local var_label ("Ethnicity - n (%) ")
  - local measure_post
  - if "`su_label'" == "col" local measure_post ("`measure1'")
  = if "append" == "col" local measure_post ("n (%)")
  - local miss_cols ""
  - local inan_cols ""
  - foreach i in `over_grps' {c -(}
  = foreach i in 1 0 overall {c -(}
  - if "`i'" == "overall" {c -(}
  = if "1" == "overall" {c -(}
    qui count
    local N_data = r(N)
    qui count if !missing(`v')
    local N_`i' = r(N)
    qui count if missing(`v')
    local n_missing_`i' = r(N)
    {c )-}
  - else {c -(}
  - qui count if `over' == `i'
  = qui count if treat == 1
  - local N_data = r(N)
  - qui count if `over' == `i' & !missing(`v')
  = qui count if treat == 1 & !missing(ethnicity)
  - local N_`i' = r(N)
  = local N_1 = r(N)
  - qui count if missing(`v') & `over'==`i'
  = qui count if missing(ethnicity) & treat==1
  - local n_missing_`i' = r(N)
  = local n_missing_1 = r(N)
  - {c )-}
  - local n_inanalysis_per_`i' = `N_`i''/`N_data' *100
  = local n_inanalysis_per_1 = 454/506 *100
  - local in_per_`i' = string(`n_inanalysis_per_`i'', "%12.`miss_decimal'f")
  = local in_per_1 = string(89.72332015810277, "%12.1f")
  - local inanalysis_`i' = `N_`i''
  = local inanalysis_1 = 454
  - if "`n_analysis_per'" != "" local inanalysis_`i' `N_`i'' (`in_per_`i''`per')
  = if "n_analysis_per" != "" local inanalysis_1 454 (89.7%)
  - local n_missing_per_`i' = `n_missing_`i''/`N_data'*100
  = local n_missing_per_1 = 52/506*100
  - local miss_per_`i' = string(`n_missing_per_`i'', "%12.`miss_decimal'f")
  = local miss_per_1 = string(10.27667984189723, "%12.1f")
  - local missing_`i' = `n_missing_`i''
  = local missing_1 = 52
  - if "`miss_per'" != "" local missing_`i' `n_missing_`i'' (`miss_per_`i''`per')
  = if "" != "" local missing_1 52 (10.3%)
  - display as text %20s abbrev("`i'",20) " {c -(}c |{c )-}" as result %9.0g `N_`i'' " " %9.0g `n_inanalysis_per_`i'' %14.0g `n_missing_`i'' " " %9.0g `n_missing_per_`i''
  = display as text %20s abbrev("1",20) " {c -(}c |{c )-}" as result %9.0g 454 " " %9.0g 89.72332015810277 %14.0g 52 " " %9.0g 10.27667984189723
                   1 {c |}{res}      454  89.72332            52  10.27668
  {txt}- local brackets_`i' ""
  = local brackets_1 ""
  - if "`cond'" == "" | ("`cond'" == "cond" & `miss_overall' != 0) {c -(}
  = if "" == "" | ("" == "cond" & 111 != 0) {c -(}
  - if "`missing'" == "cols" local miss_cols `miss_cols' ("`missing_`i''")
  = if "" == "cols" local miss_cols  ("52")
  - if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("`inanalysis_`i''")
  = if "cols" == "cols" local inan_cols  ("454 (89.7%)")
  - local brackets_`i'
  = local brackets_1
  - if "`missing'" == "brackets" local brackets_`i' "[`missing_`i'']"
  = if "" == "brackets" local brackets_1 "[52]"
  - if "`n_analysis'" == "brackets" local brackets_`i' "[`inanalysis_`i'']"
  = if "cols" == "brackets" local brackets_1 "[454 (89.7%)]"
  - {c )-}
  - if "`cond'" == "cond" & `miss_overall' == 0 {c -(}
  = if "" == "cond" & 111 == 0 {c -(}
    if "`missing'" == "cols" local miss_cols `miss_cols' ("")
    if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("")
    {c )-}
  - {c )-}
  - if "`i'" == "overall" {c -(}
  = if "0" == "overall" {c -(}
    qui count
    local N_data = r(N)
    qui count if !missing(`v')
    local N_`i' = r(N)
    qui count if missing(`v')
    local n_missing_`i' = r(N)
    {c )-}
  - else {c -(}
  - qui count if `over' == `i'
  = qui count if treat == 0
  - local N_data = r(N)
  - qui count if `over' == `i' & !missing(`v')
  = qui count if treat == 0 & !missing(ethnicity)
  - local N_`i' = r(N)
  = local N_0 = r(N)
  - qui count if missing(`v') & `over'==`i'
  = qui count if missing(ethnicity) & treat==0
  - local n_missing_`i' = r(N)
  = local n_missing_0 = r(N)
  - {c )-}
  - local n_inanalysis_per_`i' = `N_`i''/`N_data' *100
  = local n_inanalysis_per_0 = 435/494 *100
  - local in_per_`i' = string(`n_inanalysis_per_`i'', "%12.`miss_decimal'f")
  = local in_per_0 = string(88.05668016194332, "%12.1f")
  - local inanalysis_`i' = `N_`i''
  = local inanalysis_0 = 435
  - if "`n_analysis_per'" != "" local inanalysis_`i' `N_`i'' (`in_per_`i''`per')
  = if "n_analysis_per" != "" local inanalysis_0 435 (88.1%)
  - local n_missing_per_`i' = `n_missing_`i''/`N_data'*100
  = local n_missing_per_0 = 59/494*100
  - local miss_per_`i' = string(`n_missing_per_`i'', "%12.`miss_decimal'f")
  = local miss_per_0 = string(11.94331983805668, "%12.1f")
  - local missing_`i' = `n_missing_`i''
  = local missing_0 = 59
  - if "`miss_per'" != "" local missing_`i' `n_missing_`i'' (`miss_per_`i''`per')
  = if "" != "" local missing_0 59 (11.9%)
  - display as text %20s abbrev("`i'",20) " {c -(}c |{c )-}" as result %9.0g `N_`i'' " " %9.0g `n_inanalysis_per_`i'' %14.0g `n_missing_`i'' " " %9.0g `n_missing_per_`i''
  = display as text %20s abbrev("0",20) " {c -(}c |{c )-}" as result %9.0g 435 " " %9.0g 88.05668016194332 %14.0g 59 " " %9.0g 11.94331983805668
                   0 {c |}{res}      435  88.05668            59  11.94332
  {txt}- local brackets_`i' ""
  = local brackets_0 ""
  - if "`cond'" == "" | ("`cond'" == "cond" & `miss_overall' != 0) {c -(}
  = if "" == "" | ("" == "cond" & 111 != 0) {c -(}
  - if "`missing'" == "cols" local miss_cols `miss_cols' ("`missing_`i''")
  = if "" == "cols" local miss_cols  ("59")
  - if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("`inanalysis_`i''")
  = if "cols" == "cols" local inan_cols ("454 (89.7%)") ("435 (88.1%)")
  - local brackets_`i'
  = local brackets_0
  - if "`missing'" == "brackets" local brackets_`i' "[`missing_`i'']"
  = if "" == "brackets" local brackets_0 "[59]"
  - if "`n_analysis'" == "brackets" local brackets_`i' "[`inanalysis_`i'']"
  = if "cols" == "brackets" local brackets_0 "[435 (88.1%)]"
  - {c )-}
  - if "`cond'" == "cond" & `miss_overall' == 0 {c -(}
  = if "" == "cond" & 111 == 0 {c -(}
    if "`missing'" == "cols" local miss_cols `miss_cols' ("")
    if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("")
    {c )-}
  - {c )-}
  - if "`i'" == "overall" {c -(}
  = if "overall" == "overall" {c -(}
  - qui count
  - local N_data = r(N)
  - qui count if !missing(`v')
  = qui count if !missing(ethnicity)
  - local N_`i' = r(N)
  = local N_overall = r(N)
  - qui count if missing(`v')
  = qui count if missing(ethnicity)
  - local n_missing_`i' = r(N)
  = local n_missing_overall = r(N)
  - {c )-}
  - else {c -(}
    qui count if `over' == `i'
    local N_data = r(N)
    qui count if `over' == `i' & !missing(`v')
    local N_`i' = r(N)
    qui count if missing(`v') & `over'==`i'
    local n_missing_`i' = r(N)
    {c )-}
  - local n_inanalysis_per_`i' = `N_`i''/`N_data' *100
  = local n_inanalysis_per_overall = 889/1000 *100
  - local in_per_`i' = string(`n_inanalysis_per_`i'', "%12.`miss_decimal'f")
  = local in_per_overall = string(88.90000000000001, "%12.1f")
  - local inanalysis_`i' = `N_`i''
  = local inanalysis_overall = 889
  - if "`n_analysis_per'" != "" local inanalysis_`i' `N_`i'' (`in_per_`i''`per')
  = if "n_analysis_per" != "" local inanalysis_overall 889 (88.9%)
  - local n_missing_per_`i' = `n_missing_`i''/`N_data'*100
  = local n_missing_per_overall = 111/1000*100
  - local miss_per_`i' = string(`n_missing_per_`i'', "%12.`miss_decimal'f")
  = local miss_per_overall = string(11.1, "%12.1f")
  - local missing_`i' = `n_missing_`i''
  = local missing_overall = 111
  - if "`miss_per'" != "" local missing_`i' `n_missing_`i'' (`miss_per_`i''`per')
  = if "" != "" local missing_overall 111 (11.1%)
  - display as text %20s abbrev("`i'",20) " {c -(}c |{c )-}" as result %9.0g `N_`i'' " " %9.0g `n_inanalysis_per_`i'' %14.0g `n_missing_`i'' " " %9.0g `n_missing_per_`i''
  = display as text %20s abbrev("overall",20) " {c -(}c |{c )-}" as result %9.0g 889 " " %9.0g 88.90000000000001 %14.0g 111 " " %9.0g 11.1
             overall {c |}{res}      889      88.9           111      11.1
  {txt}- local brackets_`i' ""
  = local brackets_overall ""
  - if "`cond'" == "" | ("`cond'" == "cond" & `miss_overall' != 0) {c -(}
  = if "" == "" | ("" == "cond" & 111 != 0) {c -(}
  - if "`missing'" == "cols" local miss_cols `miss_cols' ("`missing_`i''")
  = if "" == "cols" local miss_cols  ("111")
  - if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("`inanalysis_`i''")
  = if "cols" == "cols" local inan_cols ("454 (89.7%)") ("435 (88.1%)") ("889 (88.9%)")
  - local brackets_`i'
  = local brackets_overall
  - if "`missing'" == "brackets" local brackets_`i' "[`missing_`i'']"
  = if "" == "brackets" local brackets_overall "[111]"
  - if "`n_analysis'" == "brackets" local brackets_`i' "[`inanalysis_`i'']"
  = if "cols" == "brackets" local brackets_overall "[889 (88.9%)]"
  - {c )-}
  - if "`cond'" == "cond" & `miss_overall' == 0 {c -(}
  = if "" == "cond" & 111 == 0 {c -(}
    if "`missing'" == "cols" local miss_cols `miss_cols' ("")
    if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("")
    {c )-}
  - {c )-}
  - di as text "{c -(}hline 21{c )-}{c -(}c BT{c )-}{c -(}hline 43{c )-}"
{hline 21}{c BT}{hline 43}
  - if "`type1'" == "cat" {c -(}
  = if "cat" == "cat" {c -(}
  - if "`cat_col'" == "" {c -(}
  = if "" == "" {c -(}
  - if "`order'" == "group_sum" {c -(}
  = if "group_treat" == "group_sum" {c -(}
    local summaries ""
    foreach i in `over_grps' {c -(}
    local summaries `summaries' ("")
    {c )-}
    if "`sum_cols_first'" == "" {c -(}
    post `postname' `var_label' `measure_post' `miss_cols' `inan_cols' `summaries' `comment'
    {c )-}
    else {c -(}
    post `postname' `var_label' `measure_post' `summaries' `miss_cols' `inan_cols' `comment'
    {c )-}
    {c )-}
  - if "`order'" == "group_treat" {c -(}
  = if "group_treat" == "group_treat" {c -(}
  - local summaries ""
  - foreach i in `over_grps' {c -(}
  = foreach i in 1 0 overall {c -(}
  - if "`n_analysis'" == "cols" local treat_cols`i' ("`inanalysis_`i''")
  = if "cols" == "cols" local treat_cols1 ("454 (89.7%)")
  - if "`missing'" == "cols" local treat_cols`i' ("`missing_`i''")
  = if "" == "cols" local treat_cols1 ("52")
  - local treat_cols`i' `treat_cols`i'' ("")
  = local treat_cols1 ("454 (89.7%)") ("")
  - local summaries `summaries' `treat_cols`i''
  = local summaries  ("454 (89.7%)") ("")
  - {c )-}
  - if "`n_analysis'" == "cols" local treat_cols`i' ("`inanalysis_`i''")
  = if "cols" == "cols" local treat_cols0 ("435 (88.1%)")
  - if "`missing'" == "cols" local treat_cols`i' ("`missing_`i''")
  = if "" == "cols" local treat_cols0 ("59")
  - local treat_cols`i' `treat_cols`i'' ("")
  = local treat_cols0 ("435 (88.1%)") ("")
  - local summaries `summaries' `treat_cols`i''
  = local summaries ("454 (89.7%)") ("") ("435 (88.1%)") ("")
  - {c )-}
  - if "`n_analysis'" == "cols" local treat_cols`i' ("`inanalysis_`i''")
  = if "cols" == "cols" local treat_colsoverall ("889 (88.9%)")
  - if "`missing'" == "cols" local treat_cols`i' ("`missing_`i''")
  = if "" == "cols" local treat_colsoverall ("111")
  - local treat_cols`i' `treat_cols`i'' ("")
  = local treat_colsoverall ("889 (88.9%)") ("")
  - local summaries `summaries' `treat_cols`i''
  = local summaries ("454 (89.7%)") ("") ("435 (88.1%)") ("") ("889 (88.9%)") ("")
  - {c )-}
  - post `postname' `var_label' `measure_post' `summaries' `comment'
  = post __000000 ("Ethnicity - n (%) ")  ("454 (89.7%)") ("") ("435 (88.1%)") ("") ("889 (88.9%)") ("") 
  - {c )-}
  - {c )-}
  - if "`over'" != "" tab `v' `over', col `miss_opt'
  = if "treat" != "" tab ethnicity treat, col 

{c TLC}{hline 19}{c TRC}
{c |} Key{col 21}{c |}
{c LT}{hline 19}{c RT}
{c |}{space 5}{it:frequency}{col 21}{c |}
{c |}{space 1}{it:column percentage}{col 21}{c |}
{c BLC}{hline 19}{c BRC}

                      {c |}         treat
            Ethnicity {c |}         0          1 {c |}     Total
{hline 22}{c +}{hline 22}{c +}{hline 10}
                Other {c |}{res}        26         19 {txt}{c |}{res}        45 
                      {txt}{c |}{res}      5.98       4.19 {txt}{c |}{res}      5.06 
{txt}{hline 22}{c +}{hline 22}{c +}{hline 10}
                Mixed {c |}{res}        70         61 {txt}{c |}{res}       131 
                      {txt}{c |}{res}     16.09      13.44 {txt}{c |}{res}     14.74 
{txt}{hline 22}{c +}{hline 22}{c +}{hline 10}
Asian or Asian Britis {c |}{res}       100        101 {txt}{c |}{res}       201 
                      {txt}{c |}{res}     22.99      22.25 {txt}{c |}{res}     22.61 
{txt}{hline 22}{c +}{hline 22}{c +}{hline 10}
Black or Black Britis {c |}{res}       103        128 {txt}{c |}{res}       231 
                      {txt}{c |}{res}     23.68      28.19 {txt}{c |}{res}     25.98 
{txt}{hline 22}{c +}{hline 22}{c +}{hline 10}
White or White Britis {c |}{res}       136        145 {txt}{c |}{res}       281 
                      {txt}{c |}{res}     31.26      31.94 {txt}{c |}{res}     31.61 
{txt}{hline 22}{c +}{hline 22}{c +}{hline 10}
                Total {c |}{res}       435        454 {txt}{c |}{res}       889 
                      {txt}{c |}{res}    100.00     100.00 {txt}{c |}{res}    100.00 
  {txt}- if "`over'" == "" tab `v', `miss_opt'
  = if "treat" == "" tab ethnicity, 
  - local val_label: value label `v'
  = local val_label: value label ethnicity
  - local levels "`cat_levels'"
  = local levels "4 3 2 1 0"
  - if "`levels'" == "" qui levelsof `v', local(levels)
  = if "4 3 2 1 0" == "" qui levelsof ethnicity, local(levels)
  - if "`missing'" == "brackets" local levels `levels' miss
  = if "" == "brackets" local levels 4 3 2 1 0 miss
  - if "`n_analysis'" == "brackets" local levels `levels' inan
  = if "cols" == "brackets" local levels 4 3 2 1 0 inan
  - local row = 0
  - foreach i in `levels' {c -(}
  = foreach i in 4 3 2 1 0 {c -(}
  - local row = `row' + 1
  = local row = 0 + 1
  - if "`i'" == "inan" {c -(}
  = if "4" == "inan" {c -(}
    local value_name "n included in analysis"
    {c )-}
  - else if "`i'" == "miss" {c -(}
  = else if "4" == "miss" {c -(}
    local value_name "missing"
    {c )-}
  - else {c -(}
  - if "`val_label'" != "" {c -(}
  = if "ethnicity" != "" {c -(}
  - local value_name: label `val_label' `i'
  = local value_name: label ethnicity 4
  - {c )-}
  - if "`val_label'" == "" {c -(}
  = if "ethnicity" == "" {c -(}
    local value_name `i'
    {c )-}
  - {c )-}
  - foreach j in `over_grps' {c -(}
  = foreach j in 1 0 overall {c -(}
  - if "`i'" != "inan" & "`i'" != "miss" {c -(}
  = if "4" != "inan" & "4" != "miss" {c -(}
  - if "`j'" == "overall" qui count if `v' == `i'
  = if "1" == "overall" qui count if ethnicity == 4
  - if "`j'" != "overall" qui count if `v' == `i' & `over' ==`j'
  = if "1" != "overall" qui count if ethnicity == 4 & treat ==1
  - local n = r(N)
  - if "`count_only'" == "" {c -(}
  = if "" == "" {c -(}
  - local percent = `n'/`N_`j''*100
  = local percent = 145/454*100
  - local per_str = string(`percent', "%12.`su_decimal'f")
  = local per_str = string(31.93832599118943, "%12.1f")
  - local per_str (`per_str'`per')
  = local per_str (31.9%)
  - {c )-}
  - local su_`j' ("`n' `per_str'")
  = local su_1 ("145 (31.9%)")
  - {c )-}
  - if "`i'" == "inan" | "`i'" == "miss" local su_`j' ("`brackets_`j''")
  = if "4" == "inan" | "4" == "miss" local su_1 ("")
  - {c )-}
  - if "`i'" != "inan" & "`i'" != "miss" {c -(}
  = if "4" != "inan" & "4" != "miss" {c -(}
  - if "`j'" == "overall" qui count if `v' == `i'
  = if "0" == "overall" qui count if ethnicity == 4
  - if "`j'" != "overall" qui count if `v' == `i' & `over' ==`j'
  = if "0" != "overall" qui count if ethnicity == 4 & treat ==0
  - local n = r(N)
  - if "`count_only'" == "" {c -(}
  = if "" == "" {c -(}
  - local percent = `n'/`N_`j''*100
  = local percent = 136/435*100
  - local per_str = string(`percent', "%12.`su_decimal'f")
  = local per_str = string(31.26436781609195, "%12.1f")
  - local per_str (`per_str'`per')
  = local per_str (31.3%)
  - {c )-}
  - local su_`j' ("`n' `per_str'")
  = local su_0 ("136 (31.3%)")
  - {c )-}
  - if "`i'" == "inan" | "`i'" == "miss" local su_`j' ("`brackets_`j''")
  = if "4" == "inan" | "4" == "miss" local su_0 ("")
  - {c )-}
  - if "`i'" != "inan" & "`i'" != "miss" {c -(}
  = if "4" != "inan" & "4" != "miss" {c -(}
  - if "`j'" == "overall" qui count if `v' == `i'
  = if "overall" == "overall" qui count if ethnicity == 4
  - if "`j'" != "overall" qui count if `v' == `i' & `over' ==`j'
  = if "overall" != "overall" qui count if ethnicity == 4 & treat ==overall
  - local n = r(N)
  - if "`count_only'" == "" {c -(}
  = if "" == "" {c -(}
  - local percent = `n'/`N_`j''*100
  = local percent = 281/889*100
  - local per_str = string(`percent', "%12.`su_decimal'f")
  = local per_str = string(31.60854893138358, "%12.1f")
  - local per_str (`per_str'`per')
  = local per_str (31.6%)
  - {c )-}
  - local su_`j' ("`n' `per_str'")
  = local su_overall ("281 (31.6%)")
  - {c )-}
  - if "`i'" == "inan" | "`i'" == "miss" local su_`j' ("`brackets_`j''")
  = if "4" == "inan" | "4" == "miss" local su_overall ("")
  - {c )-}
  - if "`su_label'" == "col" local measure_post ("")
  = if "append" == "col" local measure_post ("")
  - local tab "`tab1'"
  = local tab "    "
  - if "`cat_col'" != "" {c -(}
  = if "" != "" {c -(}
    if `row' == 1 {c -(}
    local ccol `var_label'
    if "`su_label'" == "col" local measure_post ("`measure1'")
    {c )-}
    if `row' > 1 local ccol ("")
    local tab ""
    {c )-}
  - if "`order'" == "group_sum" {c -(}
  = if "group_treat" == "group_sum" {c -(}
    local summaries ""
    local miss_cols ""
    local inan_cols ""
    foreach j in `over_grps' {c -(}
    local summaries `summaries' `su_`j''
    if "`missing'" == "cols" local miss_cols `miss_cols' ("`missing_`j''")
    if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("`inanalysis_`j''")
    {c )-}
    if "`sum_cols_first'" == "" {c -(}
    post `postname' `ccol' `measure_post' ("`tab'`value_name'") `inan_cols' `miss_cols' `summaries' `comment'
    {c )-}
    else {c -(}
    post `postname' `ccol' `measure_post' ("`tab'`value_name'") `summaries' `inan_cols' `miss_cols' `comment'
    {c )-}
    {c )-}
  - if "`order'" == "group_treat" {c -(}
  = if "group_treat" == "group_treat" {c -(}
  - local summaries ""
  - foreach j in `over_grps' {c -(}
  = foreach j in 1 0 overall {c -(}
  - local treat_cols`j' ""
  = local treat_cols1 ""
  - if "`missing'" == "cols" local treat_cols`j' `treat_cols`j'' ("`missing_`j''")
  = if "" == "cols" local treat_cols1  ("52")
  - if "`n_analysis'" == "cols" local treat_cols`j' ("`inanalysis_`j''")
  = if "cols" == "cols" local treat_cols1 ("454 (89.7%)")
  - local treat_cols`j' `treat_cols`j'' `su_`j''
  = local treat_cols1 ("454 (89.7%)") ("145 (31.9%)")
  - local summaries `summaries' `treat_cols`j''
  = local summaries  ("454 (89.7%)") ("145 (31.9%)")
  - {c )-}
  - local treat_cols`j' ""
  = local treat_cols0 ""
  - if "`missing'" == "cols" local treat_cols`j' `treat_cols`j'' ("`missing_`j''")
  = if "" == "cols" local treat_cols0  ("59")
  - if "`n_analysis'" == "cols" local treat_cols`j' ("`inanalysis_`j''")
  = if "cols" == "cols" local treat_cols0 ("435 (88.1%)")
  - local treat_cols`j' `treat_cols`j'' `su_`j''
  = local treat_cols0 ("435 (88.1%)") ("136 (31.3%)")
  - local summaries `summaries' `treat_cols`j''
  = local summaries ("454 (89.7%)") ("145 (31.9%)") ("435 (88.1%)") ("136 (31.3%)")
  - {c )-}
  - local treat_cols`j' ""
  = local treat_colsoverall ""
  - if "`missing'" == "cols" local treat_cols`j' `treat_cols`j'' ("`missing_`j''")
  = if "" == "cols" local treat_colsoverall  ("111")
  - if "`n_analysis'" == "cols" local treat_cols`j' ("`inanalysis_`j''")
  = if "cols" == "cols" local treat_colsoverall ("889 (88.9%)")
  - local treat_cols`j' `treat_cols`j'' `su_`j''
  = local treat_colsoverall ("889 (88.9%)") ("281 (31.6%)")
  - local summaries `summaries' `treat_cols`j''
  = local summaries ("454 (89.7%)") ("145 (31.9%)") ("435 (88.1%)") ("136 (31.3%)") ("889 (88.9%)") ("281 (31.6%)")
  - {c )-}
  - post `postname' `ccol' `measure_post' ("`tab'`value_name'") `summaries' `comment'
  = post __000000   ("    White or White British") ("454 (89.7%)") ("145 (31.9%)") ("435 (88.1%)") ("136 (31.3%)") ("889 (88.9%)") ("281 (31.6%)") 
  - {c )-}
  - {c )-}
  - local row = `row' + 1
  = local row = 1 + 1
  - if "`i'" == "inan" {c -(}
  = if "3" == "inan" {c -(}
    local value_name "n included in analysis"
    {c )-}
  - else if "`i'" == "miss" {c -(}
  = else if "3" == "miss" {c -(}
    local value_name "missing"
    {c )-}
  - else {c -(}
  - if "`val_label'" != "" {c -(}
  = if "ethnicity" != "" {c -(}
  - local value_name: label `val_label' `i'
  = local value_name: label ethnicity 3
  - {c )-}
  - if "`val_label'" == "" {c -(}
  = if "ethnicity" == "" {c -(}
    local value_name `i'
    {c )-}
  - {c )-}
  - foreach j in `over_grps' {c -(}
  = foreach j in 1 0 overall {c -(}
  - if "`i'" != "inan" & "`i'" != "miss" {c -(}
  = if "3" != "inan" & "3" != "miss" {c -(}
  - if "`j'" == "overall" qui count if `v' == `i'
  = if "1" == "overall" qui count if ethnicity == 3
  - if "`j'" != "overall" qui count if `v' == `i' & `over' ==`j'
  = if "1" != "overall" qui count if ethnicity == 3 & treat ==1
  - local n = r(N)
  - if "`count_only'" == "" {c -(}
  = if "" == "" {c -(}
  - local percent = `n'/`N_`j''*100
  = local percent = 128/454*100
  - local per_str = string(`percent', "%12.`su_decimal'f")
  = local per_str = string(28.19383259911895, "%12.1f")
  - local per_str (`per_str'`per')
  = local per_str (28.2%)
  - {c )-}
  - local su_`j' ("`n' `per_str'")
  = local su_1 ("128 (28.2%)")
  - {c )-}
  - if "`i'" == "inan" | "`i'" == "miss" local su_`j' ("`brackets_`j''")
  = if "3" == "inan" | "3" == "miss" local su_1 ("")
  - {c )-}
  - if "`i'" != "inan" & "`i'" != "miss" {c -(}
  = if "3" != "inan" & "3" != "miss" {c -(}
  - if "`j'" == "overall" qui count if `v' == `i'
  = if "0" == "overall" qui count if ethnicity == 3
  - if "`j'" != "overall" qui count if `v' == `i' & `over' ==`j'
  = if "0" != "overall" qui count if ethnicity == 3 & treat ==0
  - local n = r(N)
  - if "`count_only'" == "" {c -(}
  = if "" == "" {c -(}
  - local percent = `n'/`N_`j''*100
  = local percent = 103/435*100
  - local per_str = string(`percent', "%12.`su_decimal'f")
  = local per_str = string(23.67816091954023, "%12.1f")
  - local per_str (`per_str'`per')
  = local per_str (23.7%)
  - {c )-}
  - local su_`j' ("`n' `per_str'")
  = local su_0 ("103 (23.7%)")
  - {c )-}
  - if "`i'" == "inan" | "`i'" == "miss" local su_`j' ("`brackets_`j''")
  = if "3" == "inan" | "3" == "miss" local su_0 ("")
  - {c )-}
  - if "`i'" != "inan" & "`i'" != "miss" {c -(}
  = if "3" != "inan" & "3" != "miss" {c -(}
  - if "`j'" == "overall" qui count if `v' == `i'
  = if "overall" == "overall" qui count if ethnicity == 3
  - if "`j'" != "overall" qui count if `v' == `i' & `over' ==`j'
  = if "overall" != "overall" qui count if ethnicity == 3 & treat ==overall
  - local n = r(N)
  - if "`count_only'" == "" {c -(}
  = if "" == "" {c -(}
  - local percent = `n'/`N_`j''*100
  = local percent = 231/889*100
  - local per_str = string(`percent', "%12.`su_decimal'f")
  = local per_str = string(25.98425196850393, "%12.1f")
  - local per_str (`per_str'`per')
  = local per_str (26.0%)
  - {c )-}
  - local su_`j' ("`n' `per_str'")
  = local su_overall ("231 (26.0%)")
  - {c )-}
  - if "`i'" == "inan" | "`i'" == "miss" local su_`j' ("`brackets_`j''")
  = if "3" == "inan" | "3" == "miss" local su_overall ("")
  - {c )-}
  - if "`su_label'" == "col" local measure_post ("")
  = if "append" == "col" local measure_post ("")
  - local tab "`tab1'"
  = local tab "    "
  - if "`cat_col'" != "" {c -(}
  = if "" != "" {c -(}
    if `row' == 1 {c -(}
    local ccol `var_label'
    if "`su_label'" == "col" local measure_post ("`measure1'")
    {c )-}
    if `row' > 1 local ccol ("")
    local tab ""
    {c )-}
  - if "`order'" == "group_sum" {c -(}
  = if "group_treat" == "group_sum" {c -(}
    local summaries ""
    local miss_cols ""
    local inan_cols ""
    foreach j in `over_grps' {c -(}
    local summaries `summaries' `su_`j''
    if "`missing'" == "cols" local miss_cols `miss_cols' ("`missing_`j''")
    if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("`inanalysis_`j''")
    {c )-}
    if "`sum_cols_first'" == "" {c -(}
    post `postname' `ccol' `measure_post' ("`tab'`value_name'") `inan_cols' `miss_cols' `summaries' `comment'
    {c )-}
    else {c -(}
    post `postname' `ccol' `measure_post' ("`tab'`value_name'") `summaries' `inan_cols' `miss_cols' `comment'
    {c )-}
    {c )-}
  - if "`order'" == "group_treat" {c -(}
  = if "group_treat" == "group_treat" {c -(}
  - local summaries ""
  - foreach j in `over_grps' {c -(}
  = foreach j in 1 0 overall {c -(}
  - local treat_cols`j' ""
  = local treat_cols1 ""
  - if "`missing'" == "cols" local treat_cols`j' `treat_cols`j'' ("`missing_`j''")
  = if "" == "cols" local treat_cols1  ("52")
  - if "`n_analysis'" == "cols" local treat_cols`j' ("`inanalysis_`j''")
  = if "cols" == "cols" local treat_cols1 ("454 (89.7%)")
  - local treat_cols`j' `treat_cols`j'' `su_`j''
  = local treat_cols1 ("454 (89.7%)") ("128 (28.2%)")
  - local summaries `summaries' `treat_cols`j''
  = local summaries  ("454 (89.7%)") ("128 (28.2%)")
  - {c )-}
  - local treat_cols`j' ""
  = local treat_cols0 ""
  - if "`missing'" == "cols" local treat_cols`j' `treat_cols`j'' ("`missing_`j''")
  = if "" == "cols" local treat_cols0  ("59")
  - if "`n_analysis'" == "cols" local treat_cols`j' ("`inanalysis_`j''")
  = if "cols" == "cols" local treat_cols0 ("435 (88.1%)")
  - local treat_cols`j' `treat_cols`j'' `su_`j''
  = local treat_cols0 ("435 (88.1%)") ("103 (23.7%)")
  - local summaries `summaries' `treat_cols`j''
  = local summaries ("454 (89.7%)") ("128 (28.2%)") ("435 (88.1%)") ("103 (23.7%)")
  - {c )-}
  - local treat_cols`j' ""
  = local treat_colsoverall ""
  - if "`missing'" == "cols" local treat_cols`j' `treat_cols`j'' ("`missing_`j''")
  = if "" == "cols" local treat_colsoverall  ("111")
  - if "`n_analysis'" == "cols" local treat_cols`j' ("`inanalysis_`j''")
  = if "cols" == "cols" local treat_colsoverall ("889 (88.9%)")
  - local treat_cols`j' `treat_cols`j'' `su_`j''
  = local treat_colsoverall ("889 (88.9%)") ("231 (26.0%)")
  - local summaries `summaries' `treat_cols`j''
  = local summaries ("454 (89.7%)") ("128 (28.2%)") ("435 (88.1%)") ("103 (23.7%)") ("889 (88.9%)") ("231 (26.0%)")
  - {c )-}
  - post `postname' `ccol' `measure_post' ("`tab'`value_name'") `summaries' `comment'
  = post __000000   ("    Black or Black British") ("454 (89.7%)") ("128 (28.2%)") ("435 (88.1%)") ("103 (23.7%)") ("889 (88.9%)") ("231 (26.0%)") 
  - {c )-}
  - {c )-}
  - local row = `row' + 1
  = local row = 2 + 1
  - if "`i'" == "inan" {c -(}
  = if "2" == "inan" {c -(}
    local value_name "n included in analysis"
    {c )-}
  - else if "`i'" == "miss" {c -(}
  = else if "2" == "miss" {c -(}
    local value_name "missing"
    {c )-}
  - else {c -(}
  - if "`val_label'" != "" {c -(}
  = if "ethnicity" != "" {c -(}
  - local value_name: label `val_label' `i'
  = local value_name: label ethnicity 2
  - {c )-}
  - if "`val_label'" == "" {c -(}
  = if "ethnicity" == "" {c -(}
    local value_name `i'
    {c )-}
  - {c )-}
  - foreach j in `over_grps' {c -(}
  = foreach j in 1 0 overall {c -(}
  - if "`i'" != "inan" & "`i'" != "miss" {c -(}
  = if "2" != "inan" & "2" != "miss" {c -(}
  - if "`j'" == "overall" qui count if `v' == `i'
  = if "1" == "overall" qui count if ethnicity == 2
  - if "`j'" != "overall" qui count if `v' == `i' & `over' ==`j'
  = if "1" != "overall" qui count if ethnicity == 2 & treat ==1
  - local n = r(N)
  - if "`count_only'" == "" {c -(}
  = if "" == "" {c -(}
  - local percent = `n'/`N_`j''*100
  = local percent = 101/454*100
  - local per_str = string(`percent', "%12.`su_decimal'f")
  = local per_str = string(22.24669603524229, "%12.1f")
  - local per_str (`per_str'`per')
  = local per_str (22.2%)
  - {c )-}
  - local su_`j' ("`n' `per_str'")
  = local su_1 ("101 (22.2%)")
  - {c )-}
  - if "`i'" == "inan" | "`i'" == "miss" local su_`j' ("`brackets_`j''")
  = if "2" == "inan" | "2" == "miss" local su_1 ("")
  - {c )-}
  - if "`i'" != "inan" & "`i'" != "miss" {c -(}
  = if "2" != "inan" & "2" != "miss" {c -(}
  - if "`j'" == "overall" qui count if `v' == `i'
  = if "0" == "overall" qui count if ethnicity == 2
  - if "`j'" != "overall" qui count if `v' == `i' & `over' ==`j'
  = if "0" != "overall" qui count if ethnicity == 2 & treat ==0
  - local n = r(N)
  - if "`count_only'" == "" {c -(}
  = if "" == "" {c -(}
  - local percent = `n'/`N_`j''*100
  = local percent = 100/435*100
  - local per_str = string(`percent', "%12.`su_decimal'f")
  = local per_str = string(22.98850574712644, "%12.1f")
  - local per_str (`per_str'`per')
  = local per_str (23.0%)
  - {c )-}
  - local su_`j' ("`n' `per_str'")
  = local su_0 ("100 (23.0%)")
  - {c )-}
  - if "`i'" == "inan" | "`i'" == "miss" local su_`j' ("`brackets_`j''")
  = if "2" == "inan" | "2" == "miss" local su_0 ("")
  - {c )-}
  - if "`i'" != "inan" & "`i'" != "miss" {c -(}
  = if "2" != "inan" & "2" != "miss" {c -(}
  - if "`j'" == "overall" qui count if `v' == `i'
  = if "overall" == "overall" qui count if ethnicity == 2
  - if "`j'" != "overall" qui count if `v' == `i' & `over' ==`j'
  = if "overall" != "overall" qui count if ethnicity == 2 & treat ==overall
  - local n = r(N)
  - if "`count_only'" == "" {c -(}
  = if "" == "" {c -(}
  - local percent = `n'/`N_`j''*100
  = local percent = 201/889*100
  - local per_str = string(`percent', "%12.`su_decimal'f")
  = local per_str = string(22.60967379077615, "%12.1f")
  - local per_str (`per_str'`per')
  = local per_str (22.6%)
  - {c )-}
  - local su_`j' ("`n' `per_str'")
  = local su_overall ("201 (22.6%)")
  - {c )-}
  - if "`i'" == "inan" | "`i'" == "miss" local su_`j' ("`brackets_`j''")
  = if "2" == "inan" | "2" == "miss" local su_overall ("")
  - {c )-}
  - if "`su_label'" == "col" local measure_post ("")
  = if "append" == "col" local measure_post ("")
  - local tab "`tab1'"
  = local tab "    "
  - if "`cat_col'" != "" {c -(}
  = if "" != "" {c -(}
    if `row' == 1 {c -(}
    local ccol `var_label'
    if "`su_label'" == "col" local measure_post ("`measure1'")
    {c )-}
    if `row' > 1 local ccol ("")
    local tab ""
    {c )-}
  - if "`order'" == "group_sum" {c -(}
  = if "group_treat" == "group_sum" {c -(}
    local summaries ""
    local miss_cols ""
    local inan_cols ""
    foreach j in `over_grps' {c -(}
    local summaries `summaries' `su_`j''
    if "`missing'" == "cols" local miss_cols `miss_cols' ("`missing_`j''")
    if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("`inanalysis_`j''")
    {c )-}
    if "`sum_cols_first'" == "" {c -(}
    post `postname' `ccol' `measure_post' ("`tab'`value_name'") `inan_cols' `miss_cols' `summaries' `comment'
    {c )-}
    else {c -(}
    post `postname' `ccol' `measure_post' ("`tab'`value_name'") `summaries' `inan_cols' `miss_cols' `comment'
    {c )-}
    {c )-}
  - if "`order'" == "group_treat" {c -(}
  = if "group_treat" == "group_treat" {c -(}
  - local summaries ""
  - foreach j in `over_grps' {c -(}
  = foreach j in 1 0 overall {c -(}
  - local treat_cols`j' ""
  = local treat_cols1 ""
  - if "`missing'" == "cols" local treat_cols`j' `treat_cols`j'' ("`missing_`j''")
  = if "" == "cols" local treat_cols1  ("52")
  - if "`n_analysis'" == "cols" local treat_cols`j' ("`inanalysis_`j''")
  = if "cols" == "cols" local treat_cols1 ("454 (89.7%)")
  - local treat_cols`j' `treat_cols`j'' `su_`j''
  = local treat_cols1 ("454 (89.7%)") ("101 (22.2%)")
  - local summaries `summaries' `treat_cols`j''
  = local summaries  ("454 (89.7%)") ("101 (22.2%)")
  - {c )-}
  - local treat_cols`j' ""
  = local treat_cols0 ""
  - if "`missing'" == "cols" local treat_cols`j' `treat_cols`j'' ("`missing_`j''")
  = if "" == "cols" local treat_cols0  ("59")
  - if "`n_analysis'" == "cols" local treat_cols`j' ("`inanalysis_`j''")
  = if "cols" == "cols" local treat_cols0 ("435 (88.1%)")
  - local treat_cols`j' `treat_cols`j'' `su_`j''
  = local treat_cols0 ("435 (88.1%)") ("100 (23.0%)")
  - local summaries `summaries' `treat_cols`j''
  = local summaries ("454 (89.7%)") ("101 (22.2%)") ("435 (88.1%)") ("100 (23.0%)")
  - {c )-}
  - local treat_cols`j' ""
  = local treat_colsoverall ""
  - if "`missing'" == "cols" local treat_cols`j' `treat_cols`j'' ("`missing_`j''")
  = if "" == "cols" local treat_colsoverall  ("111")
  - if "`n_analysis'" == "cols" local treat_cols`j' ("`inanalysis_`j''")
  = if "cols" == "cols" local treat_colsoverall ("889 (88.9%)")
  - local treat_cols`j' `treat_cols`j'' `su_`j''
  = local treat_colsoverall ("889 (88.9%)") ("201 (22.6%)")
  - local summaries `summaries' `treat_cols`j''
  = local summaries ("454 (89.7%)") ("101 (22.2%)") ("435 (88.1%)") ("100 (23.0%)") ("889 (88.9%)") ("201 (22.6%)")
  - {c )-}
  - post `postname' `ccol' `measure_post' ("`tab'`value_name'") `summaries' `comment'
  = post __000000   ("    Asian or Asian British") ("454 (89.7%)") ("101 (22.2%)") ("435 (88.1%)") ("100 (23.0%)") ("889 (88.9%)") ("201 (22.6%)") 
  - {c )-}
  - {c )-}
  - local row = `row' + 1
  = local row = 3 + 1
  - if "`i'" == "inan" {c -(}
  = if "1" == "inan" {c -(}
    local value_name "n included in analysis"
    {c )-}
  - else if "`i'" == "miss" {c -(}
  = else if "1" == "miss" {c -(}
    local value_name "missing"
    {c )-}
  - else {c -(}
  - if "`val_label'" != "" {c -(}
  = if "ethnicity" != "" {c -(}
  - local value_name: label `val_label' `i'
  = local value_name: label ethnicity 1
  - {c )-}
  - if "`val_label'" == "" {c -(}
  = if "ethnicity" == "" {c -(}
    local value_name `i'
    {c )-}
  - {c )-}
  - foreach j in `over_grps' {c -(}
  = foreach j in 1 0 overall {c -(}
  - if "`i'" != "inan" & "`i'" != "miss" {c -(}
  = if "1" != "inan" & "1" != "miss" {c -(}
  - if "`j'" == "overall" qui count if `v' == `i'
  = if "1" == "overall" qui count if ethnicity == 1
  - if "`j'" != "overall" qui count if `v' == `i' & `over' ==`j'
  = if "1" != "overall" qui count if ethnicity == 1 & treat ==1
  - local n = r(N)
  - if "`count_only'" == "" {c -(}
  = if "" == "" {c -(}
  - local percent = `n'/`N_`j''*100
  = local percent = 61/454*100
  - local per_str = string(`percent', "%12.`su_decimal'f")
  = local per_str = string(13.43612334801762, "%12.1f")
  - local per_str (`per_str'`per')
  = local per_str (13.4%)
  - {c )-}
  - local su_`j' ("`n' `per_str'")
  = local su_1 ("61 (13.4%)")
  - {c )-}
  - if "`i'" == "inan" | "`i'" == "miss" local su_`j' ("`brackets_`j''")
  = if "1" == "inan" | "1" == "miss" local su_1 ("")
  - {c )-}
  - if "`i'" != "inan" & "`i'" != "miss" {c -(}
  = if "1" != "inan" & "1" != "miss" {c -(}
  - if "`j'" == "overall" qui count if `v' == `i'
  = if "0" == "overall" qui count if ethnicity == 1
  - if "`j'" != "overall" qui count if `v' == `i' & `over' ==`j'
  = if "0" != "overall" qui count if ethnicity == 1 & treat ==0
  - local n = r(N)
  - if "`count_only'" == "" {c -(}
  = if "" == "" {c -(}
  - local percent = `n'/`N_`j''*100
  = local percent = 70/435*100
  - local per_str = string(`percent', "%12.`su_decimal'f")
  = local per_str = string(16.09195402298851, "%12.1f")
  - local per_str (`per_str'`per')
  = local per_str (16.1%)
  - {c )-}
  - local su_`j' ("`n' `per_str'")
  = local su_0 ("70 (16.1%)")
  - {c )-}
  - if "`i'" == "inan" | "`i'" == "miss" local su_`j' ("`brackets_`j''")
  = if "1" == "inan" | "1" == "miss" local su_0 ("")
  - {c )-}
  - if "`i'" != "inan" & "`i'" != "miss" {c -(}
  = if "1" != "inan" & "1" != "miss" {c -(}
  - if "`j'" == "overall" qui count if `v' == `i'
  = if "overall" == "overall" qui count if ethnicity == 1
  - if "`j'" != "overall" qui count if `v' == `i' & `over' ==`j'
  = if "overall" != "overall" qui count if ethnicity == 1 & treat ==overall
  - local n = r(N)
  - if "`count_only'" == "" {c -(}
  = if "" == "" {c -(}
  - local percent = `n'/`N_`j''*100
  = local percent = 131/889*100
  - local per_str = string(`percent', "%12.`su_decimal'f")
  = local per_str = string(14.73565804274466, "%12.1f")
  - local per_str (`per_str'`per')
  = local per_str (14.7%)
  - {c )-}
  - local su_`j' ("`n' `per_str'")
  = local su_overall ("131 (14.7%)")
  - {c )-}
  - if "`i'" == "inan" | "`i'" == "miss" local su_`j' ("`brackets_`j''")
  = if "1" == "inan" | "1" == "miss" local su_overall ("")
  - {c )-}
  - if "`su_label'" == "col" local measure_post ("")
  = if "append" == "col" local measure_post ("")
  - local tab "`tab1'"
  = local tab "    "
  - if "`cat_col'" != "" {c -(}
  = if "" != "" {c -(}
    if `row' == 1 {c -(}
    local ccol `var_label'
    if "`su_label'" == "col" local measure_post ("`measure1'")
    {c )-}
    if `row' > 1 local ccol ("")
    local tab ""
    {c )-}
  - if "`order'" == "group_sum" {c -(}
  = if "group_treat" == "group_sum" {c -(}
    local summaries ""
    local miss_cols ""
    local inan_cols ""
    foreach j in `over_grps' {c -(}
    local summaries `summaries' `su_`j''
    if "`missing'" == "cols" local miss_cols `miss_cols' ("`missing_`j''")
    if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("`inanalysis_`j''")
    {c )-}
    if "`sum_cols_first'" == "" {c -(}
    post `postname' `ccol' `measure_post' ("`tab'`value_name'") `inan_cols' `miss_cols' `summaries' `comment'
    {c )-}
    else {c -(}
    post `postname' `ccol' `measure_post' ("`tab'`value_name'") `summaries' `inan_cols' `miss_cols' `comment'
    {c )-}
    {c )-}
  - if "`order'" == "group_treat" {c -(}
  = if "group_treat" == "group_treat" {c -(}
  - local summaries ""
  - foreach j in `over_grps' {c -(}
  = foreach j in 1 0 overall {c -(}
  - local treat_cols`j' ""
  = local treat_cols1 ""
  - if "`missing'" == "cols" local treat_cols`j' `treat_cols`j'' ("`missing_`j''")
  = if "" == "cols" local treat_cols1  ("52")
  - if "`n_analysis'" == "cols" local treat_cols`j' ("`inanalysis_`j''")
  = if "cols" == "cols" local treat_cols1 ("454 (89.7%)")
  - local treat_cols`j' `treat_cols`j'' `su_`j''
  = local treat_cols1 ("454 (89.7%)") ("61 (13.4%)")
  - local summaries `summaries' `treat_cols`j''
  = local summaries  ("454 (89.7%)") ("61 (13.4%)")
  - {c )-}
  - local treat_cols`j' ""
  = local treat_cols0 ""
  - if "`missing'" == "cols" local treat_cols`j' `treat_cols`j'' ("`missing_`j''")
  = if "" == "cols" local treat_cols0  ("59")
  - if "`n_analysis'" == "cols" local treat_cols`j' ("`inanalysis_`j''")
  = if "cols" == "cols" local treat_cols0 ("435 (88.1%)")
  - local treat_cols`j' `treat_cols`j'' `su_`j''
  = local treat_cols0 ("435 (88.1%)") ("70 (16.1%)")
  - local summaries `summaries' `treat_cols`j''
  = local summaries ("454 (89.7%)") ("61 (13.4%)") ("435 (88.1%)") ("70 (16.1%)")
  - {c )-}
  - local treat_cols`j' ""
  = local treat_colsoverall ""
  - if "`missing'" == "cols" local treat_cols`j' `treat_cols`j'' ("`missing_`j''")
  = if "" == "cols" local treat_colsoverall  ("111")
  - if "`n_analysis'" == "cols" local treat_cols`j' ("`inanalysis_`j''")
  = if "cols" == "cols" local treat_colsoverall ("889 (88.9%)")
  - local treat_cols`j' `treat_cols`j'' `su_`j''
  = local treat_colsoverall ("889 (88.9%)") ("131 (14.7%)")
  - local summaries `summaries' `treat_cols`j''
  = local summaries ("454 (89.7%)") ("61 (13.4%)") ("435 (88.1%)") ("70 (16.1%)") ("889 (88.9%)") ("131 (14.7%)")
  - {c )-}
  - post `postname' `ccol' `measure_post' ("`tab'`value_name'") `summaries' `comment'
  = post __000000   ("    Mixed") ("454 (89.7%)") ("61 (13.4%)") ("435 (88.1%)") ("70 (16.1%)") ("889 (88.9%)") ("131 (14.7%)") 
  - {c )-}
  - {c )-}
  - local row = `row' + 1
  = local row = 4 + 1
  - if "`i'" == "inan" {c -(}
  = if "0" == "inan" {c -(}
    local value_name "n included in analysis"
    {c )-}
  - else if "`i'" == "miss" {c -(}
  = else if "0" == "miss" {c -(}
    local value_name "missing"
    {c )-}
  - else {c -(}
  - if "`val_label'" != "" {c -(}
  = if "ethnicity" != "" {c -(}
  - local value_name: label `val_label' `i'
  = local value_name: label ethnicity 0
  - {c )-}
  - if "`val_label'" == "" {c -(}
  = if "ethnicity" == "" {c -(}
    local value_name `i'
    {c )-}
  - {c )-}
  - foreach j in `over_grps' {c -(}
  = foreach j in 1 0 overall {c -(}
  - if "`i'" != "inan" & "`i'" != "miss" {c -(}
  = if "0" != "inan" & "0" != "miss" {c -(}
  - if "`j'" == "overall" qui count if `v' == `i'
  = if "1" == "overall" qui count if ethnicity == 0
  - if "`j'" != "overall" qui count if `v' == `i' & `over' ==`j'
  = if "1" != "overall" qui count if ethnicity == 0 & treat ==1
  - local n = r(N)
  - if "`count_only'" == "" {c -(}
  = if "" == "" {c -(}
  - local percent = `n'/`N_`j''*100
  = local percent = 19/454*100
  - local per_str = string(`percent', "%12.`su_decimal'f")
  = local per_str = string(4.185022026431718, "%12.1f")
  - local per_str (`per_str'`per')
  = local per_str (4.2%)
  - {c )-}
  - local su_`j' ("`n' `per_str'")
  = local su_1 ("19 (4.2%)")
  - {c )-}
  - if "`i'" == "inan" | "`i'" == "miss" local su_`j' ("`brackets_`j''")
  = if "0" == "inan" | "0" == "miss" local su_1 ("")
  - {c )-}
  - if "`i'" != "inan" & "`i'" != "miss" {c -(}
  = if "0" != "inan" & "0" != "miss" {c -(}
  - if "`j'" == "overall" qui count if `v' == `i'
  = if "0" == "overall" qui count if ethnicity == 0
  - if "`j'" != "overall" qui count if `v' == `i' & `over' ==`j'
  = if "0" != "overall" qui count if ethnicity == 0 & treat ==0
  - local n = r(N)
  - if "`count_only'" == "" {c -(}
  = if "" == "" {c -(}
  - local percent = `n'/`N_`j''*100
  = local percent = 26/435*100
  - local per_str = string(`percent', "%12.`su_decimal'f")
  = local per_str = string(5.977011494252873, "%12.1f")
  - local per_str (`per_str'`per')
  = local per_str (6.0%)
  - {c )-}
  - local su_`j' ("`n' `per_str'")
  = local su_0 ("26 (6.0%)")
  - {c )-}
  - if "`i'" == "inan" | "`i'" == "miss" local su_`j' ("`brackets_`j''")
  = if "0" == "inan" | "0" == "miss" local su_0 ("")
  - {c )-}
  - if "`i'" != "inan" & "`i'" != "miss" {c -(}
  = if "0" != "inan" & "0" != "miss" {c -(}
  - if "`j'" == "overall" qui count if `v' == `i'
  = if "overall" == "overall" qui count if ethnicity == 0
  - if "`j'" != "overall" qui count if `v' == `i' & `over' ==`j'
  = if "overall" != "overall" qui count if ethnicity == 0 & treat ==overall
  - local n = r(N)
  - if "`count_only'" == "" {c -(}
  = if "" == "" {c -(}
  - local percent = `n'/`N_`j''*100
  = local percent = 45/889*100
  - local per_str = string(`percent', "%12.`su_decimal'f")
  = local per_str = string(5.061867266591676, "%12.1f")
  - local per_str (`per_str'`per')
  = local per_str (5.1%)
  - {c )-}
  - local su_`j' ("`n' `per_str'")
  = local su_overall ("45 (5.1%)")
  - {c )-}
  - if "`i'" == "inan" | "`i'" == "miss" local su_`j' ("`brackets_`j''")
  = if "0" == "inan" | "0" == "miss" local su_overall ("")
  - {c )-}
  - if "`su_label'" == "col" local measure_post ("")
  = if "append" == "col" local measure_post ("")
  - local tab "`tab1'"
  = local tab "    "
  - if "`cat_col'" != "" {c -(}
  = if "" != "" {c -(}
    if `row' == 1 {c -(}
    local ccol `var_label'
    if "`su_label'" == "col" local measure_post ("`measure1'")
    {c )-}
    if `row' > 1 local ccol ("")
    local tab ""
    {c )-}
  - if "`order'" == "group_sum" {c -(}
  = if "group_treat" == "group_sum" {c -(}
    local summaries ""
    local miss_cols ""
    local inan_cols ""
    foreach j in `over_grps' {c -(}
    local summaries `summaries' `su_`j''
    if "`missing'" == "cols" local miss_cols `miss_cols' ("`missing_`j''")
    if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("`inanalysis_`j''")
    {c )-}
    if "`sum_cols_first'" == "" {c -(}
    post `postname' `ccol' `measure_post' ("`tab'`value_name'") `inan_cols' `miss_cols' `summaries' `comment'
    {c )-}
    else {c -(}
    post `postname' `ccol' `measure_post' ("`tab'`value_name'") `summaries' `inan_cols' `miss_cols' `comment'
    {c )-}
    {c )-}
  - if "`order'" == "group_treat" {c -(}
  = if "group_treat" == "group_treat" {c -(}
  - local summaries ""
  - foreach j in `over_grps' {c -(}
  = foreach j in 1 0 overall {c -(}
  - local treat_cols`j' ""
  = local treat_cols1 ""
  - if "`missing'" == "cols" local treat_cols`j' `treat_cols`j'' ("`missing_`j''")
  = if "" == "cols" local treat_cols1  ("52")
  - if "`n_analysis'" == "cols" local treat_cols`j' ("`inanalysis_`j''")
  = if "cols" == "cols" local treat_cols1 ("454 (89.7%)")
  - local treat_cols`j' `treat_cols`j'' `su_`j''
  = local treat_cols1 ("454 (89.7%)") ("19 (4.2%)")
  - local summaries `summaries' `treat_cols`j''
  = local summaries  ("454 (89.7%)") ("19 (4.2%)")
  - {c )-}
  - local treat_cols`j' ""
  = local treat_cols0 ""
  - if "`missing'" == "cols" local treat_cols`j' `treat_cols`j'' ("`missing_`j''")
  = if "" == "cols" local treat_cols0  ("59")
  - if "`n_analysis'" == "cols" local treat_cols`j' ("`inanalysis_`j''")
  = if "cols" == "cols" local treat_cols0 ("435 (88.1%)")
  - local treat_cols`j' `treat_cols`j'' `su_`j''
  = local treat_cols0 ("435 (88.1%)") ("26 (6.0%)")
  - local summaries `summaries' `treat_cols`j''
  = local summaries ("454 (89.7%)") ("19 (4.2%)") ("435 (88.1%)") ("26 (6.0%)")
  - {c )-}
  - local treat_cols`j' ""
  = local treat_colsoverall ""
  - if "`missing'" == "cols" local treat_cols`j' `treat_cols`j'' ("`missing_`j''")
  = if "" == "cols" local treat_colsoverall  ("111")
  - if "`n_analysis'" == "cols" local treat_cols`j' ("`inanalysis_`j''")
  = if "cols" == "cols" local treat_colsoverall ("889 (88.9%)")
  - local treat_cols`j' `treat_cols`j'' `su_`j''
  = local treat_colsoverall ("889 (88.9%)") ("45 (5.1%)")
  - local summaries `summaries' `treat_cols`j''
  = local summaries ("454 (89.7%)") ("19 (4.2%)") ("435 (88.1%)") ("26 (6.0%)") ("889 (88.9%)") ("45 (5.1%)")
  - {c )-}
  - post `postname' `ccol' `measure_post' ("`tab'`value_name'") `summaries' `comment'
  = post __000000   ("    Other") ("454 (89.7%)") ("19 (4.2%)") ("435 (88.1%)") ("26 (6.0%)") ("889 (88.9%)") ("45 (5.1%)") 
  - {c )-}
  - {c )-}
  - {c )-}
  - else {c -(}
    if "`cat_col'" != "" local ccol ("")
    foreach i in `over_grps' {c -(}
    if "`type1'" == "cont" {c -(}
    di "Group `i'"
    if "`i'" == "overall" su `v'
    if "`i'" != "overall" su `v' if `over' == `i'
    local mean = string(r(mean), "%12.`su_decimal'f")
    local sd = string(r(sd), "%12.`su_decimal'f")
    local su_`i' ("`mean' (`sd') `brackets_`i''")
    {c )-}
    if "`type1'" == "bin" {c -(}
    if "`i'" == "overall" qui count if `v'==`positive'
    if "`i'" != "overall" qui count if `v'==`positive' & `over' == `i'
    scalar count_treat_positive_`i' = r(N)
    local n = count_treat_positive_`i'
    if "`count_only'" == ""{c -(}
    local percent = count_treat_positive_`i'/`N_`i''*100
    local per_str = string(`percent', "%12.`su_decimal'f")
    local per_str (`per_str'`per')
    {c )-}
    local su_`i' ("`n' `per_str' `brackets_`i''")
    {c )-}
    if "`type1'" == "skew" {c -(}
    di "Group `i'"
    if "`i'" == "overall" tabstat `v', stats(q) save
    if "`i'" != "overall" tabstat `v' if `over' == `i', stats(q) save
    mat define A = r(StatTotal)
    local median = string(A[2,1], "%12.`su_decimal'f")
    local q1 = string(A[1,1], "%12.`su_decimal'f")
    local q3 = string(A[3,1], "%12.`su_decimal'f")
    local su_`i' ("`median' (`q1'-`q3') `brackets_`i''")
    {c )-}
    {c )-}
    if "`type1'" == "bin" {c -(}
    if "`miss_opt'" == "" {c -(}
    if "`over'" != "" tab `v' `over', col
    if "`over'" == "" tab `v'
    {c )-}
    {c )-}
    if "`order'" == "group_sum" {c -(}
    local summaries ""
    foreach i in `over_grps' {c -(}
    local summaries `summaries' `su_`i''
    {c )-}
    if "`sum_cols_first'" == "" {c -(}
    post `postname' `var_label' `measure_post' `ccol' `inan_cols' `miss_cols' `summaries' `comment'
    {c )-}
    else {c -(}
    post `postname' `var_label' `measure_post' `ccol' `summaries' `inan_cols' `miss_cols' `comment'
    {c )-}
    {c )-}
    if "`order'" == "group_treat" {c -(}
    local summaries ""
    foreach i in `over_grps' {c -(}
    if "`n_analysis'" == "cols" local treat_cols`i' ("`inanalysis_`i''")
    if "`missing'" == "cols" local treat_cols`i' ("`missing_`i''")
    local treat_cols`i' `treat_cols`i'' `su_`i''
    local summaries `summaries' `treat_cols`i''
    {c )-}
    post `postname' `var_label' `measure_post' `ccol' `summaries' `comment'
    {c )-}
    {c )-}
  - local measure_post
  - if "`su_label'" == "col" local measure_post ("")
  = if "append" == "col" local measure_post ("")
  - if "`cat_col'" != "" local ccol ("")
  = if "" != "" local ccol ("")
  - local summaries ""
  - local miss_cols ""
  - local inan_cols ""
  - foreach i in `over_grps' {c -(}
  = foreach i in 1 0 overall {c -(}
  - local summaries `summaries' ("")
  = local summaries  ("")
  - if "`missing'" == "cols" local miss_cols `miss_cols' ("")
  = if "" == "cols" local miss_cols  ("")
  - if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("")
  = if "cols" == "cols" local inan_cols  ("")
  - {c )-}
  - local summaries `summaries' ("")
  = local summaries ("") ("")
  - if "`missing'" == "cols" local miss_cols `miss_cols' ("")
  = if "" == "cols" local miss_cols  ("")
  - if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("")
  = if "cols" == "cols" local inan_cols ("") ("")
  - {c )-}
  - local summaries `summaries' ("")
  = local summaries ("") ("") ("")
  - if "`missing'" == "cols" local miss_cols `miss_cols' ("")
  = if "" == "cols" local miss_cols  ("")
  - if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("")
  = if "cols" == "cols" local inan_cols ("") ("") ("")
  - {c )-}
  - if "`comment'" != "" local comment ("")
  = if "" != "" local comment ("")
  - if `gap' > 0 {c -(}
  = if 1 > 0 {c -(}
  - forvalues i = 1 (1) `gap' {c -(}
  = forvalues i = 1 (1) 1 {c -(}
  - post `postname' ("") `measure_post' `ccol' `inan_cols' `miss_cols' `summaries' `comment'
  = post __000000 ("")   ("") ("") ("")  ("") ("") ("") 
  - {c )-}
  - {c )-}
  - {c )-}
  - if `gap_end' > 0 {c -(}
  = if 0 > 0 {c -(}
    forvalues i = 1 (1) `gap_end' {c -(}
    post `postname' ("") `measure_post' `ccol' `inan_cols' `miss_cols' `summaries' `comment'
    {c )-}
    {c )-}
  - if "`if'" != "" restore
  = if "" != "" restore
  {hline 88} end pt_base {hline}

{com}. 
. 
. pt_base_close `postname', eg_no(`eg_no')        
{txt}  {hline 80} begin pt_base_close {hline}
  - syntax namelist, eg_no(numlist max=1)
  - postclose `namelist'
  = postclose __000000
  - use "ptb_eg`eg_no'.dta", clear
  = use "ptb_eg5.4.dta", clear
  - format _all %-100s
  - qui compress _all
  - qui log close
{smcl}
{txt}{sf}{ul off}