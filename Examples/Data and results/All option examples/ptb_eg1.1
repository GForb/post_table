{smcl}
{txt}{sf}{ul off}{.-}
      name:  {res}<unnamed>
       {txt}log:  {res}N:\Automating reporting\Git repository\post_table\Examples\Data and results\All option examples\ptb_eg1.1
  {txt}log type:  {res}smcl
 {txt}opened on:  {res}18 Mar 2019, 10:00:46
  {txt}- use eg_data2, clear
  - local results ptb_eg`eg_no'
  = local results ptb_eg1.1
  - tempname postname
  - forvalues i = 1 (1) `cols' {c -(}
  = forvalues i = 1 (1) 2 {c -(}
  - local post_cols `post_cols' col`i'
  = local post_cols  col1
  - {c )-}
  - local post_cols `post_cols' col`i'
  = local post_cols col1 col2
  - {c )-}
  - postfile `namelist' str100(`post_cols') using "`results'.dta", replace
  = postfile __000000 str100(col1 col2) using "ptb_eg1.1.dta", replace
  {hline 82} end pt_base_intro {hline}

{com}. 
. pt_base age gender ethnicity, post(`postname')
{txt}  {hline 86} begin pt_base {hline}
  - syntax varlist(numeric) [if], POSTname(string) [ Type(string) count_only over(varname) over_grps(numlist) overall(string) cat_levels(numlist) cat_col cat_tabs(integer 1) gap(integer 0) gap_end(integer 0) decimal(integer 1) miss_decimal(integer 1) su_decimal(integer 1) positive(integer 1) Missing(string) N_analysis(string) order(string) sum_cols_first su_label(string) su_label_text(string) append_label(string) var_lab(string) per comment(string) ]
  - if "`if'" != "" {c -(}
  = if "" != "" {c -(}
    preserve
    keep `if'
    {c )-}
  - if `su_decimal' ==1 local su_decimal = `decimal'
  = if 1 ==1 local su_decimal = 1
  - if `miss_decimal' ==1 local est_decimal = `decimal'
  = if 1 ==1 local est_decimal = 1
  - if "`over'" != "" {c -(}
  = if "" != "" {c -(}
    if "`over_grps'" == "" levelsof `over', local(over_grps)
    if "`overall'" == "first" local over_grps overall `over_grps'
    if "`overall'" == "last" local over_grps `over_grps' overall
    {c )-}
  - if "`over'" == "" local over_grps overall
  = if "" == "" local over_grps overall
  - if "`order'" == "" local order group_sum
  = if "" == "" local order group_sum
  - if "`per'" != "" local per %
  = if "" != "" local per %
  - if "`comment'" != "" & "`comment'" != "no comment" local comment ("`comment'")
  = if "" != "" & "" != "no comment" local comment ("")
  - if "`comment'" == "no comment" local comment ("")
  = if "" == "no comment" local comment ("")
  - if "`type'" == "misstable" {c -(}
  = if "" == "misstable" {c -(}
    local type bin
    local positive .
    local miss_opt missing
    {c )-}
  - foreach w in `missing' {c -(}
  = foreach w in  {c -(}
    if "`w'" == "brackets" local missing brackets
    if "`w'" == "cols" local missing cols
    if "`w'" == "%" local miss_per miss_per
    if "`w'" == "cond" local cond cond
    {c )-}
  - foreach w in `n_analysis' {c -(}
  = foreach w in  {c -(}
    if "`w'" == "brackets" local n_analysis brackets
    if "`w'" == "append" local n_analysis append
    if "`w'" == "cols" local n_analysis cols
    if "`w'" == "%" local n_analysis_per n_analysis_per
    if "`w'" == "cond" local cond cond
    {c )-}
  - forvalues t = 1 (1) `cat_tabs' {c -(}
  = forvalues t = 1 (1) 1 {c -(}
  - local tab1 = "`tab1'    "
  = local tab1 = "    "
  - {c )-}
  - foreach v in `varlist' {c -(}
  = foreach v in age gender ethnicity {c -(}
  - di as result _newline(3) "****** `v' ******" _newline(1)
  = di as result _newline(3) "****** age ******" _newline(1)



{res}****** age ******

  {txt}- display as text %26s "Group {c -(}c |{c )-}" as text %19s "N obs. Percent" %24s "N missing Percent"
               Group {c |}     N obs. Percent       N missing Percent
  - di as text "{c -(}hline 21{c )-}{c -(}c +{c )-}{c -(}hline 43{c )-}"
{hline 21}{c +}{hline 43}
  - local type1 = "`type'"
  = local type1 = ""
  - if "`type1'" == "" {c -(}
  = if "" == "" {c -(}
  - qui inspect `v'
  = qui inspect age
  - if r(N_unique) < 3 {c -(}
    local type1 = "bin"
    {c )-}
  - else if r(N_unique) < 10 {c -(}
    local type1 = "cat"
    {c )-}
  - else if r(N_unique) >= 10 | r(N_unique) ==. {c -(}
  - local type1 = "cont"
  - {c )-}
  - {c )-}
  - qui count if missing(`v')
  = qui count if missing(age)
  - local miss_overall = r(N)
  - local var_label `var_lab'
  = local var_label 
  - if "`var_lab'" == "" local var_label:variable label `v'
  = if "" == "" local var_label:variable label age
  - if "`var_label'" == "" local var_label = "`v'"
  = if "Age" == "" local var_label = "age"
  - local var_label `var_label' `append_label'
  = local var_label Age 
  - if "`type1'" == "cont" local measure1 "mean (sd)"
  = if "cont" == "cont" local measure1 "mean (sd)"
  - if "`type1'" == "bin" | "`type1'" == "cat" {c -(}
  = if "cont" == "bin" | "cont" == "cat" {c -(}
    local measure1 "n (%)"
    if "`count_only'" != "" local measure1 "n"
    {c )-}
  - if "`type1'" == "skew" local measure1 "median (IQR)"
  = if "cont" == "skew" local measure1 "median (IQR)"
  - if "`missing'" == "brackets" local measure1 "`measure1' [missing]"
  = if "" == "brackets" local measure1 "mean (sd) [missing]"
  - if "`n_analysis'" == "brackets" local measure1 "`measure1' [n included in analysis]"
  = if "" == "brackets" local measure1 "mean (sd) [n included in analysis]"
  - if "`su_label_text'" != "" local measure1 `su_label_text'
  = if "" != "" local measure1 
  - if "`su_label'" == "append" local measure_append =" - `measure1'"
  = if "" == "append" local measure_append =" - mean (sd)"
  - local N_append ""
  - if "`n_analysis'" == "append" & ("`cond'" =="" | `miss_overall' > 0) {c -(}
  = if "" == "append" & ("" =="" | 0 > 0) {c -(}
    qui count if missing(`v') ==0
    local N = r(N)
    local N_append (N = `N')
    {c )-}
  - local var_label ("`var_label'`measure_append' `N_append'")
  = local var_label ("Age ")
  - local measure_post
  - if "`su_label'" == "col" local measure_post ("`measure1'")
  = if "" == "col" local measure_post ("mean (sd)")
  - local miss_cols ""
  - local inan_cols ""
  - foreach i in `over_grps' {c -(}
  = foreach i in overall {c -(}
  - if "`i'" == "overall" {c -(}
  = if "overall" == "overall" {c -(}
  - qui count
  - local N_data = r(N)
  - qui count if !missing(`v')
  = qui count if !missing(age)
  - local N_`i' = r(N)
  = local N_overall = r(N)
  - qui count if missing(`v')
  = qui count if missing(age)
  - local n_missing_`i' = r(N)
  = local n_missing_overall = r(N)
  - {c )-}
  - else {c -(}
    qui count if `over' == `i'
    local N_data = r(N)
    qui count if `over' == `i' & !missing(`v')
    local N_`i' = r(N)
    qui count if missing(`v') & `over'==`i'
    local n_missing_`i' = r(N)
    {c )-}
  - local n_inanalysis_per_`i' = `N_`i''/`N_data' *100
  = local n_inanalysis_per_overall = 1000/1000 *100
  - local in_per_`i' = string(`n_inanalysis_per_`i'', "%12.`miss_decimal'f")
  = local in_per_overall = string(100, "%12.1f")
  - local inanalysis_`i' = `N_`i''
  = local inanalysis_overall = 1000
  - if "`n_analysis_per'" != "" local inanalysis_`i' `N_`i'' (`in_per_`i''`per')
  = if "" != "" local inanalysis_overall 1000 (100.0)
  - local n_missing_per_`i' = `n_missing_`i''/`N_data'*100
  = local n_missing_per_overall = 0/1000*100
  - local miss_per_`i' = string(`n_missing_per_`i'', "%12.`miss_decimal'f")
  = local miss_per_overall = string(0, "%12.1f")
  - local missing_`i' = `n_missing_`i''
  = local missing_overall = 0
  - if "`miss_per'" != "" local missing_`i' `n_missing_`i'' (`miss_per_`i''`per')
  = if "" != "" local missing_overall 0 (0.0)
  - display as text %20s abbrev("`i'",20) " {c -(}c |{c )-}" as result %9.0g `N_`i'' " " %9.0g `n_inanalysis_per_`i'' %14.0g `n_missing_`i'' " " %9.0g `n_missing_per_`i''
  = display as text %20s abbrev("overall",20) " {c -(}c |{c )-}" as result %9.0g 1000 " " %9.0g 100 %14.0g 0 " " %9.0g 0
             overall {c |}{res}     1000       100             0         0
  {txt}- local brackets_`i' ""
  = local brackets_overall ""
  - if "`cond'" == "" | ("`cond'" == "cond" & `miss_overall' != 0) {c -(}
  = if "" == "" | ("" == "cond" & 0 != 0) {c -(}
  - if "`missing'" == "cols" local miss_cols `miss_cols' ("`missing_`i''")
  = if "" == "cols" local miss_cols  ("0")
  - if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("`inanalysis_`i''")
  = if "" == "cols" local inan_cols  ("1000")
  - local brackets_`i'
  = local brackets_overall
  - if "`missing'" == "brackets" local brackets_`i' "[`missing_`i'']"
  = if "" == "brackets" local brackets_overall "[0]"
  - if "`n_analysis'" == "brackets" local brackets_`i' "[`inanalysis_`i'']"
  = if "" == "brackets" local brackets_overall "[1000]"
  - {c )-}
  - if "`cond'" == "cond" & `miss_overall' == 0 {c -(}
  = if "" == "cond" & 0 == 0 {c -(}
    if "`missing'" == "cols" local miss_cols `miss_cols' ("")
    if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("")
    {c )-}
  - {c )-}
  - di as text "{c -(}hline 21{c )-}{c -(}c BT{c )-}{c -(}hline 43{c )-}"
{hline 21}{c BT}{hline 43}
  - if "`type1'" == "cat" {c -(}
  = if "cont" == "cat" {c -(}
    if "`cat_col'" == "" {c -(}
    if "`order'" == "group_sum" {c -(}
    local summaries ""
    foreach i in `over_grps' {c -(}
    local summaries `summaries' ("")
    {c )-}
    if "`sum_cols_first'" == "" {c -(}
    post `postname' `var_label' `measure_post' `miss_cols' `inan_cols' `summaries' `comment'
    {c )-}
    else {c -(}
    post `postname' `var_label' `measure_post' `summaries' `miss_cols' `inan_cols' `comment'
    {c )-}
    {c )-}
    if "`order'" == "group_treat" {c -(}
    local summaries ""
    foreach i in `over_grps' {c -(}
    if "`n_analysis'" == "cols" local treat_cols`i' ("`inanalysis_`i''")
    if "`missing'" == "cols" local treat_cols`i' ("`missing_`i''")
    local summaries `summaries' `treat_cols`i''
    {c )-}
    post `postname' `var_label' `measure_post' `summaries' `comment'
    {c )-}
    {c )-}
    if "`over'" != "" tab `v' `over', col `miss_opt'
    if "`over'" == "" tab `v', `miss_opt'
    local val_label: value label `v'
    local levels "`cat_levels'"
    if "`levels'" == "" qui levelsof `v', local(levels)
    if "`missing'" == "brackets" local levels `levels' miss
    if "`n_analysis'" == "brackets" local levels `levels' inan
    local row = 0
    foreach i in `levels' {c -(}
    local row = `row' + 1
    if "`i'" == "inan" {c -(}
    local value_name "n included in analysis"
    {c )-}
    else if "`i'" == "miss" {c -(}
    local value_name "missing"
    {c )-}
    else {c -(}
    if "`val_label'" != "" {c -(}
    local value_name: label `val_label' `i'
    {c )-}
    if "`val_label'" == "" {c -(}
    local value_name `i'
    {c )-}
    {c )-}
    foreach j in `over_grps' {c -(}
    if "`i'" != "inan" & "`i'" != "miss" {c -(}
    if "`j'" == "overall" qui count if `v' == `i'
    if "`j'" != "overall" qui count if `v' == `i' & `over' ==`j'
    local n = r(N)
    if "`count_only'" == "" {c -(}
    local percent = `n'/`N_`j''*100
    local per_str = string(`percent', "%12.`su_decimal'f")
    local per_str (`per_str'`per')
    {c )-}
    local su_`j' ("`n' `per_str'")
    {c )-}
    if "`i'" == "inan" | "`i'" == "miss" local su_`j' ("`brackets_`j''")
    {c )-}
    if "`su_label'" == "col" local measure_post ("")
    local tab "`tab1'"
    if "`cat_col'" != "" {c -(}
    if `row' == 1 {c -(}
    local ccol `var_label'
    if "`su_label'" == "col" local measure_post ("`measure1'")
    {c )-}
    if `row' > 1 local ccol ("")
    local tab ""
    {c )-}
    if "`order'" == "group_sum" {c -(}
    local summaries ""
    local miss_cols ""
    local inan_cols ""
    foreach j in `over_grps' {c -(}
    local summaries `summaries' `su_`j''
    if "`missing'" == "cols" local miss_cols `miss_cols' ("`missing_`j''")
    if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("`inanalysis_`j''")
    {c )-}
    if "`sum_cols_first'" == "" {c -(}
    post `postname' `ccol' `measure_post' ("`tab'`value_name'") `inan_cols' `miss_cols' `summaries' `comment'
    {c )-}
    else {c -(}
    post `postname' `ccol' `measure_post' ("`tab'`value_name'") `summaries' `inan_cols' `miss_cols' `comment'
    {c )-}
    {c )-}
    if "`order'" == "group_treat" {c -(}
    local summaries ""
    foreach j in `over_grps' {c -(}
    local treat_cols`j' ""
    if "`missing'" == "cols" local treat_cols`j' `treat_cols`j'' ("`missing_`j''")
    if "`n_analysis'" == "cols" local treat_cols`j' ("`inanalysis_`j''")
    local treat_cols`j' `treat_cols`j'' `su_`j''
    local summaries `summaries' `treat_cols`j''
    {c )-}
    post `postname' `ccol' `measure_post' ("`tab'`value_name'") `summaries' `comment'
    {c )-}
    {c )-}
    {c )-}
  - else {c -(}
  - if "`cat_col'" != "" local ccol ("")
  = if "" != "" local ccol ("")
  - foreach i in `over_grps' {c -(}
  = foreach i in overall {c -(}
  - if "`type1'" == "cont" {c -(}
  = if "cont" == "cont" {c -(}
  - di "Group `i'"
  = di "Group overall"
Group overall
  - if "`i'" == "overall" su `v'
  = if "overall" == "overall" su age

    Variable {c |}        Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 57}
{space 9}age {c |}{res}      1,000    44.75141    10.09038   18.73607   79.98365
  {txt}- if "`i'" != "overall" su `v' if `over' == `i'
  = if "overall" != "overall" su age if  == overall
  - local mean = string(r(mean), "%12.`su_decimal'f")
  = local mean = string(r(mean), "%12.1f")
  - local sd = string(r(sd), "%12.`su_decimal'f")
  = local sd = string(r(sd), "%12.1f")
  - local su_`i' ("`mean' (`sd') `brackets_`i''")
  = local su_overall ("44.8 (10.1) ")
  - {c )-}
  - if "`type1'" == "bin" {c -(}
  = if "cont" == "bin" {c -(}
    if "`i'" == "overall" qui count if `v'==`positive'
    if "`i'" != "overall" qui count if `v'==`positive' & `over' == `i'
    scalar count_treat_positive_`i' = r(N)
    local n = count_treat_positive_`i'
    if "`count_only'" == ""{c -(}
    local percent = count_treat_positive_`i'/`N_`i''*100
    local per_str = string(`percent', "%12.`su_decimal'f")
    local per_str (`per_str'`per')
    {c )-}
    local su_`i' ("`n' `per_str' `brackets_`i''")
    {c )-}
  - if "`type1'" == "skew" {c -(}
  = if "cont" == "skew" {c -(}
    di "Group `i'"
    if "`i'" == "overall" tabstat `v', stats(q) save
    if "`i'" != "overall" tabstat `v' if `over' == `i', stats(q) save
    mat define A = r(StatTotal)
    local median = string(A[2,1], "%12.`su_decimal'f")
    local q1 = string(A[1,1], "%12.`su_decimal'f")
    local q3 = string(A[3,1], "%12.`su_decimal'f")
    local su_`i' ("`median' (`q1'-`q3') `brackets_`i''")
    {c )-}
  - {c )-}
  - if "`type1'" == "bin" {c -(}
  = if "cont" == "bin" {c -(}
    if "`miss_opt'" == "" {c -(}
    if "`over'" != "" tab `v' `over', col
    if "`over'" == "" tab `v'
    {c )-}
    {c )-}
  - if "`order'" == "group_sum" {c -(}
  = if "group_sum" == "group_sum" {c -(}
  - local summaries ""
  - foreach i in `over_grps' {c -(}
  = foreach i in overall {c -(}
  - local summaries `summaries' `su_`i''
  = local summaries  ("44.8 (10.1) ")
  - {c )-}
  - if "`sum_cols_first'" == "" {c -(}
  = if "" == "" {c -(}
  - post `postname' `var_label' `measure_post' `ccol' `inan_cols' `miss_cols' `summaries' `comment'
  = post __000000 ("Age ")     ("44.8 (10.1) ") 
  - {c )-}
  - else {c -(}
    post `postname' `var_label' `measure_post' `ccol' `summaries' `inan_cols' `miss_cols' `comment'
    {c )-}
  - {c )-}
  - if "`order'" == "group_treat" {c -(}
  = if "group_sum" == "group_treat" {c -(}
    local summaries ""
    foreach i in `over_grps' {c -(}
    if "`n_analysis'" == "cols" local treat_cols`i' ("`inanalysis_`i''")
    if "`missing'" == "cols" local treat_cols`i' ("`missing_`i''")
    local treat_cols`i' `treat_cols`i'' `su_`i''
    local summaries `summaries' `treat_cols`i''
    {c )-}
    post `postname' `var_label' `measure_post' `ccol' `summaries' `comment'
    {c )-}
  - {c )-}
  - local measure_post
  - if "`su_label'" == "col" local measure_post ("")
  = if "" == "col" local measure_post ("")
  - if "`cat_col'" != "" local ccol ("")
  = if "" != "" local ccol ("")
  - local summaries ""
  - local miss_cols ""
  - local inan_cols ""
  - foreach i in `over_grps' {c -(}
  = foreach i in overall {c -(}
  - local summaries `summaries' ("")
  = local summaries  ("")
  - if "`missing'" == "cols" local miss_cols `miss_cols' ("")
  = if "" == "cols" local miss_cols  ("")
  - if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("")
  = if "" == "cols" local inan_cols  ("")
  - {c )-}
  - if "`comment'" != "" local comment ("")
  = if "" != "" local comment ("")
  - if `gap' > 0 {c -(}
  = if 0 > 0 {c -(}
    forvalues i = 1 (1) `gap' {c -(}
    post `postname' ("") `measure_post' `ccol' `inan_cols' `miss_cols' `summaries' `comment'
    {c )-}
    {c )-}
  - {c )-}
  - di as result _newline(3) "****** `v' ******" _newline(1)
  = di as result _newline(3) "****** gender ******" _newline(1)



{res}****** gender ******

  {txt}- display as text %26s "Group {c -(}c |{c )-}" as text %19s "N obs. Percent" %24s "N missing Percent"
               Group {c |}     N obs. Percent       N missing Percent
  - di as text "{c -(}hline 21{c )-}{c -(}c +{c )-}{c -(}hline 43{c )-}"
{hline 21}{c +}{hline 43}
  - local type1 = "`type'"
  = local type1 = ""
  - if "`type1'" == "" {c -(}
  = if "" == "" {c -(}
  - qui inspect `v'
  = qui inspect gender
  - if r(N_unique) < 3 {c -(}
  - local type1 = "bin"
  - {c )-}
  - else if r(N_unique) < 10 {c -(}
    local type1 = "cat"
    {c )-}
  - else if r(N_unique) >= 10 | r(N_unique) ==. {c -(}
    local type1 = "cont"
    {c )-}
  - {c )-}
  - qui count if missing(`v')
  = qui count if missing(gender)
  - local miss_overall = r(N)
  - local var_label `var_lab'
  = local var_label 
  - if "`var_lab'" == "" local var_label:variable label `v'
  = if "" == "" local var_label:variable label gender
  - if "`var_label'" == "" local var_label = "`v'"
  = if "Female" == "" local var_label = "gender"
  - local var_label `var_label' `append_label'
  = local var_label Female 
  - if "`type1'" == "cont" local measure1 "mean (sd)"
  = if "bin" == "cont" local measure1 "mean (sd)"
  - if "`type1'" == "bin" | "`type1'" == "cat" {c -(}
  = if "bin" == "bin" | "bin" == "cat" {c -(}
  - local measure1 "n (%)"
  - if "`count_only'" != "" local measure1 "n"
  = if "" != "" local measure1 "n"
  - {c )-}
  - if "`type1'" == "skew" local measure1 "median (IQR)"
  = if "bin" == "skew" local measure1 "median (IQR)"
  - if "`missing'" == "brackets" local measure1 "`measure1' [missing]"
  = if "" == "brackets" local measure1 "n (%) [missing]"
  - if "`n_analysis'" == "brackets" local measure1 "`measure1' [n included in analysis]"
  = if "" == "brackets" local measure1 "n (%) [n included in analysis]"
  - if "`su_label_text'" != "" local measure1 `su_label_text'
  = if "" != "" local measure1 
  - if "`su_label'" == "append" local measure_append =" - `measure1'"
  = if "" == "append" local measure_append =" - n (%)"
  - local N_append ""
  - if "`n_analysis'" == "append" & ("`cond'" =="" | `miss_overall' > 0) {c -(}
  = if "" == "append" & ("" =="" | 0 > 0) {c -(}
    qui count if missing(`v') ==0
    local N = r(N)
    local N_append (N = `N')
    {c )-}
  - local var_label ("`var_label'`measure_append' `N_append'")
  = local var_label ("Female ")
  - local measure_post
  - if "`su_label'" == "col" local measure_post ("`measure1'")
  = if "" == "col" local measure_post ("n (%)")
  - local miss_cols ""
  - local inan_cols ""
  - foreach i in `over_grps' {c -(}
  = foreach i in overall {c -(}
  - if "`i'" == "overall" {c -(}
  = if "overall" == "overall" {c -(}
  - qui count
  - local N_data = r(N)
  - qui count if !missing(`v')
  = qui count if !missing(gender)
  - local N_`i' = r(N)
  = local N_overall = r(N)
  - qui count if missing(`v')
  = qui count if missing(gender)
  - local n_missing_`i' = r(N)
  = local n_missing_overall = r(N)
  - {c )-}
  - else {c -(}
    qui count if `over' == `i'
    local N_data = r(N)
    qui count if `over' == `i' & !missing(`v')
    local N_`i' = r(N)
    qui count if missing(`v') & `over'==`i'
    local n_missing_`i' = r(N)
    {c )-}
  - local n_inanalysis_per_`i' = `N_`i''/`N_data' *100
  = local n_inanalysis_per_overall = 1000/1000 *100
  - local in_per_`i' = string(`n_inanalysis_per_`i'', "%12.`miss_decimal'f")
  = local in_per_overall = string(100, "%12.1f")
  - local inanalysis_`i' = `N_`i''
  = local inanalysis_overall = 1000
  - if "`n_analysis_per'" != "" local inanalysis_`i' `N_`i'' (`in_per_`i''`per')
  = if "" != "" local inanalysis_overall 1000 (100.0)
  - local n_missing_per_`i' = `n_missing_`i''/`N_data'*100
  = local n_missing_per_overall = 0/1000*100
  - local miss_per_`i' = string(`n_missing_per_`i'', "%12.`miss_decimal'f")
  = local miss_per_overall = string(0, "%12.1f")
  - local missing_`i' = `n_missing_`i''
  = local missing_overall = 0
  - if "`miss_per'" != "" local missing_`i' `n_missing_`i'' (`miss_per_`i''`per')
  = if "" != "" local missing_overall 0 (0.0)
  - display as text %20s abbrev("`i'",20) " {c -(}c |{c )-}" as result %9.0g `N_`i'' " " %9.0g `n_inanalysis_per_`i'' %14.0g `n_missing_`i'' " " %9.0g `n_missing_per_`i''
  = display as text %20s abbrev("overall",20) " {c -(}c |{c )-}" as result %9.0g 1000 " " %9.0g 100 %14.0g 0 " " %9.0g 0
             overall {c |}{res}     1000       100             0         0
  {txt}- local brackets_`i' ""
  = local brackets_overall ""
  - if "`cond'" == "" | ("`cond'" == "cond" & `miss_overall' != 0) {c -(}
  = if "" == "" | ("" == "cond" & 0 != 0) {c -(}
  - if "`missing'" == "cols" local miss_cols `miss_cols' ("`missing_`i''")
  = if "" == "cols" local miss_cols  ("0")
  - if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("`inanalysis_`i''")
  = if "" == "cols" local inan_cols  ("1000")
  - local brackets_`i'
  = local brackets_overall
  - if "`missing'" == "brackets" local brackets_`i' "[`missing_`i'']"
  = if "" == "brackets" local brackets_overall "[0]"
  - if "`n_analysis'" == "brackets" local brackets_`i' "[`inanalysis_`i'']"
  = if "" == "brackets" local brackets_overall "[1000]"
  - {c )-}
  - if "`cond'" == "cond" & `miss_overall' == 0 {c -(}
  = if "" == "cond" & 0 == 0 {c -(}
    if "`missing'" == "cols" local miss_cols `miss_cols' ("")
    if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("")
    {c )-}
  - {c )-}
  - di as text "{c -(}hline 21{c )-}{c -(}c BT{c )-}{c -(}hline 43{c )-}"
{hline 21}{c BT}{hline 43}
  - if "`type1'" == "cat" {c -(}
  = if "bin" == "cat" {c -(}
    if "`cat_col'" == "" {c -(}
    if "`order'" == "group_sum" {c -(}
    local summaries ""
    foreach i in `over_grps' {c -(}
    local summaries `summaries' ("")
    {c )-}
    if "`sum_cols_first'" == "" {c -(}
    post `postname' `var_label' `measure_post' `miss_cols' `inan_cols' `summaries' `comment'
    {c )-}
    else {c -(}
    post `postname' `var_label' `measure_post' `summaries' `miss_cols' `inan_cols' `comment'
    {c )-}
    {c )-}
    if "`order'" == "group_treat" {c -(}
    local summaries ""
    foreach i in `over_grps' {c -(}
    if "`n_analysis'" == "cols" local treat_cols`i' ("`inanalysis_`i''")
    if "`missing'" == "cols" local treat_cols`i' ("`missing_`i''")
    local summaries `summaries' `treat_cols`i''
    {c )-}
    post `postname' `var_label' `measure_post' `summaries' `comment'
    {c )-}
    {c )-}
    if "`over'" != "" tab `v' `over', col `miss_opt'
    if "`over'" == "" tab `v', `miss_opt'
    local val_label: value label `v'
    local levels "`cat_levels'"
    if "`levels'" == "" qui levelsof `v', local(levels)
    if "`missing'" == "brackets" local levels `levels' miss
    if "`n_analysis'" == "brackets" local levels `levels' inan
    local row = 0
    foreach i in `levels' {c -(}
    local row = `row' + 1
    if "`i'" == "inan" {c -(}
    local value_name "n included in analysis"
    {c )-}
    else if "`i'" == "miss" {c -(}
    local value_name "missing"
    {c )-}
    else {c -(}
    if "`val_label'" != "" {c -(}
    local value_name: label `val_label' `i'
    {c )-}
    if "`val_label'" == "" {c -(}
    local value_name `i'
    {c )-}
    {c )-}
    foreach j in `over_grps' {c -(}
    if "`i'" != "inan" & "`i'" != "miss" {c -(}
    if "`j'" == "overall" qui count if `v' == `i'
    if "`j'" != "overall" qui count if `v' == `i' & `over' ==`j'
    local n = r(N)
    if "`count_only'" == "" {c -(}
    local percent = `n'/`N_`j''*100
    local per_str = string(`percent', "%12.`su_decimal'f")
    local per_str (`per_str'`per')
    {c )-}
    local su_`j' ("`n' `per_str'")
    {c )-}
    if "`i'" == "inan" | "`i'" == "miss" local su_`j' ("`brackets_`j''")
    {c )-}
    if "`su_label'" == "col" local measure_post ("")
    local tab "`tab1'"
    if "`cat_col'" != "" {c -(}
    if `row' == 1 {c -(}
    local ccol `var_label'
    if "`su_label'" == "col" local measure_post ("`measure1'")
    {c )-}
    if `row' > 1 local ccol ("")
    local tab ""
    {c )-}
    if "`order'" == "group_sum" {c -(}
    local summaries ""
    local miss_cols ""
    local inan_cols ""
    foreach j in `over_grps' {c -(}
    local summaries `summaries' `su_`j''
    if "`missing'" == "cols" local miss_cols `miss_cols' ("`missing_`j''")
    if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("`inanalysis_`j''")
    {c )-}
    if "`sum_cols_first'" == "" {c -(}
    post `postname' `ccol' `measure_post' ("`tab'`value_name'") `inan_cols' `miss_cols' `summaries' `comment'
    {c )-}
    else {c -(}
    post `postname' `ccol' `measure_post' ("`tab'`value_name'") `summaries' `inan_cols' `miss_cols' `comment'
    {c )-}
    {c )-}
    if "`order'" == "group_treat" {c -(}
    local summaries ""
    foreach j in `over_grps' {c -(}
    local treat_cols`j' ""
    if "`missing'" == "cols" local treat_cols`j' `treat_cols`j'' ("`missing_`j''")
    if "`n_analysis'" == "cols" local treat_cols`j' ("`inanalysis_`j''")
    local treat_cols`j' `treat_cols`j'' `su_`j''
    local summaries `summaries' `treat_cols`j''
    {c )-}
    post `postname' `ccol' `measure_post' ("`tab'`value_name'") `summaries' `comment'
    {c )-}
    {c )-}
    {c )-}
  - else {c -(}
  - if "`cat_col'" != "" local ccol ("")
  = if "" != "" local ccol ("")
  - foreach i in `over_grps' {c -(}
  = foreach i in overall {c -(}
  - if "`type1'" == "cont" {c -(}
  = if "bin" == "cont" {c -(}
    di "Group `i'"
    if "`i'" == "overall" su `v'
    if "`i'" != "overall" su `v' if `over' == `i'
    local mean = string(r(mean), "%12.`su_decimal'f")
    local sd = string(r(sd), "%12.`su_decimal'f")
    local su_`i' ("`mean' (`sd') `brackets_`i''")
    {c )-}
  - if "`type1'" == "bin" {c -(}
  = if "bin" == "bin" {c -(}
  - if "`i'" == "overall" qui count if `v'==`positive'
  = if "overall" == "overall" qui count if gender==1
  - if "`i'" != "overall" qui count if `v'==`positive' & `over' == `i'
  = if "overall" != "overall" qui count if gender==1 &  == overall
  - scalar count_treat_positive_`i' = r(N)
  = scalar count_treat_positive_overall = r(N)
  - local n = count_treat_positive_`i'
  = local n = count_treat_positive_overall
  - if "`count_only'" == ""{c -(}
  = if "" == ""{c -(}
  - local percent = count_treat_positive_`i'/`N_`i''*100
  = local percent = count_treat_positive_overall/1000*100
  - local per_str = string(`percent', "%12.`su_decimal'f")
  = local per_str = string(51.9, "%12.1f")
  - local per_str (`per_str'`per')
  = local per_str (51.9)
  - {c )-}
  - local su_`i' ("`n' `per_str' `brackets_`i''")
  = local su_overall ("519 (51.9) ")
  - {c )-}
  - if "`type1'" == "skew" {c -(}
  = if "bin" == "skew" {c -(}
    di "Group `i'"
    if "`i'" == "overall" tabstat `v', stats(q) save
    if "`i'" != "overall" tabstat `v' if `over' == `i', stats(q) save
    mat define A = r(StatTotal)
    local median = string(A[2,1], "%12.`su_decimal'f")
    local q1 = string(A[1,1], "%12.`su_decimal'f")
    local q3 = string(A[3,1], "%12.`su_decimal'f")
    local su_`i' ("`median' (`q1'-`q3') `brackets_`i''")
    {c )-}
  - {c )-}
  - if "`type1'" == "bin" {c -(}
  = if "bin" == "bin" {c -(}
  - if "`miss_opt'" == "" {c -(}
  = if "" == "" {c -(}
  - if "`over'" != "" tab `v' `over', col
  = if "" != "" tab gender , col
  - if "`over'" == "" tab `v'
  = if "" == "" tab gender

     Female {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
       Male {c |}{res}        481       48.10       48.10
{txt}     Female {c |}{res}        519       51.90      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      1,000      100.00
  {txt}- {c )-}
  - {c )-}
  - if "`order'" == "group_sum" {c -(}
  = if "group_sum" == "group_sum" {c -(}
  - local summaries ""
  - foreach i in `over_grps' {c -(}
  = foreach i in overall {c -(}
  - local summaries `summaries' `su_`i''
  = local summaries  ("519 (51.9) ")
  - {c )-}
  - if "`sum_cols_first'" == "" {c -(}
  = if "" == "" {c -(}
  - post `postname' `var_label' `measure_post' `ccol' `inan_cols' `miss_cols' `summaries' `comment'
  = post __000000 ("Female ")     ("519 (51.9) ") 
  - {c )-}
  - else {c -(}
    post `postname' `var_label' `measure_post' `ccol' `summaries' `inan_cols' `miss_cols' `comment'
    {c )-}
  - {c )-}
  - if "`order'" == "group_treat" {c -(}
  = if "group_sum" == "group_treat" {c -(}
    local summaries ""
    foreach i in `over_grps' {c -(}
    if "`n_analysis'" == "cols" local treat_cols`i' ("`inanalysis_`i''")
    if "`missing'" == "cols" local treat_cols`i' ("`missing_`i''")
    local treat_cols`i' `treat_cols`i'' `su_`i''
    local summaries `summaries' `treat_cols`i''
    {c )-}
    post `postname' `var_label' `measure_post' `ccol' `summaries' `comment'
    {c )-}
  - {c )-}
  - local measure_post
  - if "`su_label'" == "col" local measure_post ("")
  = if "" == "col" local measure_post ("")
  - if "`cat_col'" != "" local ccol ("")
  = if "" != "" local ccol ("")
  - local summaries ""
  - local miss_cols ""
  - local inan_cols ""
  - foreach i in `over_grps' {c -(}
  = foreach i in overall {c -(}
  - local summaries `summaries' ("")
  = local summaries  ("")
  - if "`missing'" == "cols" local miss_cols `miss_cols' ("")
  = if "" == "cols" local miss_cols  ("")
  - if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("")
  = if "" == "cols" local inan_cols  ("")
  - {c )-}
  - if "`comment'" != "" local comment ("")
  = if "" != "" local comment ("")
  - if `gap' > 0 {c -(}
  = if 0 > 0 {c -(}
    forvalues i = 1 (1) `gap' {c -(}
    post `postname' ("") `measure_post' `ccol' `inan_cols' `miss_cols' `summaries' `comment'
    {c )-}
    {c )-}
  - {c )-}
  - di as result _newline(3) "****** `v' ******" _newline(1)
  = di as result _newline(3) "****** ethnicity ******" _newline(1)



{res}****** ethnicity ******

  {txt}- display as text %26s "Group {c -(}c |{c )-}" as text %19s "N obs. Percent" %24s "N missing Percent"
               Group {c |}     N obs. Percent       N missing Percent
  - di as text "{c -(}hline 21{c )-}{c -(}c +{c )-}{c -(}hline 43{c )-}"
{hline 21}{c +}{hline 43}
  - local type1 = "`type'"
  = local type1 = ""
  - if "`type1'" == "" {c -(}
  = if "" == "" {c -(}
  - qui inspect `v'
  = qui inspect ethnicity
  - if r(N_unique) < 3 {c -(}
    local type1 = "bin"
    {c )-}
  - else if r(N_unique) < 10 {c -(}
  - local type1 = "cat"
  - {c )-}
  - else if r(N_unique) >= 10 | r(N_unique) ==. {c -(}
    local type1 = "cont"
    {c )-}
  - {c )-}
  - qui count if missing(`v')
  = qui count if missing(ethnicity)
  - local miss_overall = r(N)
  - local var_label `var_lab'
  = local var_label 
  - if "`var_lab'" == "" local var_label:variable label `v'
  = if "" == "" local var_label:variable label ethnicity
  - if "`var_label'" == "" local var_label = "`v'"
  = if "Ethnicity" == "" local var_label = "ethnicity"
  - local var_label `var_label' `append_label'
  = local var_label Ethnicity 
  - if "`type1'" == "cont" local measure1 "mean (sd)"
  = if "cat" == "cont" local measure1 "mean (sd)"
  - if "`type1'" == "bin" | "`type1'" == "cat" {c -(}
  = if "cat" == "bin" | "cat" == "cat" {c -(}
  - local measure1 "n (%)"
  - if "`count_only'" != "" local measure1 "n"
  = if "" != "" local measure1 "n"
  - {c )-}
  - if "`type1'" == "skew" local measure1 "median (IQR)"
  = if "cat" == "skew" local measure1 "median (IQR)"
  - if "`missing'" == "brackets" local measure1 "`measure1' [missing]"
  = if "" == "brackets" local measure1 "n (%) [missing]"
  - if "`n_analysis'" == "brackets" local measure1 "`measure1' [n included in analysis]"
  = if "" == "brackets" local measure1 "n (%) [n included in analysis]"
  - if "`su_label_text'" != "" local measure1 `su_label_text'
  = if "" != "" local measure1 
  - if "`su_label'" == "append" local measure_append =" - `measure1'"
  = if "" == "append" local measure_append =" - n (%)"
  - local N_append ""
  - if "`n_analysis'" == "append" & ("`cond'" =="" | `miss_overall' > 0) {c -(}
  = if "" == "append" & ("" =="" | 111 > 0) {c -(}
    qui count if missing(`v') ==0
    local N = r(N)
    local N_append (N = `N')
    {c )-}
  - local var_label ("`var_label'`measure_append' `N_append'")
  = local var_label ("Ethnicity ")
  - local measure_post
  - if "`su_label'" == "col" local measure_post ("`measure1'")
  = if "" == "col" local measure_post ("n (%)")
  - local miss_cols ""
  - local inan_cols ""
  - foreach i in `over_grps' {c -(}
  = foreach i in overall {c -(}
  - if "`i'" == "overall" {c -(}
  = if "overall" == "overall" {c -(}
  - qui count
  - local N_data = r(N)
  - qui count if !missing(`v')
  = qui count if !missing(ethnicity)
  - local N_`i' = r(N)
  = local N_overall = r(N)
  - qui count if missing(`v')
  = qui count if missing(ethnicity)
  - local n_missing_`i' = r(N)
  = local n_missing_overall = r(N)
  - {c )-}
  - else {c -(}
    qui count if `over' == `i'
    local N_data = r(N)
    qui count if `over' == `i' & !missing(`v')
    local N_`i' = r(N)
    qui count if missing(`v') & `over'==`i'
    local n_missing_`i' = r(N)
    {c )-}
  - local n_inanalysis_per_`i' = `N_`i''/`N_data' *100
  = local n_inanalysis_per_overall = 889/1000 *100
  - local in_per_`i' = string(`n_inanalysis_per_`i'', "%12.`miss_decimal'f")
  = local in_per_overall = string(88.90000000000001, "%12.1f")
  - local inanalysis_`i' = `N_`i''
  = local inanalysis_overall = 889
  - if "`n_analysis_per'" != "" local inanalysis_`i' `N_`i'' (`in_per_`i''`per')
  = if "" != "" local inanalysis_overall 889 (88.9)
  - local n_missing_per_`i' = `n_missing_`i''/`N_data'*100
  = local n_missing_per_overall = 111/1000*100
  - local miss_per_`i' = string(`n_missing_per_`i'', "%12.`miss_decimal'f")
  = local miss_per_overall = string(11.1, "%12.1f")
  - local missing_`i' = `n_missing_`i''
  = local missing_overall = 111
  - if "`miss_per'" != "" local missing_`i' `n_missing_`i'' (`miss_per_`i''`per')
  = if "" != "" local missing_overall 111 (11.1)
  - display as text %20s abbrev("`i'",20) " {c -(}c |{c )-}" as result %9.0g `N_`i'' " " %9.0g `n_inanalysis_per_`i'' %14.0g `n_missing_`i'' " " %9.0g `n_missing_per_`i''
  = display as text %20s abbrev("overall",20) " {c -(}c |{c )-}" as result %9.0g 889 " " %9.0g 88.90000000000001 %14.0g 111 " " %9.0g 11.1
             overall {c |}{res}      889      88.9           111      11.1
  {txt}- local brackets_`i' ""
  = local brackets_overall ""
  - if "`cond'" == "" | ("`cond'" == "cond" & `miss_overall' != 0) {c -(}
  = if "" == "" | ("" == "cond" & 111 != 0) {c -(}
  - if "`missing'" == "cols" local miss_cols `miss_cols' ("`missing_`i''")
  = if "" == "cols" local miss_cols  ("111")
  - if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("`inanalysis_`i''")
  = if "" == "cols" local inan_cols  ("889")
  - local brackets_`i'
  = local brackets_overall
  - if "`missing'" == "brackets" local brackets_`i' "[`missing_`i'']"
  = if "" == "brackets" local brackets_overall "[111]"
  - if "`n_analysis'" == "brackets" local brackets_`i' "[`inanalysis_`i'']"
  = if "" == "brackets" local brackets_overall "[889]"
  - {c )-}
  - if "`cond'" == "cond" & `miss_overall' == 0 {c -(}
  = if "" == "cond" & 111 == 0 {c -(}
    if "`missing'" == "cols" local miss_cols `miss_cols' ("")
    if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("")
    {c )-}
  - {c )-}
  - di as text "{c -(}hline 21{c )-}{c -(}c BT{c )-}{c -(}hline 43{c )-}"
{hline 21}{c BT}{hline 43}
  - if "`type1'" == "cat" {c -(}
  = if "cat" == "cat" {c -(}
  - if "`cat_col'" == "" {c -(}
  = if "" == "" {c -(}
  - if "`order'" == "group_sum" {c -(}
  = if "group_sum" == "group_sum" {c -(}
  - local summaries ""
  - foreach i in `over_grps' {c -(}
  = foreach i in overall {c -(}
  - local summaries `summaries' ("")
  = local summaries  ("")
  - {c )-}
  - if "`sum_cols_first'" == "" {c -(}
  = if "" == "" {c -(}
  - post `postname' `var_label' `measure_post' `miss_cols' `inan_cols' `summaries' `comment'
  = post __000000 ("Ethnicity ")    ("") 
  - {c )-}
  - else {c -(}
    post `postname' `var_label' `measure_post' `summaries' `miss_cols' `inan_cols' `comment'
    {c )-}
  - {c )-}
  - if "`order'" == "group_treat" {c -(}
  = if "group_sum" == "group_treat" {c -(}
    local summaries ""
    foreach i in `over_grps' {c -(}
    if "`n_analysis'" == "cols" local treat_cols`i' ("`inanalysis_`i''")
    if "`missing'" == "cols" local treat_cols`i' ("`missing_`i''")
    local summaries `summaries' `treat_cols`i''
    {c )-}
    post `postname' `var_label' `measure_post' `summaries' `comment'
    {c )-}
  - {c )-}
  - if "`over'" != "" tab `v' `over', col `miss_opt'
  = if "" != "" tab ethnicity , col 
  - if "`over'" == "" tab `v', `miss_opt'
  = if "" == "" tab ethnicity, 

             Ethnicity {c |}      Freq.     Percent        Cum.
{hline 23}{c +}{hline 35}
                 Other {c |}{res}         45        5.06        5.06
{txt}                 Mixed {c |}{res}        131       14.74       19.80
{txt}Asian or Asian British {c |}{res}        201       22.61       42.41
{txt}Black or Black British {c |}{res}        231       25.98       68.39
{txt}White or White British {c |}{res}        281       31.61      100.00
{txt}{hline 23}{c +}{hline 35}
                 Total {c |}{res}        889      100.00
  {txt}- local val_label: value label `v'
  = local val_label: value label ethnicity
  - local levels "`cat_levels'"
  = local levels ""
  - if "`levels'" == "" qui levelsof `v', local(levels)
  = if "" == "" qui levelsof ethnicity, local(levels)
    {hline 83} begin levelsof {hline}
    - version 15.0
    - mata: st_rclear()
    - syntax varname [if] [in] [, Separate(str) MISSing Local(name local) Clean MATROW(name) MATCELL(name) HEXadecimal ]
    - if ("`missing'" == "") {c -(}
    = if ("" == "") {c -(}
    - marksample touse, strok
    - {c )-}
    - else {c -(}
      marksample touse, strok novarlist
      {c )-}
    - if (`"`separate'"' == "") {c -(}
    = if (`""' == "") {c -(}
    - local separate " "
    - {c )-}
    - local typ : type `varlist'
    = local typ : type ethnicity
    - if ("`typ'" == "strL") {c -(}
    = if ("float" == "strL") {c -(}
      NoHexadecimal `hexadecimal'
      NoMatrow `matrow'
      LevelsOfStrL `varlist' if `touse', separate(`"`separate'"') `clean' matcell(`matcell')
      {c )-}
    - else if (substr("`typ'", 1, 3) == "str") {c -(}
    = else if (substr("float", 1, 3) == "str") {c -(}
      NoHexadecimal `hexadecimal'
      NoMatrow `matrow'
      local isclean = ("`clean'" != "")
      mata: LevelsOfString("`varlist'", "`touse'", `"`separate'"', `isclean', "`matcell'")
      {c )-}
    - else {c -(}
    - local isint = inlist("`typ'", "byte", "int", "long")
    = local isint = inlist("float", "byte", "int", "long")
    - mata: LevelsOfReal("`varlist'", "`touse'", `"`separate'"', `isint', 1, "`matrow'", "`matcell'", "`hexadecimal'" != "")
    = mata: LevelsOfReal("ethnicity", "__000001", `" "', 0, 1, "", "", "" != "")
    - if ("`usetab'" == "usetab") {c -(}
    = if ("" == "usetab") {c -(}
      cap LevelsOfTab `varlist' if `touse', `missing' separate(`"`separate'"') matrow(`matrow') matcell(`matcell') `hexadecimal'
      if (_rc) {c -(}
      mata: LevelsOfReal("`varlist'", "`touse'", `"`separate'"', `isint', 0, "`matrow'", "`matcell'", "`hexadecimal'" != "")
      {c )-}
      {c )-}
    - {c )-}
    - if ("`local'" != "") {c -(}
    = if ("levels" != "") {c -(}
    - c_local `local' `"`r(levels)'"'
    = c_local levels `"0 1 2 3 4"'
    - {c )-}
    - di as text `"`r(levels)'"'
    = di as text `"0 1 2 3 4"'
    {hline 85} end levelsof {hline}
  - if "`missing'" == "brackets" local levels `levels' miss
  = if "" == "brackets" local levels 0 1 2 3 4 miss
  - if "`n_analysis'" == "brackets" local levels `levels' inan
  = if "" == "brackets" local levels 0 1 2 3 4 inan
  - local row = 0
  - foreach i in `levels' {c -(}
  = foreach i in 0 1 2 3 4 {c -(}
  - local row = `row' + 1
  = local row = 0 + 1
  - if "`i'" == "inan" {c -(}
  = if "0" == "inan" {c -(}
    local value_name "n included in analysis"
    {c )-}
  - else if "`i'" == "miss" {c -(}
  = else if "0" == "miss" {c -(}
    local value_name "missing"
    {c )-}
  - else {c -(}
  - if "`val_label'" != "" {c -(}
  = if "ethnicity" != "" {c -(}
  - local value_name: label `val_label' `i'
  = local value_name: label ethnicity 0
  - {c )-}
  - if "`val_label'" == "" {c -(}
  = if "ethnicity" == "" {c -(}
    local value_name `i'
    {c )-}
  - {c )-}
  - foreach j in `over_grps' {c -(}
  = foreach j in overall {c -(}
  - if "`i'" != "inan" & "`i'" != "miss" {c -(}
  = if "0" != "inan" & "0" != "miss" {c -(}
  - if "`j'" == "overall" qui count if `v' == `i'
  = if "overall" == "overall" qui count if ethnicity == 0
  - if "`j'" != "overall" qui count if `v' == `i' & `over' ==`j'
  = if "overall" != "overall" qui count if ethnicity == 0 &  ==overall
  - local n = r(N)
  - if "`count_only'" == "" {c -(}
  = if "" == "" {c -(}
  - local percent = `n'/`N_`j''*100
  = local percent = 45/889*100
  - local per_str = string(`percent', "%12.`su_decimal'f")
  = local per_str = string(5.061867266591676, "%12.1f")
  - local per_str (`per_str'`per')
  = local per_str (5.1)
  - {c )-}
  - local su_`j' ("`n' `per_str'")
  = local su_overall ("45 (5.1)")
  - {c )-}
  - if "`i'" == "inan" | "`i'" == "miss" local su_`j' ("`brackets_`j''")
  = if "0" == "inan" | "0" == "miss" local su_overall ("")
  - {c )-}
  - if "`su_label'" == "col" local measure_post ("")
  = if "" == "col" local measure_post ("")
  - local tab "`tab1'"
  = local tab "    "
  - if "`cat_col'" != "" {c -(}
  = if "" != "" {c -(}
    if `row' == 1 {c -(}
    local ccol `var_label'
    if "`su_label'" == "col" local measure_post ("`measure1'")
    {c )-}
    if `row' > 1 local ccol ("")
    local tab ""
    {c )-}
  - if "`order'" == "group_sum" {c -(}
  = if "group_sum" == "group_sum" {c -(}
  - local summaries ""
  - local miss_cols ""
  - local inan_cols ""
  - foreach j in `over_grps' {c -(}
  = foreach j in overall {c -(}
  - local summaries `summaries' `su_`j''
  = local summaries  ("45 (5.1)")
  - if "`missing'" == "cols" local miss_cols `miss_cols' ("`missing_`j''")
  = if "" == "cols" local miss_cols  ("111")
  - if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("`inanalysis_`j''")
  = if "" == "cols" local inan_cols  ("889")
  - {c )-}
  - if "`sum_cols_first'" == "" {c -(}
  = if "" == "" {c -(}
  - post `postname' `ccol' `measure_post' ("`tab'`value_name'") `inan_cols' `miss_cols' `summaries' `comment'
  = post __000000   ("    Other")   ("45 (5.1)") 
  - {c )-}
  - else {c -(}
    post `postname' `ccol' `measure_post' ("`tab'`value_name'") `summaries' `inan_cols' `miss_cols' `comment'
    {c )-}
  - {c )-}
  - if "`order'" == "group_treat" {c -(}
  = if "group_sum" == "group_treat" {c -(}
    local summaries ""
    foreach j in `over_grps' {c -(}
    local treat_cols`j' ""
    if "`missing'" == "cols" local treat_cols`j' `treat_cols`j'' ("`missing_`j''")
    if "`n_analysis'" == "cols" local treat_cols`j' ("`inanalysis_`j''")
    local treat_cols`j' `treat_cols`j'' `su_`j''
    local summaries `summaries' `treat_cols`j''
    {c )-}
    post `postname' `ccol' `measure_post' ("`tab'`value_name'") `summaries' `comment'
    {c )-}
  - {c )-}
  - local row = `row' + 1
  = local row = 1 + 1
  - if "`i'" == "inan" {c -(}
  = if "1" == "inan" {c -(}
    local value_name "n included in analysis"
    {c )-}
  - else if "`i'" == "miss" {c -(}
  = else if "1" == "miss" {c -(}
    local value_name "missing"
    {c )-}
  - else {c -(}
  - if "`val_label'" != "" {c -(}
  = if "ethnicity" != "" {c -(}
  - local value_name: label `val_label' `i'
  = local value_name: label ethnicity 1
  - {c )-}
  - if "`val_label'" == "" {c -(}
  = if "ethnicity" == "" {c -(}
    local value_name `i'
    {c )-}
  - {c )-}
  - foreach j in `over_grps' {c -(}
  = foreach j in overall {c -(}
  - if "`i'" != "inan" & "`i'" != "miss" {c -(}
  = if "1" != "inan" & "1" != "miss" {c -(}
  - if "`j'" == "overall" qui count if `v' == `i'
  = if "overall" == "overall" qui count if ethnicity == 1
  - if "`j'" != "overall" qui count if `v' == `i' & `over' ==`j'
  = if "overall" != "overall" qui count if ethnicity == 1 &  ==overall
  - local n = r(N)
  - if "`count_only'" == "" {c -(}
  = if "" == "" {c -(}
  - local percent = `n'/`N_`j''*100
  = local percent = 131/889*100
  - local per_str = string(`percent', "%12.`su_decimal'f")
  = local per_str = string(14.73565804274466, "%12.1f")
  - local per_str (`per_str'`per')
  = local per_str (14.7)
  - {c )-}
  - local su_`j' ("`n' `per_str'")
  = local su_overall ("131 (14.7)")
  - {c )-}
  - if "`i'" == "inan" | "`i'" == "miss" local su_`j' ("`brackets_`j''")
  = if "1" == "inan" | "1" == "miss" local su_overall ("")
  - {c )-}
  - if "`su_label'" == "col" local measure_post ("")
  = if "" == "col" local measure_post ("")
  - local tab "`tab1'"
  = local tab "    "
  - if "`cat_col'" != "" {c -(}
  = if "" != "" {c -(}
    if `row' == 1 {c -(}
    local ccol `var_label'
    if "`su_label'" == "col" local measure_post ("`measure1'")
    {c )-}
    if `row' > 1 local ccol ("")
    local tab ""
    {c )-}
  - if "`order'" == "group_sum" {c -(}
  = if "group_sum" == "group_sum" {c -(}
  - local summaries ""
  - local miss_cols ""
  - local inan_cols ""
  - foreach j in `over_grps' {c -(}
  = foreach j in overall {c -(}
  - local summaries `summaries' `su_`j''
  = local summaries  ("131 (14.7)")
  - if "`missing'" == "cols" local miss_cols `miss_cols' ("`missing_`j''")
  = if "" == "cols" local miss_cols  ("111")
  - if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("`inanalysis_`j''")
  = if "" == "cols" local inan_cols  ("889")
  - {c )-}
  - if "`sum_cols_first'" == "" {c -(}
  = if "" == "" {c -(}
  - post `postname' `ccol' `measure_post' ("`tab'`value_name'") `inan_cols' `miss_cols' `summaries' `comment'
  = post __000000   ("    Mixed")   ("131 (14.7)") 
  - {c )-}
  - else {c -(}
    post `postname' `ccol' `measure_post' ("`tab'`value_name'") `summaries' `inan_cols' `miss_cols' `comment'
    {c )-}
  - {c )-}
  - if "`order'" == "group_treat" {c -(}
  = if "group_sum" == "group_treat" {c -(}
    local summaries ""
    foreach j in `over_grps' {c -(}
    local treat_cols`j' ""
    if "`missing'" == "cols" local treat_cols`j' `treat_cols`j'' ("`missing_`j''")
    if "`n_analysis'" == "cols" local treat_cols`j' ("`inanalysis_`j''")
    local treat_cols`j' `treat_cols`j'' `su_`j''
    local summaries `summaries' `treat_cols`j''
    {c )-}
    post `postname' `ccol' `measure_post' ("`tab'`value_name'") `summaries' `comment'
    {c )-}
  - {c )-}
  - local row = `row' + 1
  = local row = 2 + 1
  - if "`i'" == "inan" {c -(}
  = if "2" == "inan" {c -(}
    local value_name "n included in analysis"
    {c )-}
  - else if "`i'" == "miss" {c -(}
  = else if "2" == "miss" {c -(}
    local value_name "missing"
    {c )-}
  - else {c -(}
  - if "`val_label'" != "" {c -(}
  = if "ethnicity" != "" {c -(}
  - local value_name: label `val_label' `i'
  = local value_name: label ethnicity 2
  - {c )-}
  - if "`val_label'" == "" {c -(}
  = if "ethnicity" == "" {c -(}
    local value_name `i'
    {c )-}
  - {c )-}
  - foreach j in `over_grps' {c -(}
  = foreach j in overall {c -(}
  - if "`i'" != "inan" & "`i'" != "miss" {c -(}
  = if "2" != "inan" & "2" != "miss" {c -(}
  - if "`j'" == "overall" qui count if `v' == `i'
  = if "overall" == "overall" qui count if ethnicity == 2
  - if "`j'" != "overall" qui count if `v' == `i' & `over' ==`j'
  = if "overall" != "overall" qui count if ethnicity == 2 &  ==overall
  - local n = r(N)
  - if "`count_only'" == "" {c -(}
  = if "" == "" {c -(}
  - local percent = `n'/`N_`j''*100
  = local percent = 201/889*100
  - local per_str = string(`percent', "%12.`su_decimal'f")
  = local per_str = string(22.60967379077615, "%12.1f")
  - local per_str (`per_str'`per')
  = local per_str (22.6)
  - {c )-}
  - local su_`j' ("`n' `per_str'")
  = local su_overall ("201 (22.6)")
  - {c )-}
  - if "`i'" == "inan" | "`i'" == "miss" local su_`j' ("`brackets_`j''")
  = if "2" == "inan" | "2" == "miss" local su_overall ("")
  - {c )-}
  - if "`su_label'" == "col" local measure_post ("")
  = if "" == "col" local measure_post ("")
  - local tab "`tab1'"
  = local tab "    "
  - if "`cat_col'" != "" {c -(}
  = if "" != "" {c -(}
    if `row' == 1 {c -(}
    local ccol `var_label'
    if "`su_label'" == "col" local measure_post ("`measure1'")
    {c )-}
    if `row' > 1 local ccol ("")
    local tab ""
    {c )-}
  - if "`order'" == "group_sum" {c -(}
  = if "group_sum" == "group_sum" {c -(}
  - local summaries ""
  - local miss_cols ""
  - local inan_cols ""
  - foreach j in `over_grps' {c -(}
  = foreach j in overall {c -(}
  - local summaries `summaries' `su_`j''
  = local summaries  ("201 (22.6)")
  - if "`missing'" == "cols" local miss_cols `miss_cols' ("`missing_`j''")
  = if "" == "cols" local miss_cols  ("111")
  - if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("`inanalysis_`j''")
  = if "" == "cols" local inan_cols  ("889")
  - {c )-}
  - if "`sum_cols_first'" == "" {c -(}
  = if "" == "" {c -(}
  - post `postname' `ccol' `measure_post' ("`tab'`value_name'") `inan_cols' `miss_cols' `summaries' `comment'
  = post __000000   ("    Asian or Asian British")   ("201 (22.6)") 
  - {c )-}
  - else {c -(}
    post `postname' `ccol' `measure_post' ("`tab'`value_name'") `summaries' `inan_cols' `miss_cols' `comment'
    {c )-}
  - {c )-}
  - if "`order'" == "group_treat" {c -(}
  = if "group_sum" == "group_treat" {c -(}
    local summaries ""
    foreach j in `over_grps' {c -(}
    local treat_cols`j' ""
    if "`missing'" == "cols" local treat_cols`j' `treat_cols`j'' ("`missing_`j''")
    if "`n_analysis'" == "cols" local treat_cols`j' ("`inanalysis_`j''")
    local treat_cols`j' `treat_cols`j'' `su_`j''
    local summaries `summaries' `treat_cols`j''
    {c )-}
    post `postname' `ccol' `measure_post' ("`tab'`value_name'") `summaries' `comment'
    {c )-}
  - {c )-}
  - local row = `row' + 1
  = local row = 3 + 1
  - if "`i'" == "inan" {c -(}
  = if "3" == "inan" {c -(}
    local value_name "n included in analysis"
    {c )-}
  - else if "`i'" == "miss" {c -(}
  = else if "3" == "miss" {c -(}
    local value_name "missing"
    {c )-}
  - else {c -(}
  - if "`val_label'" != "" {c -(}
  = if "ethnicity" != "" {c -(}
  - local value_name: label `val_label' `i'
  = local value_name: label ethnicity 3
  - {c )-}
  - if "`val_label'" == "" {c -(}
  = if "ethnicity" == "" {c -(}
    local value_name `i'
    {c )-}
  - {c )-}
  - foreach j in `over_grps' {c -(}
  = foreach j in overall {c -(}
  - if "`i'" != "inan" & "`i'" != "miss" {c -(}
  = if "3" != "inan" & "3" != "miss" {c -(}
  - if "`j'" == "overall" qui count if `v' == `i'
  = if "overall" == "overall" qui count if ethnicity == 3
  - if "`j'" != "overall" qui count if `v' == `i' & `over' ==`j'
  = if "overall" != "overall" qui count if ethnicity == 3 &  ==overall
  - local n = r(N)
  - if "`count_only'" == "" {c -(}
  = if "" == "" {c -(}
  - local percent = `n'/`N_`j''*100
  = local percent = 231/889*100
  - local per_str = string(`percent', "%12.`su_decimal'f")
  = local per_str = string(25.98425196850393, "%12.1f")
  - local per_str (`per_str'`per')
  = local per_str (26.0)
  - {c )-}
  - local su_`j' ("`n' `per_str'")
  = local su_overall ("231 (26.0)")
  - {c )-}
  - if "`i'" == "inan" | "`i'" == "miss" local su_`j' ("`brackets_`j''")
  = if "3" == "inan" | "3" == "miss" local su_overall ("")
  - {c )-}
  - if "`su_label'" == "col" local measure_post ("")
  = if "" == "col" local measure_post ("")
  - local tab "`tab1'"
  = local tab "    "
  - if "`cat_col'" != "" {c -(}
  = if "" != "" {c -(}
    if `row' == 1 {c -(}
    local ccol `var_label'
    if "`su_label'" == "col" local measure_post ("`measure1'")
    {c )-}
    if `row' > 1 local ccol ("")
    local tab ""
    {c )-}
  - if "`order'" == "group_sum" {c -(}
  = if "group_sum" == "group_sum" {c -(}
  - local summaries ""
  - local miss_cols ""
  - local inan_cols ""
  - foreach j in `over_grps' {c -(}
  = foreach j in overall {c -(}
  - local summaries `summaries' `su_`j''
  = local summaries  ("231 (26.0)")
  - if "`missing'" == "cols" local miss_cols `miss_cols' ("`missing_`j''")
  = if "" == "cols" local miss_cols  ("111")
  - if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("`inanalysis_`j''")
  = if "" == "cols" local inan_cols  ("889")
  - {c )-}
  - if "`sum_cols_first'" == "" {c -(}
  = if "" == "" {c -(}
  - post `postname' `ccol' `measure_post' ("`tab'`value_name'") `inan_cols' `miss_cols' `summaries' `comment'
  = post __000000   ("    Black or Black British")   ("231 (26.0)") 
  - {c )-}
  - else {c -(}
    post `postname' `ccol' `measure_post' ("`tab'`value_name'") `summaries' `inan_cols' `miss_cols' `comment'
    {c )-}
  - {c )-}
  - if "`order'" == "group_treat" {c -(}
  = if "group_sum" == "group_treat" {c -(}
    local summaries ""
    foreach j in `over_grps' {c -(}
    local treat_cols`j' ""
    if "`missing'" == "cols" local treat_cols`j' `treat_cols`j'' ("`missing_`j''")
    if "`n_analysis'" == "cols" local treat_cols`j' ("`inanalysis_`j''")
    local treat_cols`j' `treat_cols`j'' `su_`j''
    local summaries `summaries' `treat_cols`j''
    {c )-}
    post `postname' `ccol' `measure_post' ("`tab'`value_name'") `summaries' `comment'
    {c )-}
  - {c )-}
  - local row = `row' + 1
  = local row = 4 + 1
  - if "`i'" == "inan" {c -(}
  = if "4" == "inan" {c -(}
    local value_name "n included in analysis"
    {c )-}
  - else if "`i'" == "miss" {c -(}
  = else if "4" == "miss" {c -(}
    local value_name "missing"
    {c )-}
  - else {c -(}
  - if "`val_label'" != "" {c -(}
  = if "ethnicity" != "" {c -(}
  - local value_name: label `val_label' `i'
  = local value_name: label ethnicity 4
  - {c )-}
  - if "`val_label'" == "" {c -(}
  = if "ethnicity" == "" {c -(}
    local value_name `i'
    {c )-}
  - {c )-}
  - foreach j in `over_grps' {c -(}
  = foreach j in overall {c -(}
  - if "`i'" != "inan" & "`i'" != "miss" {c -(}
  = if "4" != "inan" & "4" != "miss" {c -(}
  - if "`j'" == "overall" qui count if `v' == `i'
  = if "overall" == "overall" qui count if ethnicity == 4
  - if "`j'" != "overall" qui count if `v' == `i' & `over' ==`j'
  = if "overall" != "overall" qui count if ethnicity == 4 &  ==overall
  - local n = r(N)
  - if "`count_only'" == "" {c -(}
  = if "" == "" {c -(}
  - local percent = `n'/`N_`j''*100
  = local percent = 281/889*100
  - local per_str = string(`percent', "%12.`su_decimal'f")
  = local per_str = string(31.60854893138358, "%12.1f")
  - local per_str (`per_str'`per')
  = local per_str (31.6)
  - {c )-}
  - local su_`j' ("`n' `per_str'")
  = local su_overall ("281 (31.6)")
  - {c )-}
  - if "`i'" == "inan" | "`i'" == "miss" local su_`j' ("`brackets_`j''")
  = if "4" == "inan" | "4" == "miss" local su_overall ("")
  - {c )-}
  - if "`su_label'" == "col" local measure_post ("")
  = if "" == "col" local measure_post ("")
  - local tab "`tab1'"
  = local tab "    "
  - if "`cat_col'" != "" {c -(}
  = if "" != "" {c -(}
    if `row' == 1 {c -(}
    local ccol `var_label'
    if "`su_label'" == "col" local measure_post ("`measure1'")
    {c )-}
    if `row' > 1 local ccol ("")
    local tab ""
    {c )-}
  - if "`order'" == "group_sum" {c -(}
  = if "group_sum" == "group_sum" {c -(}
  - local summaries ""
  - local miss_cols ""
  - local inan_cols ""
  - foreach j in `over_grps' {c -(}
  = foreach j in overall {c -(}
  - local summaries `summaries' `su_`j''
  = local summaries  ("281 (31.6)")
  - if "`missing'" == "cols" local miss_cols `miss_cols' ("`missing_`j''")
  = if "" == "cols" local miss_cols  ("111")
  - if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("`inanalysis_`j''")
  = if "" == "cols" local inan_cols  ("889")
  - {c )-}
  - if "`sum_cols_first'" == "" {c -(}
  = if "" == "" {c -(}
  - post `postname' `ccol' `measure_post' ("`tab'`value_name'") `inan_cols' `miss_cols' `summaries' `comment'
  = post __000000   ("    White or White British")   ("281 (31.6)") 
  - {c )-}
  - else {c -(}
    post `postname' `ccol' `measure_post' ("`tab'`value_name'") `summaries' `inan_cols' `miss_cols' `comment'
    {c )-}
  - {c )-}
  - if "`order'" == "group_treat" {c -(}
  = if "group_sum" == "group_treat" {c -(}
    local summaries ""
    foreach j in `over_grps' {c -(}
    local treat_cols`j' ""
    if "`missing'" == "cols" local treat_cols`j' `treat_cols`j'' ("`missing_`j''")
    if "`n_analysis'" == "cols" local treat_cols`j' ("`inanalysis_`j''")
    local treat_cols`j' `treat_cols`j'' `su_`j''
    local summaries `summaries' `treat_cols`j''
    {c )-}
    post `postname' `ccol' `measure_post' ("`tab'`value_name'") `summaries' `comment'
    {c )-}
  - {c )-}
  - {c )-}
  - else {c -(}
    if "`cat_col'" != "" local ccol ("")
    foreach i in `over_grps' {c -(}
    if "`type1'" == "cont" {c -(}
    di "Group `i'"
    if "`i'" == "overall" su `v'
    if "`i'" != "overall" su `v' if `over' == `i'
    local mean = string(r(mean), "%12.`su_decimal'f")
    local sd = string(r(sd), "%12.`su_decimal'f")
    local su_`i' ("`mean' (`sd') `brackets_`i''")
    {c )-}
    if "`type1'" == "bin" {c -(}
    if "`i'" == "overall" qui count if `v'==`positive'
    if "`i'" != "overall" qui count if `v'==`positive' & `over' == `i'
    scalar count_treat_positive_`i' = r(N)
    local n = count_treat_positive_`i'
    if "`count_only'" == ""{c -(}
    local percent = count_treat_positive_`i'/`N_`i''*100
    local per_str = string(`percent', "%12.`su_decimal'f")
    local per_str (`per_str'`per')
    {c )-}
    local su_`i' ("`n' `per_str' `brackets_`i''")
    {c )-}
    if "`type1'" == "skew" {c -(}
    di "Group `i'"
    if "`i'" == "overall" tabstat `v', stats(q) save
    if "`i'" != "overall" tabstat `v' if `over' == `i', stats(q) save
    mat define A = r(StatTotal)
    local median = string(A[2,1], "%12.`su_decimal'f")
    local q1 = string(A[1,1], "%12.`su_decimal'f")
    local q3 = string(A[3,1], "%12.`su_decimal'f")
    local su_`i' ("`median' (`q1'-`q3') `brackets_`i''")
    {c )-}
    {c )-}
    if "`type1'" == "bin" {c -(}
    if "`miss_opt'" == "" {c -(}
    if "`over'" != "" tab `v' `over', col
    if "`over'" == "" tab `v'
    {c )-}
    {c )-}
    if "`order'" == "group_sum" {c -(}
    local summaries ""
    foreach i in `over_grps' {c -(}
    local summaries `summaries' `su_`i''
    {c )-}
    if "`sum_cols_first'" == "" {c -(}
    post `postname' `var_label' `measure_post' `ccol' `inan_cols' `miss_cols' `summaries' `comment'
    {c )-}
    else {c -(}
    post `postname' `var_label' `measure_post' `ccol' `summaries' `inan_cols' `miss_cols' `comment'
    {c )-}
    {c )-}
    if "`order'" == "group_treat" {c -(}
    local summaries ""
    foreach i in `over_grps' {c -(}
    if "`n_analysis'" == "cols" local treat_cols`i' ("`inanalysis_`i''")
    if "`missing'" == "cols" local treat_cols`i' ("`missing_`i''")
    local treat_cols`i' `treat_cols`i'' `su_`i''
    local summaries `summaries' `treat_cols`i''
    {c )-}
    post `postname' `var_label' `measure_post' `ccol' `summaries' `comment'
    {c )-}
    {c )-}
  - local measure_post
  - if "`su_label'" == "col" local measure_post ("")
  = if "" == "col" local measure_post ("")
  - if "`cat_col'" != "" local ccol ("")
  = if "" != "" local ccol ("")
  - local summaries ""
  - local miss_cols ""
  - local inan_cols ""
  - foreach i in `over_grps' {c -(}
  = foreach i in overall {c -(}
  - local summaries `summaries' ("")
  = local summaries  ("")
  - if "`missing'" == "cols" local miss_cols `miss_cols' ("")
  = if "" == "cols" local miss_cols  ("")
  - if "`n_analysis'" == "cols" local inan_cols `inan_cols' ("")
  = if "" == "cols" local inan_cols  ("")
  - {c )-}
  - if "`comment'" != "" local comment ("")
  = if "" != "" local comment ("")
  - if `gap' > 0 {c -(}
  = if 0 > 0 {c -(}
    forvalues i = 1 (1) `gap' {c -(}
    post `postname' ("") `measure_post' `ccol' `inan_cols' `miss_cols' `summaries' `comment'
    {c )-}
    {c )-}
  - {c )-}
  - if `gap_end' > 0 {c -(}
  = if 0 > 0 {c -(}
    forvalues i = 1 (1) `gap_end' {c -(}
    post `postname' ("") `measure_post' `ccol' `inan_cols' `miss_cols' `summaries' `comment'
    {c )-}
    {c )-}
  - if "`if'" != "" restore
  = if "" != "" restore
  {hline 88} end pt_base {hline}

{com}. 
. pt_base_close `postname', eg_no(`eg_no')
{txt}  {hline 80} begin pt_base_close {hline}
  - syntax namelist, eg_no(numlist max=1)
  - postclose `namelist'
  = postclose __000000
  - use "ptb_eg`eg_no'.dta", clear
  = use "ptb_eg1.1.dta", clear
  - format _all %-100s
  - qui compress _all
  - qui log close
{smcl}
{txt}{sf}{ul off}